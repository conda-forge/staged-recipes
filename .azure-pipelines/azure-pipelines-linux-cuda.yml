jobs:
- job: linux_64_cuda
  pool:
    vmImage: ubuntu-16.04
  strategy:
    maxParallel: 1
    matrix:
      linux_cuda-9_2:
        CONFIG: azure-linux-64-cuda-9_2
        IMAGE_NAME: condaforge/linux-anvil-cuda:9.2
        CF_MAX_PY_VER: 37
        AZURE: True
      linux_cuda-10_0:
        CONFIG: azure-linux-64-cuda-10_0
        IMAGE_NAME: condaforge/linux-anvil-cuda:10.0
        CF_MAX_PY_VER: 37
        AZURE: True
      linux_cuda-10_1:
        CONFIG: azure-linux-64-cuda-10_1
        IMAGE_NAME: condaforge/linux-anvil-cuda:10.1
        CF_MAX_PY_VER: 37
        AZURE: True
  timeoutInMinutes: 360
  steps:
  - script: |
      sudo pip install --upgrade pip
      sudo pip install setuptools shyaml
    displayName: Install dependencies

  - script: |
      export CI=azure
      .circleci/run_docker_build.sh
    displayName: Run docker build
