{% set version = "2106" %}

package:
  name: openfoam
  version: {{ version }}

source:
  - folder: foam/OpenFOAM-v{{ version }}
    url: https://dl.openfoam.com/source/v{{ version }}/OpenFOAM-v{{ version }}.tgz
    sha256: 11e41e5b9a253ef592a8f6b79f6aded623b28308192d02cec1327078523b5a37
    patches:
      - patches/fix-return-1.diff
  - folder: foam/ThirdParty-v{{ 2106 }}
    url: https://dl.openfoam.com/source/v{{ version }}/ThirdParty-v{{ version }}.tgz
    sha256: 167f44c6746d996de884a932b120d816aa894678ca3d31c18ac488b7c1ff529d

build:
  number: 0
  skip: true  # [not linux64]
  detect_binary_files_with_prefix: false


requirements: 
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ compiler('gxx') }}
    - sysroot_linux-64 2.17  # [linux64]
    - gfortran_linux-64
    - cmake
    - make
    - flex
    - adios
    - adios2
    - metis
    - scotch
    - openmpi
    - bison
    - curl
    - git
    - gxx_linux-64
    - gcc_linux-64
    - openmpi-mpicc
    - libzlib
    - fftw
    - boost
    - cgal-cpp
    - boost-cpp
    - cgal

  host: 
    - cmake
    - make
    - flex
    - openmpi
    - bison
    - boost
    - libzlib
    - fftw
    - scotch
    - metis
    - adios
    - adios2
    - cgal-cpp
    - boost-cpp
    - cgal

test:
  commands:
    - echo "testing..."
    - foamInstallationTest
    - foamTestTutorial -full incompressible/simpleFoam/pitzDaily
    
about:
  home: https://develop.openfoam.com/Development/openfoam/-/blob/master/doc/Build.md
  license: GPL-2.0-or-later
  license_file: foam/OpenFOAM-v{{ version }}/COPYING
  summary: 'OpenFOAM'

  description: |
    OpenFOAM, the free CFD software!

  dev_url: https://develop.openfoam.com/Development/openfoam/-/blob/master/doc/Build.md
  doc_url: https://develop.openfoam.com/Development/openfoam/-/blob/master/doc/Build.md

extra:
  recipe-maintainers:
    - ngam
