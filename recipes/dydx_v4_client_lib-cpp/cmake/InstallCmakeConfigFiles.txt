include(CMakePackageConfigHelpers)

file(WRITE ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config.cmake.in
    "
include(CMakeFindDependencyMacro)
find_dependency(dydx_v4_proto)
find_dependency(Boost)
find_dependency(OpenSSL)
find_dependency(bip3x)
find_dependency(fmt)
find_dependency(nlohmann_json)
@PACKAGE_INIT@
set_and_check(dydx_v4_client_lib_INCLUDE_DIRS \"\${PACKAGE_PREFIX_DIR}/include/dydx_v4_client\")
if(WIN32)
    set_and_check(dydx_v4_proto_LIBRARIES \"\${PACKAGE_PREFIX_DIR}/lib/dydx_v4_client_lib.lib\")
else()
    set_and_check(dydx_v4_client_lib_LIBRARIES \"\${PACKAGE_PREFIX_DIR}/lib/libdydx_v4_client_lib${CMAKE_SHARED_LIBRARY_SUFFIX}\")
endif()
"
)

configure_package_config_file(
  ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config.cmake.in
  ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config.cmake
  INSTALL_DESTINATION ${CMAKE_INSTALL_LIBDIR}/cmake/dydx_v4_client_lib)

write_basic_package_version_file(
  ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config-version.cmake
  VERSION ${PROJECT_VERSION}
  COMPATIBILITY SameMajorVersion )

install(
  FILES ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config.cmake
        ${CMAKE_CURRENT_BINARY_DIR}/dydx_v4_client_lib-config-version.cmake
  DESTINATION ${CMAKE_INSTALL_LIBDIR}/cmake/dydx_v4_client_lib
  COMPONENT client)
