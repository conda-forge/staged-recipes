context:
  version: "3.8.0"

package:
  name: pinact
  version: ${{ version }}

source:
  url: https://github.com/suzuki-shunsuke/pinact/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 38450696aa0636fd99bb3167826def0dd701447ba25e155fb33adb14238502e3
  target_directory: src

build:
  number: 0
  script:
    - cd src
    - go-licenses save ./cmd/pinact --save_path ../library_licenses
    - if: unix
      then: go build -v -o $PREFIX/bin/pinact -ldflags="-s -w" ./cmd/pinact
      else: go build -v -o %LIBRARY_BIN%\pinact.exe -ldflags="-s -w" ./cmd/pinact

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script:
      - pinact version
      - pinact --help
  - package_contents:
      bin:
        - pinact
      strict: true

about:
  summary: Pin GitHub Actions versions
  description: |
    Pinact is a CLI tool to edit GitHub Workflow and Composite action files
    to pin versions of GitHub Actions and Reusable Workflows. It enhances
    security by converting mutable version references (like tags) into
    immutable commit SHA hashes with version annotations.
  license: MIT
  license_file:
    - src/LICENSE
    - library_licenses/
  homepage: https://github.com/suzuki-shunsuke/pinact
  repository: https://github.com/suzuki-shunsuke/pinact
  documentation: https://github.com/suzuki-shunsuke/pinact

extra:
  recipe-maintainers:
    - ytausch
    - ManuelLerchner
