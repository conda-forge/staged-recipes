
context:
  name: palace
  version: 0.15.0

package:
  name: ${{ name|lower }}
  version: ${{ version }}
  
source:
  url: https://github.com/awslabs/palace/archive/refs/tags/v${{ version }}.tar.gz
  sha256: e4ba910b9bcc43922ee038f7d161fc8d5d4a347b6244c5d0dd7535d5f559f452

build:
  number: 0
  skip:
    - win
  script: 
    file: build.sh
    # env: 
    #   CUDA_BUILD: ${{ "ON" if gpu=='true' else "OFF" }}

requirements:
  # ignore_run_exports:
  #     from_package:
  #     - if: gpu=='true'
  #       then: 
  #         - cuda
  #         # - libcublas-dev
  build:
    - ${{ compiler("cxx") }}
    - ${{ compiler("c") }}
    - ${{ compiler("fortran") }}
    - make
    - cmake >=3.24
    - pkg-config
    - bison
    - python >=3.11
    - if: gpu=='true'
      then: 
      - cuda >12

  host:
    - ${{ mpi }}
    - ${{ blas }}
    - zlib
    - if: linux
      then: libunwind
    # - if: gpu=='true'
    #   then: 
    #     - libcublas-dev
    #     - cuda-version==12
  run:
    - ${{ mpi }}

tests:
  - script:
    - palace --help

about:
  homepage: https://github.com/awslabs/palace
  license: Apache-2.0
  license_file: LICENSE
  summary: 3D Finite Element Solver for Computational Electromagnetics
  description: |
    Palace is an open-source, parallel finite element code for full-wave 3D 
    electromagnetic simulations. It uses the MFEM finite element discretization 
    library and libCEED library for efficient exascale discretizations.

extra:
  recipe-maintainers:
    - benvial
