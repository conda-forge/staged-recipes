--- a/setup.py
+++ b/setup.py
@@ -26,2 +26,17 @@
 from setuptools.command.build_ext import build_ext
+from build_mgclient_with_conda_lib_ext import build_mgclient_with_conda_lib_ext
+
+class GccBuildExt(build_ext):
+  def finalize_options(self):
+    if platform.system() == "Windows":
+      self.compiler = 'mingw32'
+    super().finalize_options()
+
+  def build_extensions(self):
+    if platform.system() == "Windows":
+      from distutils.ccompiler import new_compiler
+      self.compiler_obj = new_compiler(compiler='mingw32')
+      if hasattr(self.compiler_obj, 'initialize'):
+        self.compiler_obj.initialize()
+    super().build_extensions()

@@ -316,3 +331,3 @@
     ext_modules=[
-        Extension(EXTENSION_NAME, sources=sources, depends=headers, extra_link_args=extra_link_args)
+        build_mgclient_with_conda_lib_ext()
     ],
@@ -322,3 +342,3 @@
     },
-    cmdclass={"build_ext": BuildMgclientExt},
+    cmdclass={"build_ext": GccBuildExt},
     install_requires=[
