schema_version: 1

context:
  name: cp2k
  version: 2025.1

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  - url: https://github.com/cp2k/cp2k/releases/download/v${{ version }}/cp2k-${{ version }}.tar.bz2
    sha256: 65c8ad5488897b0f995919b9fa77f2aba4b61677ba1e3c19bb093d5c08a8ce1d

build:
  number: 0
  skip: win

requirements:
  build:
    - ${{ stdlib('c') }}
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - ${{ compiler('fortran') }}
    - cmake
    - make
    - if: linux
      then: libgomp
    - if: osx
      then: llvm-openmp
  host:
    - if: linux
      then: libgomp
    - if: osx
      then: llvm-openmp
    - openblas
    - scalapack
    - openmpi
    - fftw
    - dbcsr
  run_exports:
    - ${{ pin_subpackage(name, upper_bound='x') }}
  
tests:
  - script:
      - if: unix
        then:
          # - test -e ${PREFIX}/include/dbcsr.h 
          - ls -la
          # - test -e ${PREFIX}/lib/libdbcsr_c${SHLIB_EXT}

      
about:
  homepage: https://www.cp2k.org/
  summary: CP2K is a quantum chemistry and solid state physics software package that can 
    perform atomistic simulations of solid state, liquid, molecular, periodic, material, 
    crystal, and biological systems.
  description:  CP2K provides a general framework for different modeling methods such as 
    DFT using the mixed Gaussian and plane waves approaches GPW and GAPW. Supported theory 
    levels include DFTB, LDA, GGA, MP2, RPA, semi-empirical methods (AM1, PM3, PM6, RM1, 
    MNDO, …), and classical force fields (AMBER, CHARMM, …). CP2K can do simulations of 
    molecular dynamics, metadynamics, Monte Carlo, Ehrenfest dynamics, vibrational 
    analysis, core level spectroscopy, energy minimization, and transition state 
    optimization using NEB or dimer method.
  license: GPL-2.0-only
  license_file: LICENSE
  repository: https://github.com/cp2k/cp2k
  documentation: https://manual.cp2k.org/

extra:
  recipe-maintainers:
    - martin-g
