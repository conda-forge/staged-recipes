{% set name = "geogram" %}
{% set version = "1.7.6" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/alicevision/geogram/archive/refs/tags/v{{ version }}.tar.gz
  sha256: e988c39d7a7323bb4dc73a7a90816717f3dad3696aabeefe044a37e97bbed59d
  patches:
    - add-vs19-build.patch  # [win]

build:
  number: 0

requirements:
  build:
    - cmake
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
  host:
    - xorg-libx11  # [unix]
    - xorg-libxrandr  # [unix]
    - xorg-libxinerama  # [unix]
  run:

test:
  commands:
    - test -f ${PREFIX}/bin/geobox  # [unix]
    - test -f ${PREFIX}/bin/geocod  # [unix]
    - test -f ${PREFIX}/bin/geodump  # [unix]
    - test -f ${PREFIX}/bin/geoshade  # [unix]
    - test -f ${PREFIX}/bin/vorpalite  # [unix]
    - test -f ${PREFIX}/lib/geogram.a  # [unix]
    - test -f ${PREFIX}/lib/geogram_gfx.a  # [unix]
    - test -f ${PREFIX}/lib/geogram_num_3rdparty.a  # [unix]
    - test -f ${PREFIX}/lib/glfw3.a  # [unix]
    - if not exist %LIBRARY_PREFIX%\bin\geobox.exe exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\bin\geocod.exe exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\bin\geodump.exe exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\bin\geoshade.exe exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\bin\vorpalite.exe exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\lib\geogram.lib exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\lib\geogram_gfx.lib exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\lib\geogram_num_3rdparty.lib exit 1  # [win]
    - if not exist %LIBRARY_PREFIX%\lib\glfw3.lib exit 1  # [win]

about:
  home: http://alice.loria.fr/index.php/software/4-library/75-geogram.html
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE.txt
  summary: 'Geogram is a programming library of geometric algorithms.'
  description: |
   Geogram is a programming library of geometric algorithms. It includes a simple yet efficient
   Mesh data structure (for surfacic and volumetric meshes), exact computer
   arithmetics (a-la Shewchuck, implemented in GEO::expansion ), a predicate code generator
   ( PCK : Predicate Construction Kit), standard geometric predicates (orient/insphere),
   Delaunay triangulation, Voronoi diagram, spatial search data structures, spatial sorting)
   and less standard ones (more general geometric predicates, intersection between a Voronoi
   diagram and a triangular or tetrahedral mesh embedded in n dimensions). The latter is used by FWD/WarpDrive,
   the first algorithm that computes semi-discrete Optimal Transport in 3d that scales up to 1 million Dirac masses.
  doc_url: http://alice.loria.fr/software/geogram/doc/html/index.html

extra:
  recipe-maintainers:
    - ngodber
