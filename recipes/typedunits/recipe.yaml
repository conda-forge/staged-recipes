context:
  version: "0.0.1"

package:
  name: typedunits
  version: ${{ version }}

source:
  url: https://github.com/quantumlib/TypedUnits/archive/refs/tags/v${{ version }}.tar.gz
  sha256: c9047d6a13a67c799d27efff6e15be42e94383c44dea76350dbcc445a3c5f0e9
  patches:
    - patches/0001-remove-cython-as-a-runtime-dependency.patch

build:
  number: 0
  script:
    - python -m pip install . -vv

requirements:
  build:
    - ${{ compiler("c") }}
  host:
    - python
    - pip
    - cython
    - setuptools
  run:
    - python
    - attrs
    - numpy
    - protobuf >=4.25
    - pyparsing

tests:
  - python:
      imports:
        - tunits
        - tunits.core
        - tunits.units_with_dimension
      pip_check: true
  - files:
      source:
        - test/
    requirements:
      run:
        - pytest
    script:
      - pytest -v test/

about:
  homepage: https://github.com/quantumlib/TypedUnits
  summary: A fast units and dimensions library with support for static dimensionality checking and protobuffer serialization.
  license: Apache-2.0
  license_file: LICENSE
  repository: https://github.com/quantumlib/TypedUnits

extra:
  recipe-maintainers:
    - h-vetinari
