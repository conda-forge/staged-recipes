context:
  version: "1.3.0"

package:
  name: highway
  version: ${{ version }}

source:
  url: https://github.com/google/highway/archive/refs/tags/${{ version }}.tar.gz
  sha256: 07b3c1ba2c1096878a85a31a5b9b3757427af963b1141ca904db2f9f4afe0bc2

build:
  script:
    - if: unix
      then:
        - cmake -B _build -G Ninja ${CMAKE_ARGS} -DBUILD_SHARED_LIBS=ON -DHWY_ENABLE_TESTS=OFF -DHWY_ENABLE_EXAMPLES=OFF .
      else:
        - cmake -B _build -G Ninja %CMAKE_ARGS% -DBUILD_SHARED_LIBS=ON -DHWY_ENABLE_TESTS=OFF -DHWY_ENABLE_EXAMPLES=OFF .
    - cmake --build _build
    - cmake --install _build
  number: 0

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
    - cmake
    - ninja
  run_exports:
    - ${{ pin_subpackage('highway', upper_bound='x.x.x') }}

tests:
  - package_contents:
      lib:
        - hwy

about:
  homepage: https://github.com/google/highway
  summary: Performance-portable, length-agnostic SIMD with runtime dispatch
  description: |
    Highway is a C++ library that provides portable SIMD/vector intrinsics.
  license: (Apache-2.0 OR BSD-3-Clause) AND CC0-1.0
  license_file: LICENSE
  documentation: https://github.com/google/highway
  repository: https://github.com/google/highway

extra:
  recipe-maintainers:
    - pavelzw
