context:
  version: 1.2.13

package:
  name: bun
  version: ${{ version }}

source:
  - url: https://github.com/oven-sh/bun/archive/refs/tags/bun-v${{ version }}.tar.gz
    sha256: 6aac998038ebf878a4df167e906e8c84797e83c27ac5b40c20153aa52f127080

build:
  number: 0
  script:
    - if: unix
      then:
        - curl -fsSL https://bun.sh/install | bash
        - export CI=OFF
        - mkdir -p build
        - cd build
        - cmake -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Release ../
        - cmake --build . --verbose
        - cmake --install .
    - if: win
      then:
        - irm bun.sh/install.ps1 | iex
        - set CI=OFF
        - mkdir -p build
        - cd build
        - cmake -G Ninja -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Release  ../
        - cmake --build . --verbose
        - cmake --install .

requirements:
  build:
    - cmake
    - lsb-release
    - ccache
    - git
    - ninja
    - pkg-config
    - ruby
    - lld
    - llvm
    - llvm-tools
    - zig
    - if: unix
      then:
        - libtool
        - unzip
        - make
    - clang 19.*
    - clangxx 19.*
    - ${{ compiler('rust') }}
    - ${{ compiler('go-nocgo') }}
tests:
  - script:
    - bun --version

about:
  homepage: https://bun.sh
  repository: https://github.com/oven-sh/bun
  license: MIT
  summary: Bun is a fast all-in-one JavaScript runtime

extra:
  recipe-maintainers:
    - whophil
