{% set version = '1.0.0' %}

{% set posix = 'm2-' if win else '' %}
{% set native = 'm2w64-' if win else '' %}

package:
  name: r-n2r
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/N2R_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/N2R/N2R_{{ version }}.tar.gz
  sha256: b57b63d3426011fd8e44cd5bb342dc1d729c552088e8d443d5cd2f0f3492bddf

build:
  merge_build_host: True  # [win]
  # If this is a new build for the same version, increment the build number.
  number: 0
  # no skip

  # This is required to make R link correctly on Linux.
  rpaths:
    - lib/R/lib/
    - lib/

# Suggests: testthat
requirements:
  build:
    - {{ compiler('c') }}              # [not win]
    - {{ compiler('m2w64_c') }}        # [win]
    - {{ compiler('cxx') }}            # [not win]
    - {{ compiler('m2w64_cxx') }}      # [win]
    - {{ posix }}filesystem        # [win]
    - {{ posix }}make
    - {{ posix }}sed               # [win]
    - {{ posix }}coreutils         # [win]
    - {{ posix }}zip               # [win]

  host:
    - r-base
    - r-matrix
    - r-rcpp >=1.0.4
    - r-rcppeigen
    - r-rcppspdlog

  run:
    - r-base
    - {{native}}gcc-libs         # [win]
    - r-matrix
    - r-rcpp >=1.0.4
    - r-rcppeigen
    - r-rcppspdlog

test:
  commands:
    # You can put additional test commands to be run here.
    - $R -e "library('N2R')"           # [not win]
    - "\"%R%\" -e \"library('N2R')\""  # [win]

  # You can also put a file called run_test.py, run_test.sh, or run_test.bat
  # in the recipe that will be run at test time.

  # requires:
    # Put any additional test requirements here.

about:
  home: https://github.com/kharchenkolab/N2R
  license: Apache License 2.0
  summary: Implements methods to perform fast approximate K-nearest neighbor search on input
    matrix. Algorithm based on the 'N2' implementation of an approximate nearest neighbor
    search using hierarchical  Navigable Small World (NSW) graphs. The original algorithm
    is described in "Efficient and Robust Approximate Nearest Neighbor Search Using
    Hierarchical Navigable Small World Graphs", Y. Malkov and D. Yashunin, <doi:10.1109/TPAMI.2018.2889473>,
    <arXiv:1603.09320>.
  license_family: APACHE
  license_file:
  - '{{ environ["PREFIX"] }}/lib/R/share/licenses/GPL-3'

extra:
    recipe-maintainers:
      - raivivek

# The original CRAN metadata for this package was:

# Package: N2R
# Type: Package
# Title: Fast and Scalable Approximate k-Nearest Neighbor Search Methods using 'N2' Library
# Version: 1.0.0
# Authors@R: c(person("Peter", "Kharchenko", email = "Peter_Kharchenko@hms.harvard.edu", role = c("aut")), person("Viktor", "Petukhov", email = "viktor.s.petukhov@ya.ru", role = c("aut")), person("Dirk", "Eddelbuettel", email="edd@debian.org", role=c("ctb")), person("Evan", "Biederstedt", email = "evan.biederstedt@gmail.com", role=c("cre", "aut")))
# Description: Implements methods to perform fast approximate K-nearest neighbor search on input matrix. Algorithm based on the 'N2' implementation of an approximate nearest neighbor search using hierarchical  Navigable Small World (NSW) graphs. The original algorithm is described in "Efficient and Robust Approximate Nearest Neighbor Search Using Hierarchical Navigable Small World Graphs", Y. Malkov and D. Yashunin, <doi:10.1109/TPAMI.2018.2889473>, <arXiv:1603.09320>.
# License: Apache License 2.0
# Encoding: UTF-8
# Depends: Matrix
# Imports: Rcpp (>= 1.0.4)
# Suggests: testthat
# LinkingTo: Rcpp, RcppSpdlog, RcppEigen
# SystemRequirements: GNU make
# RoxygenNote: 7.1.2
# URL: https://github.com/kharchenkolab/N2R
# BugReports: https://github.com/kharchenkolab/N2R/issues
# NeedsCompilation: yes
# Author: Peter Kharchenko [aut], Viktor Petukhov [aut], Dirk Eddelbuettel [ctb], Evan Biederstedt [cre, aut]
# Maintainer: Evan Biederstedt <evan.biederstedt@gmail.com>
# Packaged: 2021-11-19 20:20:01 UTC; evanbiederstedt
# Repository: CRAN
# Date/Publication: 2021-11-19 20:50:06 UTC

# See
# https://docs.conda.io/projects/conda-build for
# more information about meta.yaml
