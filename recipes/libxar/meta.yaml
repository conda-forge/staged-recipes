{% set version = "1.8" %}

package:
  name: libxar
  version: {{ version }}

source:
  # need to check sources for actual version number
  # https://github.com/apple-oss-distributions/xar/blob/main/xar/configure.ac#L10-L11
  url: https://github.com/apple-oss-distributions/xar/archive/refs/tags/xar-482.tar.gz
  sha256: 03ae7f6201d2586be03681feb06e32a2ddee08fe59c4002759c354c86964f62d

build:
  number: 0
  script:
    - cd xar
    - ./configure
    - make
    - make install
  skip: true  # [win]

requirements:
  build:
    - {{ compiler('c') }}
    - make
test:
  commands:
    # shared
    - test -f $PREFIX/lib/libxar.so              # [linux]
    - test -f $PREFIX/lib/libxar.dylib           # [osx]

    # absence of static libraries
    - test ! -f $PREFIX/lib/libxar.a

    # header
    - test -f $PREFIX/include/xar.h              # [unix]

about:
  home: https://github.com/apple-oss-distributions/xar
  license: BSD-3-Clause
  license_file: LICENSE
  summary: eXtensible ARchiver
  # original project is https://code.google.com/archive/p/xar/, but patched by apple
  dev_url: https://github.com/apple-oss-distributions/xar

extra:
  recipe-maintainers:
    - h-vetinari
    - isuruf
