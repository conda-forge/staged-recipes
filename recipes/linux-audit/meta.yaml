{% set name = "linux-audit" %}
{% set version = "3.0.9" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://people.redhat.com/sgrubb/audit/audit-{{ version }}.tar.gz
  sha256: fd9570444df1573a274ca8ba23590082298a083cfc0618138957f590e845bc78

build:
  skip: true  # [not linux]
  run_exports:
    - {{ pin_subpackage('linux-audit', max_pin='x.x') }}
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - automake
    - libtool
    - make
  host:
    - openldap

test:
  commands:
    - test -f "${PREFIX}"/lib/libaudit.so
    - aulastlog
    - auvirt --help
    - '"${PREFIX}"/sbin/aureport --help'
    - '"${PREFIX}"/sbin/ausearch --help'
    - '"${PREFIX}"/sbin/auditctl -h'
    - '"${PREFIX}"/sbin/audisp-syslog'

about:
  home: https://people.redhat.com/sgrubb/audit/index.html
  summary: The audit userspace tools
  description: |
    The Linux Audit subsystem provides a secure logging framework
    that is used to capture and record security relevant events.
    It consists of a kernel component which generates audit records based on system activity,
    a userspace daemon which logs these records to a local file or a remote aggregation server,
    and a set of userspace tools to for audit log inspection and post-processing.
  license: GPL-2.0-or-later OR LGPL-2.1-or-later
  license_file:
    - COPYING
    - COPYING.LIB
  doc_url: https://github.com/linux-audit/audit-documentation/wiki
  dev_url: https://github.com/linux-audit/audit-userspace

extra:
  recipe-maintainers:
    - sshockwave
