From afc5338672e9b3d960d357f260da415a4826dbfc Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Sun, 21 Nov 2021 10:50:38 +1100
Subject: [PATCH 1/3] do not try to detect & set build number

we're only building released versions in conda-forge anyway...
---
 CMakeLists.txt | 12 +-----------
 1 file changed, 1 insertion(+), 11 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 459e062..ff6356b 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -16,17 +16,7 @@ option(BUILD_PYTHON "Build python if ON" ON)
 
 # Build Number Generation
 #-------------------------------------------------------------------------------
-SET(BUILD_NUMBER 0)
 SET(VERSION_STRING "${CMAKE_PROJECT_VERSION_MAJOR}.${CMAKE_PROJECT_VERSION_MINOR}")
-find_package(Git)
-if(GIT_FOUND)
-    execute_process(
-            COMMAND ${GIT_EXECUTABLE} describe --match INITIAL_BUILD
-            OUTPUT_VARIABLE DESCRIBE_BUILD
-            OUTPUT_STRIP_TRAILING_WHITESPACE)
-    string(REGEX MATCH "[0-9]+" BUILD_NUMBER ${DESCRIBE_BUILD})
-endif()
-ADD_DEFINITIONS(-DBUILD_NUMBER=${BUILD_NUMBER})
 ADD_DEFINITIONS(-DVERSION_STRING=${VERSION_STRING})
 #-------------------------------------------------------------------------------
 
@@ -268,7 +258,7 @@ if(BUILD_PYTHON)
     # Write the version string
     add_dependencies(write_version_string_to_python python_source_files)
     add_custom_command(TARGET write_version_string_to_python POST_BUILD
-        COMMAND ${CMAKE_COMMAND} -DVERSION_STRING=${VERSION_STRING} -DBUILD_NUMBER=${BUILD_NUMBER} -P
+        COMMAND ${CMAKE_COMMAND} -DVERSION_STRING=${VERSION_STRING} -P
         ${CMAKE_CURRENT_BINARY_DIR}/../cmake/write_python_version_string.cmake)
 else()
     message("-- Not building python libraries. To build python libraries use -DBUILD_PYTHON=ON")
-- 
2.32.0.windows.2

