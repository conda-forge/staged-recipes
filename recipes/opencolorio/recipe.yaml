context:
  version: 2.5.1

package:
  name: opencolorio
  version: ${{ version }}

source:
  - url: https://pypi.org/packages/source/o/opencolorio/opencolorio-${{ version }}.tar.gz
    sha256: 5d9a63ffa92e3442dea811d3d0aa445c4cdf70a8e4d038057d53f7576c235c97

build:
  skip:
    - win
  script:
    - ${{ PYTHON }} -m pip install .
  python:
    entry_points:
      - ocioarchive = PyOpenColorIO.command_line:main
      - ociobakelut = PyOpenColorIO.command_line:main
      - ociocheck = PyOpenColorIO.command_line:main
      - ociochecklut = PyOpenColorIO.command_line:main
      - ocioconvert = PyOpenColorIO.command_line:main
      - ociocpuinfo = PyOpenColorIO.command_line:main
      - ociodisplay = PyOpenColorIO.command_line:main
      - ociolutimage = PyOpenColorIO.command_line:main
      - ociomakeclf = PyOpenColorIO.command_line:main
      - ociomergeconfigs = PyOpenColorIO.command_line:main
      - ocioperf = PyOpenColorIO.command_line:main
      - ociowrite = PyOpenColorIO.command_line:main
      - pyocioamf = PyOpenColorIO.bin.pyocioamf.pyocioamf:main
      - pyociodisplay = PyOpenColorIO.bin.pyociodisplay.pyociodisplay:main

requirements:
  build:
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
    - cmake >=3.14
    - if: not arm64
      then:
        - ninja
  host:
    - python >=3.9
    - setuptools >=42
    - wheel
    - pybind11 >=2.9.2
    - yaml-cpp >=0.8.0
    - minizip >=4.0.0
    - zlib >=1.2.13
    - imath >=3.1.1
    - expat >=2.6.0
    - openimageio >=2.2.14
    - pip

tests:
  - python:
      imports:
        - opencolorio
      pip_check: true
  - script:
      - ocioarchive --help
      - ociobakelut --help
      - ociocheck --help
      - ociochecklut --help
      - ocioconvert --help
      - ociocpuinfo --help
      - ociodisplay --help
      - ociolutimage --help
      - ociomakeclf --help
      - ociomergeconfigs --help
      - ocioperf --help
      - ociowrite --help
      - pyocioamf --help
      - pyociodisplay --help

about:
  homepage: https://opencolorio.org/
  summary: OpenColorIO (OCIO) is a complete color management solution geared towards motion picture production with an emphasis on visual effects and computer animation.
  license_file: LICENSE
  license: CC-BY-4.0

extra:
  recipe-maintainers:
    - carlodri
