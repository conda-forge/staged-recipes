{% set name = "cogger" %}
{% set version = "0.0.7" %}

package:
    name: {{ name|lower }}
    version: {{ version }}

source:
    url: https://github.com/airbusgeo/cogger/archive/v{{ version }}.tar.gz
    sha256: 1bbccd1500a517b6eb44bfa12dff20c0b92612bc0c10b5dca78e1b0eff557097

build:
    number: 0
    script:
        - cd ./cmd/cogger
        - go-licenses save . --save_path library_licenses
        - if: unix:
          then: go build -v -o $PREFIX/bin/cogger -ldflags="-s -w"
          else: go build -v -o %LIBRARY_BIN%\cogger.exe -ldflags="-s"

requirements:
    build:
        - {{ compiler('go') }}
        - go-licenses

test:
    requires:
        - go
    source_files:
        - .
    commands:
        - go test .
        - ./cmd/cogger/cogger --help
about:
    home: https://github.com/airbusgeo/cogger
    summary: "cogger is a fast geotiff to COG converter"
    description: |
        Cogger is a standalone binary and a golang library that reads an
        internally tiled geotiff (optionally with overviews and masks) and
        rewrites it as a Cloud Optimized Geotiff (COG). This process being a
        reshuffling of the original geotiff's bytes, it should run as fast as
        the underlying disk or network i/o.
    license: Apache-2.0
    license_file:
        - LICENSE
        - ./cmd/cogger/library_licenses/
    doc_url: https://github.com/airbusgeo/cogger
    dev_url: https://github.com/airbusgeo/cogger

extra:
    recipe-maintainers:
        - phargogh
