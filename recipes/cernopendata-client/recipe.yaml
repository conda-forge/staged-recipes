schema_version: 1

context:
  version: "1.0.2"
  python_min: "3.8"

recipe:
  # recipe name needs to be unique from any outputs
  name: cernopendata-client-suite
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/c/cernopendata-client/cernopendata_client-${{ version }}.tar.gz
  sha256: 9d829c78434d5117806dea112fd276bade8c8d8cb93a10383c69f20845243a12

build:
  number: 0

outputs:
  - package:
      name: cernopendata-client

    build:
      noarch: python
      script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
      python:
        entry_points:
          - cernopendata-client = cernopendata_client.cli:cernopendata_client

    requirements:
      host:
        - python ${{ python_min }}.*
        - pip
        - setuptools
      run:
        - python >=${{ python_min }}
        - click >=7
        - requests >=2

    tests:
      - python:
          imports:
            - cernopendata_client
          pip_check: true
          python_version: ["${{ python_min }}.*", "3.14.*"]
      - script:
          - cernopendata-client --help

  - package:
      name: cernopendata-client-pycurl

    requirements:
      run:
        - ${{ pin_subpackage("cernopendata-client", upper_bound="x.x.x") }}
        - pycurl >=7

    tests:
      - python:
          imports:
            - cernopendata_client
          pip_check: true
          python_version: ${{ python_min }}.*

  - package:
      name: cernopendata-client-xrootd

    requirements:
      run:
        - ${{ pin_subpackage("cernopendata-client", upper_bound="x.x.x") }}
        - xrootd >=4.12.2

    tests:
      - python:
          imports:
            - cernopendata_client
          pip_check: true
          python_version: ${{ python_min }}.*

about:
  summary: CERN Open Data command-line client
  description: |
    cernopendata-client is a command-line tool to facilitate downloading files
    from the [CERN Open Data portal](http://opendata.cern.ch/).
    The tool enables to query datasets hosted on the CERN Open Data portal and
    to download and verify the individual data set files.
  license: GPL-3.0-only
  license_file: LICENSE
  homepage: https://github.com/cernopendata/cernopendata-client
  repository: https://github.com/cernopendata/cernopendata-client
  documentation: http://cernopendata-client.readthedocs.io/

extra:
  feedstock-name: cernopendata-client
  recipe-maintainers:
    - matthewfeickert
