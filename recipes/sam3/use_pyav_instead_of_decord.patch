diff --git a/sam3/train/data/sam3_image_dataset.py b/sam3/train/data/sam3_image_dataset.py
index 97efb1d..26f0654 100644
--- a/sam3/train/data/sam3_image_dataset.py
+++ b/sam3/train/data/sam3_image_dataset.py
@@ -15,7 +15,7 @@ from typing import Any, Callable, Dict, List, Optional, Set, Tuple, Union
 import torch
 import torch.utils.data
 import torchvision
-from decord import cpu, VideoReader
+import av
 from iopath.common.file_io import g_pathmgr
 
 from PIL import Image as PILImage
@@ -202,17 +202,20 @@ class CustomCocoDetectionAPI(VisionDataset):
             try:
                 if ".mp4" in path and path[-4:] == ".mp4":
                     # Going to load a video frame
-                    video_path, frame = path.split("@")
-                    video = VideoReader(video_path, ctx=cpu(0))
-                    # Convert to PIL image
-                    all_images.append(
-                        (
-                            img_id,
-                            torchvision.transforms.ToPILImage()(
-                                video[int(frame)].asnumpy()
-                            ),
-                        )
-                    )
+                    video_path, frame_idx = path.split("@")
+                    frame_idx = int(frame_idx)
+                    container = av.open(video_path)
+                    try:
+                        stream = container.streams.video[0]
+                        fps = stream.average_rate.numerator / stream.average_rate.denominator if stream.average_rate.denominator > 0 else 30.0
+                        seek_time = frame_idx / fps
+                        timestamp = int(seek_time * stream.time_base.denominator / stream.time_base.numerator)
+                        container.seek(timestamp, stream=stream, any_frame=False)
+                        frame = next(container.decode(video=0))
+                        frame_rgb = frame.to_ndarray(format='rgb24')
+                        all_images.append((img_id, PILImage.fromarray(frame_rgb)))
+                    finally:
+                        container.close()
                 else:
                     with g_pathmgr.open(path, "rb") as fopen:
                         all_images.append((img_id, PILImage.open(fopen).convert("RGB")))

