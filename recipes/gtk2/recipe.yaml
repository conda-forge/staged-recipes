context:
  name: gtk2
  major_minor: "2.24"
  version: ${{ major_minor + ".33" }}

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: http://ftp.gnome.org/pub/GNOME/sources/gtk+/${{ major_minor }}/gtk+-${{ version }}.tar.xz
  sha256: ac2ac757f5942d318a311a54b0c80b5ef295f299c2a73c632f6bfb1ff49cc6da
  # TODO: consider a few patches from ubuntu
  # https://salsa.debian.org/gnome-team/gtk2/-/tree/ubuntu/master/debian/patches

build:
  skip: unix
  number: 0

requirements:
  ignore_run_exports:
    by_name:
      # these are the actual libraries associated with the metapackages
      # that we needed to pull in for devel files below:
      - libexpat
      - liblzma
      - libzlib
      - if: not unix
        then:
          - atk
          - libgcc
          - libwinpthread
          - ucrt
  build:
    - perl *
    - gettext-tools
    - gnuconfig
    - gobject-introspection
    - if: unix
      then:
        - ${{ compiler('c') }}
        - ${{ stdlib("c") }}
        - autoconf =2.69
        - automake
        - make
        - pkg-config
      else:
        - ${{ compiler('m2w64_c') }}
        - ${{ stdlib("m2w64_c") }}
        - binutils
        - fribidi
        - graphite2
        - harfbuzz
        - libffi
        - libiconv
        - m2-autoconf
        - m2-automake-wrapper
        - m2-grep
        - m2-make
        - m2-pkg-config
        - m2-which
    - if: build_platform != target_platform
      then:
        - atk
        - cairo
        - gdk-pixbuf
        - glib
        - pango
        # needed for devel files (e.g. pkg-config):
        - expat
        - liblzma-devel
        - xorg-xorgproto
        - zlib
  host:
    - atk
    - cairo
    - gdk-pixbuf
    - glib
    - pango
    - xorg-xorgproto
    - if: not unix
      then:
        - libgirepository
        - libintl-devel
    - if: osx
      then:
        - libintl-devel
    - if: linux
      then:
        - fontconfig
        - freetype
        - harfbuzz
        - xorg-libx11
        - xorg-libxext
        - xorg-libxrender
    - expat
    - liblzma-devel
    - xorg-xorgproto
    - zlib

tests:
  - package_contents:
      lib:
        - if: linux
          then: libgtk-x11-2.0${{ SHLIB_EXT }}
        - if: osx
          then: libgtk-quartz-2.0${{ SHLIB_EXT }}
        - if: not unix
          then:
      files:
        - if: not unix
          then:
            - Library/bin/libgtk-win32-2.0-0.dll
            - Library/lib/libgtk-win32-2.0.dll.a
            - Library/lib/gtk-win32-2.0.lib

about:
  homepage: https://developer.gnome.org/gtk/
  license: LGPL-2.1-or-later
  license_file: COPYING
  summary: Primary library used to construct user interfaces in GNOME applications
  repository: https://developer.gnome.org/gtk/

extra:
  recipe-maintainers:
    - MementoRC
