{% set version = '0.3.0' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-whirl
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/whirl_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/whirl/whirl_{{ version }}.tar.gz
  sha256: 0648048665a24109cf986be0bc10437be0c84089dfb431908c4f3299a62e63b9

build:
  number: 0
  noarch: generic
  rpaths:
    - lib/R/lib/
    - lib/
  missing_dso_whitelist:
    - '*/R.dll'        # [win]
    - '*/Rblas.dll'    # [win]
    - '*/Rlapack.dll'  # [win]

requirements:
  build:
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
  host:
    - r-base
    - r-r6 >=2.4.0
    - r-callr
    - r-cli
    - r-dplyr
    - r-jsonlite
    - r-kableextra
    - r-knitr
    - r-purrr
    - r-quarto
    - r-reticulate
    - r-rlang
    - r-sessioninfo
    - r-stringr
    - r-tibble
    - r-tidyr
    - r-unglue
    - r-withr
    - r-yaml
    - r-zephyr >=0.1.1
  run:
    - r-base
    - r-r6 >=2.4.0
    - r-callr
    - r-cli
    - r-dplyr
    - r-jsonlite
    - r-kableextra
    - r-knitr
    - r-purrr
    - r-quarto
    - r-reticulate
    - r-rlang
    - r-sessioninfo
    - r-stringr
    - r-tibble
    - r-tidyr
    - r-unglue
    - r-withr
    - r-yaml
    - r-zephyr >=0.1.1

test:
  commands:
    - $R -e "library('whirl')"           # [not win]
    - "\"%R%\" -e \"library('whirl')\""  # [win]

about:
  home: https://novonordisk-opensource.github.io/whirl/, https://github.com/novonordisk-opensource/whirl
  license: Apache-2.0
  summary: Logging of scripts suitable for clinical trials using 'Quarto' to create nice human
    readable logs. 'whirl' enables execution of scripts in batch, while simultaneously
    creating logs for the execution of each script, and providing an overview summary
    log of the entire batch execution.
  license_family: APACHE
  license_file:
    - LICENSE-2.0.txt

extra:
  recipe-maintainers:
    - conda-forge/r
