# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/73cd2eed94c576213c5f25ab57adf6d8c83e792a/schema.json
schema_version: 1

context:
  name: freetakserver
  version: 2.2.2
  python_min: 3.11.0

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/babeloff/FreeTakServer/archive/refs/tags/v2.2.2-conda-forge.tar.gz
  sha256: 47baced5d70ac06f14f283a2b30a65209f0a3e1e0afae9fe591e88496d07b155

build:
  number: 0
  script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  skip:
    - py<311
  python:
    entry_points:
      - swagger_server=swagger_server.__main__:main

requirements:
  host:
    - python
    - poetry-core
    - pip
  run:
    - python
    - bitarray
    - click >=8.1.3
    - colorama >=0.4.4,<0.5
    - cryptography
    - bcrypt
    - defusedxml >=0.7.1,<0.8
    - dnspython
    - eventlet >=0.33.1,<0.34
    - flask >=3.0.2,<3.1
    - flask-cors >=4.0.0,<4.1
    - flask-httpauth >=4.8.0,<4.9
    - flask-login >=0.6.3,<0.7
    - flask-socketio >=5.3.6,<5.4
    - flask-sqlalchemy >=3.1.1,<3.2
    - geographiclib >=1.52,<1.53
    - geopy >=2.2.0,<2.3
    - greenlet >=3.1.1,<3.2
    - itsdangerous >=2.0.1
    - testresources >=2.0.1,<2.1
    - jinja2 >=3.1.3,<3.2
    - lxml
    - markupsafe >=2.1.5,<2.2
    - monotonic >=1.6,<1.7
    - pathlib2 >=2.3.7
    - protobuf
    - psutil >=6.1.1,<6.2
    - pykml >=0.2.0,<0.3
    - python-engineio >=4.11.2,<4.12
    - python-socketio >=5.11.1,<5.12
    - pyyaml >=6.0.2,<6.1
    - ruamel.yaml >=0.18.10,<0.19
    - ruamel.yaml.clib >=0.2.8,<0.3
    - six >=1.16.0,<1.17
    - sqlalchemy >=2.0.38,<2.1
    - tabulate >=0.8.7,<0.9
    - werkzeug >=3.0.1,<3.1
    - wtforms >=2.3.3,<2.4
    - pyopenssl
    - qrcode >=7.3.1,<7.4
    - pillow >=11.0.0,<11.1
    - xmltodict
    - pyzmq
    - digitalpy >=0.3.13.7,<0.4
    - opentelemetry-sdk
    - pyjwt
    - connexion
    - swagger-ui-bundle >=0.0.2
  run_constraints:
    - FreeTAKServer_UI >=2.1,<2.2
    - pytak >=5.4.1,<5.5
    - pytest >=7.2.0,<7.3

tests:
  - python:
      python_version: ${{ python_min }}.*
      imports:
        - digitalpy
        # - base
        # - configuration
        # - controllers
        # - domain
        # - persistence
        # - swagger_server
      # pip_check disabled due to potential dependency conflicts
      # Consider enabling after verifying the updated version ranges work together
      pip_check: false

about:
  homepage: https://github.com/FreeTAKTeam/FreeTakServer
  summary: An open source server for the TAK family of applications.
  description: |
    This module provides the Free TAK Server implementation.
    The TAK family provides applications used for situational awareness.
    It is used by civilian and military organization for planning.
  license: EPL-2.0
  license_file: LICENSE
  documentation: https://freetakteam.github.io/FreeTAKServer-User-Docs/
  repository: https://github.com/FreeTAKTeam/FreeTakServer

extra:
  recipe-maintainers:
    - phreed
