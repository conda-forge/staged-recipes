{% set name = "wgms3d" %}
{% set version = "2.0" %}
{% set variant = "openblas" %}

package:
  name: {{ name|lower }}
  version: {{ version }}


source:
    fn: wgms3d-{{ version }}.tar.gz
    url: http://www.soundtracker.org/raw/wgms3d/wgms3d-{{ version }}.tar.gz
    sha256: cba974d049db4162904602858bb0bc2069af8c83c9360e2c9eadb1ef560ac3fa


build:
  number: 0
  skip: True  # [win]
  features:
    - blas_{{ variant }}

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ compiler('fortran') }}
    - cmake
    - make
    - arpack
    - superlu
    - boost-cpp
    - blas 1.1 {{ variant }}
    - openblas 0.2.19|0.2.19.*
  host:
    - libblas
    - liblapack
  run:
    - boost-cpp
    - libgcc  # [linux]
    - libgfortran  # [osx]
    - blas 1.1 {{ variant }}
    - openblas 0.2.19|0.2.19.*
     
    # - {{ pin_compatible('metis', max_pin='x.x') }}
    # - {{ pin_compatible('parmetis', max_pin='x.x') }}
# requirements:
#   build:
#     - cmake
#     - gcc  # [not win]
#   run:

test:
  commands:
    - test -f ${PREFIX}/lib/libsuperlu_dist.a
    - test -f ${PREFIX}/lib/libsuperlu_dist.dylib  # [osx]
    - test -f ${PREFIX}/lib/libsuperlu_dist.so     # [linux]


about:
  home: https://github.com/smartalecH/wgms3d
  license: GPL-3.0
  license_family: GPL3
  license_file: LICENSE.txt
  summary: 'wgms3d - a full-vectorial finite-difference mode solver.'
  description: |
      wgms3d - a full-vectorial finite-difference mode solver.
  doc_url: http://www.soundtracker.org/raw/wgms3d/installation.html
  dev_url:  http://www.soundtracker.org/raw/wgms3d/installation.html

extra:
  recipe-maintainers:
    - joaquin
