context:
  name: prexsyn-engine
  version: "0.1.1.dev5"
  rdkit_min_version: "2025.3.6"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/luost26/prexsyn-engine/archive/v${{ version }}.tar.gz
  sha256: 5335bdd28fe6110a7b19509a8bd127519ce8f4d75290e8d23853808dabc587f4

build:
  skip:
    - not linux 
    - match(python, "<3.11")
  script: |
    mkdir builddir
    $PYTHON -m build -w -n -x -Cbuilddir=builddir
    $PYTHON -m pip install dist/*.whl
  number: 0

requirements:
  build:
  - ${{ compiler('cxx') }}
  - ${{ stdlib('c') }}
  - cmake
  - ninja

  host:
  - python
  - pip
  - setuptools
  - python-build
  - rdkit >=${{ rdkit_min_version }}
  - librdkit-dev >=${{ rdkit_min_version }}
  - libboost-devel  # run-export: libboost
  - libboost-python-devel  # run-export: libboost-python
  - numpy >=2.0.0,<3  # run-export: numpy
  - eigen
  - spdlog >=1.15.3,<2

  run:
  - python
  - rdkit >=${{ rdkit_min_version }}

  ignore_run_exports:
    from_package:
    - spdlog

tests:
  - python:
      imports:
      - prexsyn_engine
      pip_check: true

about:
  homepage: https://github.com/luost26/prexsyn-engine
  summary: 'C++ backend library for PrexSyn with Python bindings'
  description: |
    PrexSyn Engine is the C++ backend library for PrexSyn.
    It provides a high-throughput data pipeline that generates synthetic pathways annotated with molecular properties to train PrexSyn models.
    It also includes a fast detokenizer for reconstructing synthetic pathways and product molecules from model outputs.
  license: MIT
  license_file: LICENSE
  documentation: https://prexsyn.readthedocs.io/
  repository: https://github.com/luost26/prexsyn-engine

extra:
  recipe-maintainers:
    - luost26
