# adapted from conda-forge/matplotlib-feedstock, conda-forge/xgboost-feedstock 
# and interpretml/interpret/scripts/conda recipes 

{% set version = "0.2.7" %}

package:
  name: interpret-suite
  version: {{ version }}

source:
  url: https://github.com/interpretml/interpret/archive/v{{ version }}.tar.gz  
  sha256: 762d153b02f29c6518d26f5b46927c11046b2df754223450a5951729afff2ad3

build:
  number: 0

outputs: 
  - name: interpret-core
    script: bld_core.bat  # [win]
    script: bld_core.sh  # [not win]   
    requirements:
      build: 
        - {{ compiler('c') }}
        - {{ compiler('cxx') }}
        - cmake
        - make
        - nodejs
      host: 
        - pip
        - python
      run:
        - python 
      run_constrained:
        # Equiv. to required.
        - scikit-learn >=0.18.1
        - numpy >=1.11.1
        - scipy >=0.18.1
        - pandas >=0.19.2
        - joblib >=0.11
        # Equiv. to extras.
        - ipython >=7.4.0
        - ipykernel >=5.1.0
        - plotly >=3.8.1
        - lime >=0.1.1.33
        - SALib >=1.3.3
        - shap >=0.25.5
        - dill >=0.2.5
        - dash >=1.0.0
        - dash-cytoscape >=0.1.1
        - gevent >=1.3.6
        - requests >=2.19.0
    test:
      imports:
        - interpret
        - interpret.api

  - name: interpret
    script: bld.bat  # [win]
    script: bld.sh  # [not win]
    requirements:
      host: 
        - python
        - pip
      run:
        - python
        - {{ pin_subpackage('interpret-core', max_pin="x.x.x") }}        
        # Equiv. to required.
        - scikit-learn >=0.18.1
        - numpy >=1.11.1
        - scipy >=0.18.1
        - pandas >=0.19.2
        - joblib >=0.11
        # Equiv. to extras.
        - ipython >=7.4.0
        - ipykernel >=5.1.0
        - plotly >=3.8.1
        - lime >=0.1.1.33
        - SALib >=1.3.3
        - shap >=0.25.5
        - dill >=0.2.5
        - dash >=1.0.0
        - dash_cytoscape >=0.1.1
        - gevent >=1.3.6
        - requests >=2.19.0
    test:
      imports:
      - interpret

about:
  home: https://interpret.ml
  summary: Fit interpretable machine learning models. Explain blackbox machine learning.
  license: MIT
  license_file: LICENSE
  dev_url: https://github.com/interpretml/interpret
  doc_url: https://interpret.ml/docs/

extra:
  feedstock-name: interpret
  recipe-maintainers:
    - philip-khor
