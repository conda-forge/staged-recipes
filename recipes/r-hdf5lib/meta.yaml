{% set version = '2.0.0.4' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-hdf5lib
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/hdf5lib_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/hdf5lib/hdf5lib_{{ version }}.tar.gz
  sha256: 5226aecadd98c7968792bae97b2b7cc99ff71210d97507238a4f1143b30be011

build:
  number: 0
  rpaths:
    - lib/R/lib/
    - lib/

requirements:
  build:
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
    - {{ stdlib("c") }}            # [not win]
    - {{ compiler('c') }}          # [not win]
    - {{ stdlib("m2w64_c") }}      # [win]
    - {{ compiler('m2w64_c') }}    # [win]
    - {{ posix }}filesystem        # [win]
    - {{ posix }}make
    - {{ posix }}sed               # [win]
    - {{ posix }}coreutils         # [win]
    - {{ posix }}zip               # [win]
  host:
    - r-base
  run:
    - r-base

test:
  commands:
    - $R -e "library('hdf5lib')"  # [not win]
    - "\"%R%\" -e \"library('hdf5lib')\""  # [win]

about:
  home: https://cmmr.github.io/hdf5lib
  dev_url: https://github.com/cmmr/hdf5lib
  summary: "'HDF5' (Hierarchical Data Format 5) is a high-performance library and file format for storing and managing large, complex data. This package provides the static libraries and headers for the 'HDF5' 'C' library (release 2.0.0). It is intended for R package developers to use in the 'LinkingTo' field, which eliminates the need for users to install system-level 'HDF5' dependencies. This build is compiled with thread-safety enabled and supports dynamic loading of external compression filters. 'HDF5' is developed by 'The HDF Group' <https://www.hdfgroup.org/>."
  license: MIT
  license_family: MIT
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/MIT'
    - LICENSE

extra:
  recipe-maintainers:
    - conda-forge/r
    - dansmith01
