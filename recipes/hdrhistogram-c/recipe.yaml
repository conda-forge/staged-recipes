context:
  version: "0.11.9"

package:
  name: hdrhistogram-c
  version: ${{ version }}

source:
  url: https://github.com/HdrHistogram/HdrHistogram_c/archive/refs/tags/${{ version }}.tar.gz
  sha256: 0eb5fdb9f1f8c4b9c6eb319502f8d9e28991afffb8418672a61741993855650e

build:
  script:
    - if: unix
      then:
        - cmake -B build -G Ninja ${CMAKE_ARGS} -DHDR_HISTOGRAM_BUILD_PROGRAMS=OFF -DHDR_HISTOGRAM_INSTALL_STATIC=OFF -DHDR_HISTOGRAM_INSTALL_SHARED=ON .
      else:
        - cmake -B build -G Ninja %CMAKE_ARGS% -DHDR_HISTOGRAM_BUILD_PROGRAMS=OFF -DHDR_HISTOGRAM_INSTALL_STATIC=OFF -DHDR_HISTOGRAM_INSTALL_SHARED=ON -DCMAKE_WINDOWS_EXPORT_ALL_SYMBOLS=ON .
    - cmake --build build
    - cmake --install build
  number: 0

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ stdlib('c') }}
    - cmake
    - ninja
  host:
    - zlib
  run_constraints:
    - ${{ pin_subpackage('hdrhistogram-c', upper_bound='x.x.x') }}

tests:
  - package_contents:
      lib:
        - hdr_histogram

about:
  homepage: https://github.com/HdrHistogram/HdrHistogram_c
  summary: C port of the HdrHistogram
  description: |
    HdrHistogram_c: 'C' port of High Dynamic Range (HDR) Histogram
  license: BSD-2-Clause OR CC0-1.0
  license_file:
    - LICENSE.txt
    - COPYING.txt
  documentation: https://github.com/HdrHistogram/HdrHistogram_c
  repository: https://github.com/HdrHistogram/HdrHistogram_c

extra:
  recipe-maintainers:
    - pavelzw
