{% set version = "0.8.7" %}

package:
  name: containernetworking-plugins
  version: {{ version }}

source:
  url: https://github.com/containernetworking/plugins/archive/v{{ version }}.tar.gz
  sha256: de9fa170b4b6d38f6ff5287b313ddaf3c31f70bccb10e971ad59adadae22dd74
  folder: src

build:
  number: 0
  skip: True  # [not linux]

requirements:
  build:
    - {{ compiler('go') }}
    - go-licenses
  host:

test:
  commands:
    - test -f "${PREFIX}/libexec/cni/bandwidth"
    - test -f "${PREFIX}/libexec/cni/bridge"
    - test -f "${PREFIX}/libexec/cni/dhcp"
    - test -f "${PREFIX}/libexec/cni/firewall"
    - test -f "${PREFIX}/libexec/cni/flannel"
    - test -f "${PREFIX}/libexec/cni/host-device"
    - test -f "${PREFIX}/libexec/cni/host-local"
    - test -f "${PREFIX}/libexec/cni/ipvlan"
    - test -f "${PREFIX}/libexec/cni/loopback"
    - test -f "${PREFIX}/libexec/cni/macvlan"
    - test -f "${PREFIX}/libexec/cni/portmap"
    - test -f "${PREFIX}/libexec/cni/ptp"
    - test -f "${PREFIX}/libexec/cni/sbr"
    - test -f "${PREFIX}/libexec/cni/static"
    - test -f "${PREFIX}/libexec/cni/tuning"
    - test -f "${PREFIX}/libexec/cni/vlan"

about:
  home: https://github.com/containernetworking/plugins
  license: Apache-2.0
  license_family: Apache
  license_file:
    - LICENSE
    - thirdparty-licenses.txt
  summary: Container Network Interface (CNI) plugins maintained by the containernetworking team.
  description: >
    CNI (Container Network Interface), a Cloud Native Computing Foundation project, consists of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. CNI concerns itself only with network connectivity of containers and removing allocated resources when the container is deleted. Because of this focus, CNI has a wide range of support and the specification is simple to implement.

extra:
  recipe-maintainers:
    - mbargull
