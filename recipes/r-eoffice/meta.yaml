{% set version = '0.2.2' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-eoffice
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/eoffice_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/eoffice/eoffice_{{ version }}.tar.gz
  sha256: 44b31804cd6aef8ca9bec1535b9c4a9ec46d429ffb8c8e045ec5f6a732a5be5b

build:
  number: 0
  noarch: generic
  rpaths:
    - lib/R/lib/
    - lib/
  missing_dso_whitelist:
    - '*/R.dll'        # [win]
    - '*/Rblas.dll'    # [win]
    - '*/Rlapack.dll'  # [win]

requirements:
  build:
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
  host:
    - r-base
    - r-r.devices
    - r-broom
    - r-devemf
    - r-dplyr
    - r-flextable
    - r-ggplot2
    - r-ggplotify
    - r-htmlwidgets
    - r-magick
    - r-magrittr
    - r-officer
    - r-plotly
    - r-rvg
  run:
    - r-base
    - r-r.devices
    - r-broom
    - r-devemf
    - r-dplyr
    - r-flextable
    - r-ggplot2
    - r-ggplotify
    - r-htmlwidgets
    - r-magick
    - r-magrittr
    - r-officer
    - r-plotly
    - r-rvg

test:
  commands:
    - $R -e "library('eoffice')"           # [not win]
    - "\"%R%\" -e \"library('eoffice')\""  # [win]

about:
  home: https://CRAN.R-project.org/package=eoffice
  license: GPL-2.0-only
  summary: Provides wrap functions to export and import graphics and data frames in R to 'microsoft'
    office. And This package also provide write out figures with lots of different formats.
    Since people may work on the platform without GUI support, the package also provide
    function to easily write out figures to lots of different type of formats. Now this
    package provide function to extract colors from all types of figures and pdf files.
  license_family: GPL2
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/GPL-2'

extra:
  recipe-maintainers:
    - conda-forge/r

# Package: eoffice
# Type: Package
# Title: Export or Graph and Tables to 'Microsoft' Office and Import Figures and Tables
# Version: 0.2.2
# Authors@R: person("Kai", "Guo", email = "guokai8@gmail.com", role = c("aut", "cre"))
# Description: Provides wrap functions to export and import graphics and data frames in R to 'microsoft' office. And This package also provide write out figures with lots of different formats. Since people may work on the platform without GUI support, the package also provide function to easily write out figures to lots of different type of formats. Now this package provide function to extract colors from all types of figures and pdf files.
# License: GPL-2
# Imports: officer, rvg, flextable, broom, dplyr, magrittr, ggplotify, R.devices, devEMF, magick, ggplot2, htmlwidgets, plotly
# Depends:
# Encoding: UTF-8
# Suggests: knitr, markdown, rmarkdown
# VignetteBuilder: knitr
# RoxygenNote: 7.1.1
# NeedsCompilation: no
# Packaged: 2022-10-05 07:16:00 UTC; bioguo
# Author: Kai Guo [aut, cre]
# Maintainer: Kai Guo <guokai8@gmail.com>
# Repository: CRAN
# Date/Publication: 2022-10-05 07:30:02 UTC
