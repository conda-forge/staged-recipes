From 3e35a572cb01b123970592d650dcd5188a837ea9 Mon Sep 17 00:00:00 2001
From: Olivier Roussel <olivier.roussel@inria.fr>
Date: Tue, 9 Dec 2025 11:47:44 +0100
Subject: [PATCH 1/2] patch for conda-forge package

---
 CMakeLists.txt                 | 14 ++++++++------
 src/tight_inclusion/logger.hpp |  2 +-
 2 files changed, 9 insertions(+), 7 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index d02e813..ad1f596 100755
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,10 +1,10 @@
 # Detects whether this is a top-level project
 get_directory_property(HAS_PARENT PARENT_DIRECTORY)
-if(HAS_PARENT)
-    set(TIGHT_INCLUSION_TOPLEVEL_PROJECT OFF)
-else()
-    set(TIGHT_INCLUSION_TOPLEVEL_PROJECT ON)
-endif()
+# if(HAS_PARENT)
+#     set(TIGHT_INCLUSION_TOPLEVEL_PROJECT OFF)
+# else()
+#     set(TIGHT_INCLUSION_TOPLEVEL_PROJECT ON)
+# endif()
 
 # Check required CMake version
 set(REQUIRED_CMAKE_VERSION "3.18.0")
@@ -96,7 +96,7 @@ set(CMAKE_POSITION_INDEPENDENT_CODE ON)
 ################################################################################
 
 # Add an empty library and fill in the list of sources in `src/CMakeLists.txt`.
-add_library(tight_inclusion)
+add_library(tight_inclusion SHARED)
 add_library(tight_inclusion::tight_inclusion ALIAS tight_inclusion)
 
 # Fill in configuration options
@@ -123,10 +123,12 @@ target_compile_definitions(tight_inclusion PUBLIC NOMINMAX)
 ################################################################################
 
 # Eigen
+find_package(Eigen3 REQUIRED)
 include(eigen)
 target_link_libraries(tight_inclusion PUBLIC Eigen3::Eigen)
 
 # Logger
+find_package(spdlog REQUIRED)
 include(spdlog)
 target_link_libraries(tight_inclusion PUBLIC spdlog::spdlog)
 
diff --git a/src/tight_inclusion/logger.hpp b/src/tight_inclusion/logger.hpp
index ccf3593..98acdda 100644
--- a/src/tight_inclusion/logger.hpp
+++ b/src/tight_inclusion/logger.hpp
@@ -1,7 +1,7 @@
 #pragma once
 
 // clang-format off
-#include <spdlog/fmt/bundled/ranges.h>
+#include <spdlog/fmt/ranges.h>
 #include <spdlog/fmt/ostr.h>
 #include <spdlog/spdlog.h>
 // clang-format on
-- 
2.43.0

