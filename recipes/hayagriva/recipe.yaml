schema_version: 1

context:
  version: "0.9.1"

package:
  name: hayagriva
  version: ${{ version }}

source:
  url: https://github.com/typst/hayagriva/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 91d451608e96b3e06fe98d6bc20915b62eda69ff4fdfdbb2ae9b098eeb11a690

build:
  number: 0
  script:
    env:
      CARGO_PROFILE_RELEASE_STRIP: symbols
      CARGO_PROFILE_RELEASE_LTO: fat
    content:
      - if: unix
        then:
          - cargo install --features cli --no-track --locked --root ${PREFIX} --path .
          - cargo-bundle-licenses --format yaml --output ${SRC_DIR}/THIRDPARTY.yml
      - if: win
        then:
          - cargo install --features cli --no-track --locked --root %PREFIX% --path .
          - if errorlevel 1 exit 1
          - cargo-bundle-licenses --format yaml --output %SRC_DIR%/THIRDPARTY.yml
          - if errorlevel 1 exit 1

requirements:
  build:
    - ${{ compiler('rust') }}
    - ${{ stdlib('c') }}
    - ${{ compiler('c') }}
    - cargo-bundle-licenses

tests:
  - script:
      - hayagriva --help

about:
  homepage: https://github.com/typst/hayagriva
  repository: https://github.com/typst/hayagriva
  documentation: https://github.com/typst/hayagriva
  summary: Rusty bibliography management
  description: |
    Hayagriva is a tool that helps users and applications work with literature
    and other media. It provides data structures for representing literature
    collections, supports reading and writing these collections in YAML format,
    and allows items to be queried by type and metadata. In addition, Hayagriva
    can format literature into reference lists and in-text citations according
    to common style guides and offers interoperability with BibTeX.
  license: MIT
  license_file:
    - LICENSE-MIT
    - THIRDPARTY.yml

extra:
  recipe-maintainers:
    - apcamargo
