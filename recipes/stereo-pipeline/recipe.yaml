context:
  name: stereo-pipeline
  version: "3.5.0"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
    url: https://github.com/NeoGeographyToolkit/StereoPipeline/archive/refs/tags/{{ version }}.zip
    sha256: 4f1fcfff3a2ae058496b2b78437195dc073423a57d1a9db05a24782961278a2f
    target_directory: src

build:
  number: 0
  skip: win
  script: build.sh

requirements:
  build:
    - ${{ compiler("c") }}
    - ${{ compiler("cxx") }}
    - ${{ stdlib("c") }}
    - cmake >=3.15
    - make
  host:
    - flann
    - libboost-devel
    - libgdal
    - libblas * *openblas
    - libopencv
    - libjpeg-turbo
    - libpng
    - libtiff

tests:
  - script:
    # Test loading a camera and doing image-to-ground and ground-to-image operations
    - cam_test --image $PREFIX/share/tests/ctx.json --cam1 $PREFIX/share/tests/ctx.json --cam2 $PREFIX/share/tests/ctx.json

about:
  homepage: https://github.com/NeoGeographyToolkit/StereoPipeline
  summary: 'A suite of tools for producing terrain models published by NASA'
  description: |
    The NASA Ames Stereo Pipeline is a collection of tools for producing 3D terrain models from images acquired by satellites of planets and of Earth. It also supports alignment of terrains, correction of errors in camera positions and orientations, and structure from motion.
  license: Apache-2.0
  license_family: Apache
  license_file: COPYING
  documentation: https://stereopipeline.readthedocs.io/en/latest/index.html
  repository: https://github.com/NeoGeographyToolkit/StereoPipeline

extra:
  recipe-maintainers:
    - oleg-alexandrov

