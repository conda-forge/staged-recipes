{% set version = "0.8.0" %}

package:
  name: libraqm
  version: {{ version }}

source:
  url: https://github.com/HOST-Oman/libraqm/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 6429e35f69f5e7d514877624fb73ae6d07a7e9ac746ae6a1cf2bf1277bb5b68d

build:
  number: 0
  script:
    - meson build --prefix=$PREFIX --libdir=lib  # [unix]
    - meson build --prefix=%PREFIX%              # [win]
    - ninja -C build
    - ninja -C build install

requirements:
  build:
    - {{ compiler('c') }}
    - meson
    - ninja
    - pkgconfig
  host:
    - freetype
    - fribidi
    - harfbuzz
test:
  commands:
    # shared
    - test -f $PREFIX/lib/libraqm.so              # [linux]
    - test -f $PREFIX/lib/libraqm.dylib           # [osx]
    - if not exist %LIBRARY_BIN%\raqm.dll exit 1  # [win]

    # absence of static libraries
    - test ! -f $PREFIX/lib/libraqm.a             # [not win]

    # header
    - test -f $PREFIX/include/raqm.h              # [unix]
    - if not exist %LIBRARY_INC%\raqm.h exit 1    # [win]

about:
  home: http://host-oman.github.io/libraqm/
  license: MIT
  license_file: COPYING
  summary: Evaluation software used in the Text Retrieval Conference
  dev_url: https://github.com/HOST-Oman/libraqm

extra:
  recipe-maintainers:
    - h-vetinari
