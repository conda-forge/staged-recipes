{% set version = "1.0.4" %}

package:
  name: doccano
  version: {{ version }}

source:
  url: https://github.com/doccano/doccano/archive/v{{ version }}.tar.gz
  sha256: e74680d4bb677bf03bd27b4f3ead9fa84624bb85f7ab1063b11b90e923f65105
  patches:
    - rmv_drf_yasg.patch  # remove unneccesary dep drf_yasg in app/app/settings.py and app/app/urls.py

build:
  number: 0
  skip: True  # [win]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - nodejs
  host:
    - pip
    - python
    - nodejs
  run:
    - python
    - nodejs {{ node_version }}
    - apache-libcloud >=2.4.0
    - applicationinsights >=0.11.7
    - colour >=0.1.5
    - chardet >=3.0.4
    - coverage >=4.5.3
    - dj-database-url >=0.5.0
    - django
    - django-cloud-browser >=0.5.0
    - django-cors-headers
    - django-filter
    - django-heroku >=0.3.1
    - django-webpack-loader >=0.6.0
    - django-widget-tweaks >=1.4.2
    - django_polymorphic >=2.0.3
    - django-pyodbc-azure >=2.1.0.0
    - django-rest-polymorphic >=0.1.8
    - djangorestframework >=3.10
    - djangorestframework-csv >=2.1.0
    - djangorestframework-filters >=0.10.2
    - environs >=4.1.0
    - djangorestframework-xml >=1.4.0
    - faker >=0.9.1
    - flake8 >=3.6.0
    - furl >=2.0.0
    - gunicorn >=19.9.0
    - lockfile >=0.12.2
    - model_bakery >=1.1.0
    - mysqlclient >=1.4.2.post1
    - psycopg2 >=2.7.7
    - pyexcel >=0.5.14
    - pyexcel-xlsx >=0.5.7
    - python-dateutil >=2.7.3
    - pytz >=2018.4
    - requests >=2.21.0
    - six >=1.11.0
    - seqeval >=0.0.6
    - social-auth-app-django >=3.1.0
    - social-auth-core[azuread] >=3.0.0
    - text-unidecode >=1.2
    - unittest-xml-reporting >=2.5.1
    - vcrpy >=2.0.1
    - vcrpy-unittest >=0.1.7
    - whitenoise[brotli] >=4.1.2
    - conllu >=1.3.2

test:
  requires:
    - python
    - nodejs {{ node_version }}
    - django

  commands:
    - cd app
    - python3 manage.py migrate
    - python3 manage.py create_admin --noinput --username "admin" --email "admin@example.com" --password "password"
    - python3 manage.py test server.tests

  source_files:
    - app/

about:
  home: https://github.com/doccano/doccano
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: Open source text annotation tool for machine learning practitioner.
  doc_url: https://github.com/doccano/doccano
  dev_url: https://github.com/doccano/doccano

extra:
  recipe-maintainers:
    - rluria14
    - oblute
