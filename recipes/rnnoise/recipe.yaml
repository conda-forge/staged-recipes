schema_version: 1

context:
  version: "0.2"
  # The appropriate model_version is found in the
  # https://gitlab.xiph.org/xiph/rnnoise/-/blob/v${{ version }}/model_version
  model_version: "0b50c45"

package:
  name: rnnoise
  version: ${{ version }}

source:
  - url: https://gitlab.xiph.org/xiph/rnnoise/-/archive/v${{ version }}/rnnoise-v${{ version }}.tar.gz
    sha256: fafc947fdd24109a6e72b5f25e4224b54bc74660a2620af5548def85be8c733a
    patches:
      - if: win
        then: dump_features_windows_fix.patch
  # The following URL is for the model data required by RNNoise
  # The project has a download_model.sh script that historically does this.
  - url: https://media.xiph.org/rnnoise/models/rnnoise_data-${{ model_version }}.tar.gz
    sha256: 4ac81c5c0884ec4bd5907026aaae16209b7b76cd9d7f71af582094a2f98f4b43

build:
  number: 0

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ stdlib('c') }}
    - pkg-config
    - if: unix
      then:
        - gnuconfig
        - make
        - autoconf
        - automake
        - libtool
    - if: win
      then:
        - autotools_clang_conda

tests:
  - package_contents:
      lib:
        - rnnoise*
      include:
        - rnnoise.h
      files:
        - ${{ "Library/" if win }}lib/pkgconfig/rnnoise.pc

about:
  homepage: https://gitlab.xiph.org/xiph/rnnoise
  summary: "Recurrent neural network for audio noise reduction"
  description: |
    RNNoise is a noise suppression library based on a recurrent neural network.

    Features:
    - Real-time noise suppression using deep learning
    - Optimized for speech enhancement
    - Low computational overhead
    - Works on 48 kHz mono audio
    - Designed by Xiph.Org Foundation

    RNNoise is particularly effective at:
    - Removing background noise from speech
    - Enhancing voice quality in VoIP applications
    - Improving audio quality in streaming applications
    - Processing audio in real-time scenarios

    The library uses a GRU-based recurrent neural network trained on a large
    dataset of speech and noise samples. It's designed to run efficiently
    on both desktop and mobile devices.

  license: BSD-3-Clause
  license_file: COPYING
  repository: https://gitlab.xiph.org/xiph/rnnoise
  documentation: https://gitlab.xiph.org/xiph/rnnoise/-/blob/main/README.md

extra:
  recipe-maintainers:
    - phreed
