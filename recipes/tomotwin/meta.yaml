{% set name = "tomotwin-cryoet" %}
{% set version = "0.5.2b1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/tomotwin-cryoet-{{ version }}.tar.gz
  sha256: 4bc7328f272fdbae1be4204dfbd0026820f1c9e5f71e9d13142ac7bbde20551a

build:
  entry_points:
    - tomotwin_train.py = tomotwin.train_main:_main_
    - tomotwin_embed.py = tomotwin.embed_main:_main_
    - tomotwin_map.py = tomotwin.map_main:_main_
    - tomotwin_locate.py = tomotwin.locate_main:_main_
    - tomotwin_pick.py = tomotwin.pick_main:_main_
    - tomotwin_scripts_evaluate.py = scripts.evaluation:_main_
    - tomotwin_dev_matrix.py = scripts.pdb_similarity_matrix:_main_
    - tomotwin_dev_json2tloc.py = scripts.json2tloc:_main_
    - tomotwin_dev_optuna.py = tomotwin.train_optuna:_main_
    - tomotwin_dev_molmapbbox.py = scripts.molmapsbbox:_main_
    - tomotwin_tools.py = tomotwin.tools_main:_main_
  noarch: python
  script: {{ PYTHON }} -m pip install . -vv
  number: 0

requirements:
  host:
    - python >=3.7
    - setuptools-scm
    - pip
  run:
    - python >=3.7
    - mrcfile
    - tensorboard
    - numpy >=1.20.0
    - scikit-learn
    - scikit-image
    - pystardb >=0.4.2
    - pandas <=2
    - pytorch-metric-learning <1.7
    - numba
    - tabulate
    - setuptools-scm
    - tqdm

test:
  imports:
    - scripts
    - tomotwin
  commands:
    - pip check
    - tomotwin_train.py --help
    - tomotwin_embed.py --help
    - tomotwin_map.py --help
    - tomotwin_locate.py --help
    - tomotwin_pick.py --help
    - tomotwin_scripts_evaluate.py --help
    - tomotwin_dev_matrix.py --help
    - tomotwin_dev_json2tloc.py --help
    - tomotwin_dev_optuna.py --help
    - tomotwin_dev_molmapbbox.py --help
    - tomotwin_tools.py --help
  requires:
    - pip

about:
  home: https://github.com/MPI-Dortmund/tomotwin-cryoet
  summary: Picking procedure for cryo em tomography
  license: MPL-2.0
  license_file: LICENSE

extra:
  recipe-maintainers:
    - thorstenwagner
