schema_version: 1

context:
  version: 0.12.1

package:
  name: taskiq
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/t/taskiq/taskiq-${{ version }}.tar.gz
  sha256: 338dcf58eaca327e511a9380b2185bfa6a415dd79a5cf144546a2dbb95459298

build:
  number: 0
  skip: py>=400 or match(python, ">=2,<3")
  script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  python:
    entry_points:
      - taskiq = taskiq.__main__:main

requirements:
  host:
    - python >=3.10,<4
    - uv_build >=0.9.16,<0.10.0
    - pip
  run:
    - python >=3.10,<4
    - if: match(python, "<3.11")
      then: typing_extensions >=3.10.0.0
    - pydantic >=1.0,<=3.0
    - pycron >=3.0.0
    - taskiq-dependencies <2,>=1.3.1
    - anyio >=4
    - packaging >=19
    - izulu ==0.50.0
    - aiohttp >=3  #
    # Extra: cbor
    - cbor2 >=5  #
    # Extra: metrics
    - prometheus_client >=0  #
    # Extra: msgpack
    - msgpack-python >=1.0.7  #
    # Extra: opentelemetry
    - opentelemetry-api (,>=1.38.0,<2.0.0)
    - opentelemetry-instrumentation (,>=0.59b0,<1)
    - opentelemetry-semantic-conventions (,>=0.59b0,<1)  #
    # Extra: orjson
    - orjson >=3  #
    # Extra: reload
    - watchdog >=4
    - gitignore-parser >=0  #
    # Extra: uv
    - uvloop >=0.16.0,<1;sys_platform,!='win32'  #
    # Extra: zmq
    - pyzmq >=26

tests:
  - python:
      imports:
        - taskiq
      pip_check: true
  - requirements:
      run:
        - pip
        - python
    script:
      - taskiq --help

about:
  summary: Distributed task queue with full async support
  license: MIT
  license_file: LICENSE
  homepage: https://taskiq-python.github.io/
  documentation: https://taskiq-python.github.io/

extra:
  recipe-maintainers:
    - AndreasAlbertQC
