context:
  name: fulgor
  version: "3.0.0"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  - url: https://github.com/jermp/fulgor/archive/refs/tags/v${{ version }}.tar.gz
    sha256: f5a39658c71b6d937bf977c91de656c20f32372e195b5e41d57d271270fdb661
  # List of submodules
  - url: https://github.com/rob-p/FQFeeder/archive/bbc6e70c3bc412646b576d5074aa2edcbcfade61.tar.gz
    sha256: 4e4cb9cf9f33e5c653cf2d0fff23930c618c9fd084b6ca23dd20972431a1a871
    target_directory: external/FQFeeder
  - url: https://github.com/algbio/ggcat/archive/b6a2c2bf409a6a58540b8d23504c4fb7f8c655ef.tar.gz
    sha256: c029b2b7524905094b33e9bb3619cabf8aaa7a4f7fd7c7fce527bccde3a2a814
    target_directory: external/ggcat
    patches:
      - patches/01.ggcat_time.patch
      - patches/02.ggcat_cpp_bindings_output.patch
      - patches/03.ggcat_disable_crates.patch
  - url: https://github.com/jermp/kmeans/archive/a02b62c49f6f91a8e4b3b6c17fa74169864303f2.tar.gz
    sha256: c68aded8341813ed5916e9b8c9d780fdee0046d25be92494395545638b92a95e
    target_directory: external/kmeans
  - url: https://github.com/jermp/cmd_line_parser/archive/387761007070b7f6f05759c1faf7f0a90c513b0f.tar.gz
    sha256: 7d9b906084d23bc2f73d44875a799cbe33d33b3a6f3524755a16a82cffd52893
    target_directory: external/kmeans/external/cmd_line_parser
  - url: https://github.com/dnbaker/sketch/archive/4d1649f01abea2264edcad3ef2ba7d4bef4fd731.tar.gz
    sha256: 1fffa6ddfda2577c98c13aa09255fd3686b09bc8ef6b03453190c99d09479282
    target_directory: external/sketch
  - url: https://github.com/shibatch/sleef/archive/0b3c2edb5a0b53d2ffa1062c0fcb189ec20cedba.tar.gz
    sha256: 5bb32e1ee56ad91ac03eba9803d80fddd5419673e015769739fa1a57ed3447e1
    target_directory: external/sketch/include/vec/sleef
  - url: https://github.com/pybind/pybind11/archive/d462dd91a58116a043974b198462864a527e84ca.tar.gz
    sha256: 179b361610812e1daaaa9f5b4d48fd4d3d5293195ee9edbf91c868459b1c8673
    target_directory: external/sketch/pybind11
  - url: https://github.com/aappleby/smhasher/archive/61a0530f28277f2e850bfc39600ce61d02b518de.tar.gz
    sha256: daa4bb23e24fe26a2f9d1bb0d241fff7eb963f7b7525fa20685e0dfb3b3ffa49
    target_directory: external/smhasher
  - url: https://github.com/jermp/sshash/archive/05d61277f1531d4dc6d6de26c37536979f579896.tar.gz
    sha256: da7c21c0605b79d3383d1f5d40c898a18020f315826d31fa387bce5465495a9a
    target_directory: external/sshash
  - url: https://github.com/jermp/pthash/archive/94663599ab7d092a9301bf8c8709fbf558a04601.tar.gz
    sha256: 68fb0088dd87bca8f1d63e03a4eddbb3865c7ab39573495794ec7915249c39bf
    target_directory: external/sshash/external/pthash
  - url: https://github.com/jermp/cmd_line_parser/archive/14ebe0e2b5672fc2158a3e532ceb7f74347ec650.tar.gz
    sha256: 02c6032e371d9fe5d6c42dfa3f77971a941e3c1e7b22a3de1f9d12baed3224d3
    target_directory: external/sshash/external/pthash/external/cmd_line_parser
  - url: https://github.com/jermp/essentials/archive/2a546e3790ed1e2828e70254988eed73b9b56dd0.tar.gz
    sha256: 6e2b1ae58d3ad41a8b1cc7495ccdf0729938526239e81fe5328a76e318282f39
    target_directory: external/sshash/external/pthash/external/essentials
  - url: https://github.com/jermp/mm_file/archive/41ca01bd11f2f84e485d823231d7740794bd0ef5.tar.gz
    sha256: 139a4d4f71d638e137fdca742a73fb3265e5de38c242628ba9a6af7453ce8bdd
    target_directory: external/sshash/external/pthash/external/mm_file

build:
  number: 0

requirements:
  build:
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
    - ${{ compiler('rust') }} >=1.82
    - cargo-bundle-licenses
    - cmake
    - make
  host:
    - zlib

tests:
  - script:
    - fulgor | grep "a colored de Bruijn graph"

about:
  homepage: https://github.com/jermp/fulgor
  summary: 'Fulgor is a colored de Bruijn graph index for large-scale matching and color queries, powered by SSHash and GGCAT'
  license: MIT
  license_file:
    - LICENSE
    - THIRDPARTY.yml
  documentation: https://github.com/jermp/fulgor
  repository: https://github.com/jermp/fulgor

extra:
  recipe-maintainers:
    - luizirber
