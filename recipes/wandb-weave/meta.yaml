# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
context:
  version: 0.52.7

recipe:
  name: weave-split
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/{{ name[0] }}/{{ name }}/weave-{{ version }}.tar.gz
  sha256: 940aaf892b65c72c67cb893e97ed5339136a4b33a7ea85d52ed36671111826ef

build:
  number: 0

outputs:
  - name: wandb-weave
    build:
      script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
    requirements:
      host:
        - python
        - hatchling
        - pip
      run:
        - python
        - wandb >=0.17.1
        - sentry-sdk >=2.0.0,<3.0.0
        - pydantic >=2.0.0
        - packaging >=21.0
        - tenacity >=8.3.0,!=8.4.0
        - click
        - gql >=3.0.0
        - httpx
        - rich
        - huggingface-hub
        - jsonschema >=4.23.0
        - diskcache ==5.6.3
        - eval-type-backport
        - tzdata
      run_exports:
        - ${{ pin_subpackage("weave", exact=True) }}

    test:
      imports:
        - weave
      pip_check: true

  - name: wandb-weave-trace-server
    requirements:
      host:
        - python
      run:
        - ddtrace >=2.7.0
        - boto3 >=1.34.0
        - azure-storage-blob >=12.24.0,<12.26.0
        - google-cloud-storage >=2.7.0
        - litellm >=1.36.1
        - opentelemetry-proto >=1.12.0
        - opentelemetry-semantic-conventions-ai >=0.4.3
        - openinference-semantic-conventions >=0.1.17
        - emoji >=2.12.1
    test:
      commands:
        - python -c "import weave"  # adjust if you want something trace_server-specific

  - name: wandb-weave-scorers
    requirements:
      host:
        - python
      run:
        - numpy >1.21.0
        - levenshtein >=0.26.0
        - litellm >=1.58
        - sentence-transformers >=3.3.1
        - scikit-learn >=1.5.2
        - transformers >=4.51.1
        - torch >=2.4.1
        - sentencepiece >=0.2.0
        - pip >=20.0          # needed for presidio to pull spaCy models
        - presidio-analyzer >=2.2.0
        - presidio-anonymizer >=2.2.0
        - huggingface_hub >=0.28.1
    test:
      commands:
        - python -c "import weave"

  - name: wandb-weave-langchain
    requirements:
      host:
        - python
      run:
        - langchain-core >=0.2.1
        - langchain-openai >=0.1.7
        - langchain-community >=0.2.1
        - langchain-google-vertexai >=2.0.24
        - langchain-google-genai >=2.1.5
        - langchain-anthropic >=0.3.15
        - langchain-cohere >=0.4.5
        - langchain-litellm >=0.2.2
        - chromadb >=0.5.0
        - pysqlite3
        - opentelemetry-exporter-otlp
        - openai >=1.99.9,<1.100.0
    test:
      imports:
        - weave

  - name: wandb-weave-verifiers
    requirements:
      host:
        - python >=3.11
      run:
        - verifiers >=0.1.3.post0,<0.1.4
    test:
      imports:
        - weave

about:
  homepage: https://github.com/wandb/weave
  summary: A toolkit for building composable interactive data driven applications.
  license: Apache-2.0
  license_file: LICENSE

extra:
  feedstock-name: wandb-weave
  recipe-maintainers:
    - flferretti