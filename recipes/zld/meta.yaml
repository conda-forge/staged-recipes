{% set name = "zld" %}
{% set version = "1.3.3" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  # Building from `master` needs us to build static tbb, mimalloc, and abseil.
  # Change to `master` once this is merged.
  url: https://github.com/michaeleisel/{{ name }}/archive/refs/heads/homebrew-fixes-1.3.3.zip
  sha256: 76fc45c1feb5e77466d3fb1e4f242abc95ef293b93304a5e1706fd5758c54a17
  patches:
    - 000_install_correctly.patch

build:
  skip: True  # [not osx]
  number: 0
  script: make install

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - make
    - cmake

test:
  commands:
    - zld -v
    - zld --help

about:
  home: https://github.com/michaeleisel/zld
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: A faster version of Apple's linker
  description: |
    For large projects, the linking phase can significantly increase incremental build times. This project is a fork of the Apple linker, ld. It is a drop-in replacement that can substantially speed things up.
    Note: it is only intended for debug builds, to make debugging faster
  doc_url: https://github.com/michaeleisel/zld#usage

extra:
  recipe-maintainers:
    - matter-it-does
