{% set version = "0.4.0+rpt20250213" %}
{% set url_safe_version = version | urlencode %}

package:
  name: libcamera-rpi
  version: {{ version }}

source:
  url: https://github.com/raspberrypi/libcamera/releases/download/v{{ url_safe_version }}/libcamera-{{ url_safe_version }}.tar.xz
  sha256: 764b9b2ab16dbc4e90cd858cd2019be76e087e093bbdd08048d87d0a704f8e28
  patches:
    - memfd_symbols.patch

build:
  number: 0
  skip: true  # [not linux]
  
requirements:
  build:
    - cmake
    - ninja
    - meson
    # Needed for some build processes???
    - ply
    - pyyaml
    - jinja2
    - pkg-config
    - {{ compiler('cxx') }}
    - {{ compiler('c') }}
    - {{ stdlib('c') }}
  host:
    - libgl-devel
    - libglib
    # This dep is intentionally written twice; the second time allows
    # conda-build to add its global pin if one exists.
    - glib {{ local_glib_pin }}
    - glib
    - python
    - pybind11
    - jinja2
    - libudev
    - libudev1
    - gstreamer
    - gst-plugins-base
    - libevent
    - libdrm
    - libtiff
    - qt6-main
    - libdrm
    - libjpeg-turbo
    - yaml
    - libunwind
    - sdl2
    - openssl
    - libboost-devel
    - pyyaml
    - ply
  run:
    - python

test:
  commands:
    - echo "Tests not implemented for libcamera-rpi, needs rpicam-apps."

about:
  home: https://github.com/raspberrypi/libcamera
  summary: Raspberry Pi fork of libcamera
  license: > 
    LGPL-2.1-or-later
    AND BSD-2-Clause
    AND BSD-3-Clause
    AND MIT
    AND Apache-2.0
    AND CC0-1.0
    AND CC-BY-SA-4.0
    AND CC-BY-4.0
  license_file: LICENSES/

extra:
  recipe-maintainers:
    - carlodri
