context:
  version: "0.6.1"

package:
  name: scip
  version: ${{ version }}

source:
  url: https://github.com/sourcegraph/scip/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 6217912c9947d2d16a8a3c5f1ec31023125debd11759f3e116f08642b8d800ec
  target_directory: src

build:
  number: 0
  script:
    - cd src
    - go-licenses save . --save_path ../library_licenses
    - if: unix
      then: go build -v -o $PREFIX/bin/example-package -ldflags="-s -w"
      else: go build -v -o %LIBRARY_BIN%\example-package.exe -ldflags="-s"

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script: scip --version
  - package_contents:
      bin:
        - scip
      strict: true

about:
  home: https://github.com/sourcegraph/scip
  summary: SCIP Code Intelligence Protocol CLI
  license: Apache-2.0
  license_family: Apache
  license_file:
    - src/LICENSE
    - library_licenses/

extra:
  recipe-maintainers:
    - swenger
