{% set version = '0.1.1' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-mcprogress
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/mcprogress_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/mcprogress/mcprogress_{{ version }}.tar.gz
  sha256: 2d8259d0ea92526af0bac421b92a5770059c1876d6190a83f859f4c2b5482fac

build:
  number: 0
  noarch: generic
  rpaths:
    - lib/R/lib/
    - lib/
  missing_dso_whitelist:
    - '*/R.dll'        # [win]
    - '*/Rblas.dll'    # [win]
    - '*/Rlapack.dll'  # [win]

requirements:
  build:
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
  host:
    - r-base
  run:
    - r-base

test:
  commands:
    - $R -e "library('mcprogress')"           # [not win]
    - "\"%R%\" -e \"library('mcprogress')\""  # [win]

about:
  home: https://github.com/myles-lewis/mcprogress
  license: GPL-3.0-or-later
  summary: Tools for monitoring progress during parallel processing. Lightweight package which
    acts as a wrapper around mclapply() and adds a progress bar to it in 'RStudio' or
    'Linux' environments. Simply replace your original call to mclapply() with pmclapply().
    A progress bar can also be displayed during parallelisation via the 'foreach' package.
    Also included are functions to safely print messages (including error messages)
    from within parallelised code, which can be useful for debugging parallelised R
    code.
  license_family: GPL3
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/GPL-3'

extra:
  recipe-maintainers:
    - conda-forge/r
