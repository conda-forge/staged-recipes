file(TO_CMAKE_PATH "$ENV{RECIPE_DIR}/cmake/protoc-gen-add_export.cc" PROTOC_EXPORT_PATH)
add_executable(protoc-gen-add_export ${PROTOC_EXPORT_PATH})
set_target_properties(protoc-gen-add_export PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}"
    OUTPUT_NAME protoc-gen-add_export
    CXX_STANDARD_REQUIRED ON)
target_include_directories(protoc-gen-add_export PRIVATE ${Protobuf_INCLUDE_DIRS})
target_compile_definitions(protoc-gen-add_export PRIVATE PROTOBUF_USE_DLLS PUBLIC PROTOBUF_USE_DLLS)

if(WIN32)
    target_link_libraries(protoc-gen-add_export PRIVATE ${Protobuf_LIBRARIES} abseil_dll ${Protobuf_PROTOC_LIBRARIES})
else()
    target_link_libraries(protoc-gen-add_export PRIVATE protobuf::libprotobuf protobuf::libprotoc)
endif()

set(PROTOC_GEN_ADD_EXPORT_PATH "$<TARGET_FILE:protoc-gen-add_export>")
message(STATUS "protoc-gen-add_export path: ${PROTOC_GEN_ADD_EXPORT_PATH}")
