{% set version = "8.4.0" %}

package:
  name: grass
  version: {{ version }}

source:
  url: https://grass.osgeo.org/grass84/source/grass-{{ version }}.tar.gz
  sha256: 337f603fc05578aa754d56f85a4c6c98deb0f01f0e816fedc1e0954949956137

  # For testing:
  # git_url: https://github.com/OSGeo/grass.git
  # git_rev: main
  # git_depth: 1

  patches:
    - platform.make.in-mac.patch   # [osx]
    - platform.make.in-linux.patch # [linux]
    - rules.make.patch             # [linux]

build:
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ stdlib("c") }}
    - bison                   # [unix]
    - flex                    # [unix]
    - git
    - gnuconfig               # [unix]
    - make                    # [unix]
    - pkg-config
    - python
  host:
    - blas
    - cairo
    - fftw
    - freetype
    - geos
    - gettext
    - giflib
    - krb5
    - lapack
    - libgdal-core
    - libiconv
    - libjpeg-turbo
    - libpng
    - libtiff
    - matplotlib-base
    - numpy
    - pdal
    - poppler
    - postgresql
    - proj
    - python
    - python.app              # [osx]
    - setuptools
    - six
    - sqlite
    - wxpython
    - zstd

test:
  files:
    - run_test.sh

outputs:
  - name: grass
    version: {{ version }}
    script: install-grass.sh  # [unix]
    requirements:
      build:
      - {{ compiler('c') }}
      - {{ compiler('cxx') }}
      - {{ stdlib("c") }}
      - bison                 # [unix]
      - flex                  # [unix]
      - git
      - gnuconfig             # [unix]
      - make                  # [unix]
      - pkg-config
      - python
      host:
        - blas
        - cairo
        - fftw
        - freetype
        - geos
        - gettext
        - giflib
        - krb5
        - lapack
        - libgdal-core
        - libiconv
        - libjpeg-turbo
        - libpng
        - libtiff
        - matplotlib-base
        - numpy
        - pdal
        - poppler
        - postgresql
        - proj
        - python
        - python.app          # [osx]
        - setuptools
        - six
        - sqlite
        - wxpython
        - zstd
      run:
        - blas
        - cairo
        - fftw
        - freetype
        - gdal
        - geos
        - gettext
        - ghostscript
        - giflib
        - krb5
        - lapack
        - libgcc              # [linux]
        - libiconv
        - libjpeg-turbo
        - libpng
        - libtiff
        - matplotlib-base
        - numpy
        - pdal
        - pillow
        - pkg-config          # [osx]
        - ply
        - poppler
        - postgresql
        - proj
        - python
        - python.app          # [osx]
        - readline            # [unix]
        - setuptools
        - six
        - sqlite
        - wxpython
        - zstd

about:
  summary: Geographic Resources Analysis Support System
  description: |
    GRASS GIS, commonly referred to as GRASS (Geographic Resources
    Analysis Support System), is a free and open source Geographic
    Information System (GIS) software suite used for geospatial data
    management and analysis, image processing, graphics and maps
    production, spatial modeling, and visualization.
  home: https://grass.osgeo.org
  dev_url: https://github.com/OSGeo/grass
  license: GPL-2.0-or-later
  license_file: GPL.TXT

extra:
  feedstock-name: grass
  recipe-maintainers:
    - nilason
