# This file created by conda-build 3.16.1
# meta.yaml template originally from:
# /home/conda/recipe_root, last modified Sat Oct 13 22:04:58 2018
# ------------------------------------------------

package:
    name: esys-escript
    version: 5.4
source:
    - fn: boost_1_68_0.tar.bz2
      sha256: 7f6130bc3cf65f56a618888ce9d5ea704fa10b462be126ad053e80e553d6d8b7
      url: https://dl.bintray.com/boostorg/release/1.68.0/source/boost_1_68_0.tar.bz2
    - svn_url: https://svn.geocomp.uq.edu.au/svn/esys13/trunk
      svn_rev: 6850
      folder: escript
    # - fn: trilinos-12.12.1-Source.tar.gz
    #   url: http://trilinos.csbsju.edu/download/files/trilinos-12.12.1-Source.tar.gz
    #   folder: trilinos
build:
    number: '1001'
    string: py27h8619c78_1001

    binary_has_prefix_files:
        - bin/run-escript
        - bin/runmodel.py
        - esys
        - include/cusp
        - include/dudley
        - include/escript
        - include/finley
        - include/paso
        - include/ripley
        - include/speckley
        - include/weipa
        - lib/buildvars
        - lib/libdudley.so
        - lib/libescriptreader.so
        - lib/libescript.so
        - lib/libfinley.so
        - lib/libpaso.so
        - lib/libripley.so
        - lib/libspeckley.so
        - lib/libweipa.so

    always_include_files:
        - lib/libpython2.7.so
        - lib/libpython2.7.so.1.0
        - lib/libopenblasp-r0.3.6.so
        - lib/libopenblas.so.0
        - lib/libboost_system.so.1.70.0
        - lib/libboost_iostreams.so.1.70.0
        - lib/libgfortran.so.4

    rpaths:
        - bin
        - esys
        - include
        - lib
        - esys/boost/include
        - esys/boost/lib


requirements:
    build:
        - {{ compiler('cxx') }}
        - binutils_impl_linux-64 2.31.1 h6176602_1
        - binutils_linux-64 2.31.1 h6176602_3
        - gcc_impl_linux-64 7.3.0 habb00fd_1
        - gcc_linux-64 7.3.0 h553295d_3
        - gxx_impl_linux-64 7.3.0 hdf63c60_1
        - gxx_linux-64 7.3.0 h553295d_3
        - libgcc-ng 7.3.0 hdf63c60_0
        - libstdcxx-ng 7.3.0 hdf63c60_0
        - suitesparse
        - openblas
        - zlib
        - bzip2
        - xz
        # - trilinos
        # - openmpi

    host:
        - {{ compiler('cxx') }}
        - blas 1.1 openblas
        - boost-cpp 1.68.0 h11c811c_1000
        - ca-certificates 2018.03.07 0
        - icu 58.2 hf484d3e_1000
        - libgcc-ng 7.3.0 hdf63c60_0
        - libgfortran-ng 7.3.0 hdf63c60_0
        - libstdcxx-ng 7.3.0 hdf63c60_0
        - ncurses 6.1 hf484d3e_1001
        - numpy 1.9.3 py27_blas_openblash1522bff_1006
        - openblas 0.3.3 h9ac9557_1001
        - python 2.7.15 h938d71a_1004
        - suitesparse
        - openblas
        - zlib
        - bzip2
        - xz
        # - trilinos
        # - openmpi

    run:
        - boost-cpp 1.68.0.*
        - libgcc-ng >=7.3.0
        - libstdcxx-ng >=7.3.0
        - numpy >=1.9.3,<2.0a0
        - python >=2.7,<2.8.0a0
        - suitesparse
        - openblas
        - zlib
        - bzip2
        - xz
        # - trilinos
        # - openmpi

test:
    commands:
        - ${PREFIX}/utest.sh ${SRC_DIR}/escript_build '-t"${CPU_COUNT}"'
        
about:
  home: https://launchpad.net/escript-finley
  summary: esys-escript is a programming tool for implementing mathematical 
    models in python using the finite element method (FEM).
  license: Apache-2.0
  description: esys-escript is a programming tool for implementing 
    mathematical models in python using the finite element method (FEM). 
    As users do not access the data structures it is very easy to use and 
    scripts can run on desktop computers as well as highly parallel
    supercomputer without changes. Application areas for escript include 
    earth mantle convection, geophysical inversion, earthquakes, 
    porous media flow, reactive transport, plate subduction, erosion, 
    and tsunamis.
  dev_url: https://launchpad.net/escript-finley
  doc_url: https://launchpad.net/escript-finley
  doc_source_url: https://launchpad.net/escript-finley

extra:
  recipe-maintainers:
    - aellery
