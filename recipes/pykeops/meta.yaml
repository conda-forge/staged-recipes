{% set name = "pykeops" %}
{% set version = "1.1.1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: c5876c6a3e4764154dbbdf7294d3fc8900a5f9ed48891c0e08b28c3818bf229b

build:
  number: 0
  script: "{{ PYTHON }} -m pip install . -vv"
  skip: true  # [py2k]
  # Could be noarch: python except for the {{ compiler }} dependencies, I think

requirements:
  host:
    - python
    - pip
  run:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - cmake >=3.10
    - python
    - gputil
    - numpy

test:
  # there's also a run_test.py
  imports:
    - pykeops

about:
  home: https://www.kernel-operations.io
  license: MIT
  license_family: MIT
  # license in the feedstock; https://github.com/getkeops/keops/pull/15
  license_file: licence.txt
  summary: 'KErnel OPerationS, on CPUs and GPUs, with autodiff and without memory overflows'
  description: |
    The KeOps library lets you compute generic reductions of very large arrays
    whose entries are given by a mathematical formula. It combines a tiled
    reduction scheme with an automatic differentiation engine, and can be
    used through Matlab, NumPy or PyTorch backends. It is perfectly suited
    to the computation of Kernel dot products and the associated gradients,
    even when the full kernel matrix does not fit into the GPU memory.
  doc_url: https://www.kernel-operations.io/keops/python/
  dev_url: https://github.com/getkeops/keops

extra:
  recipe-maintainers:
    - dougalsutherland
