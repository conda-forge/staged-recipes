{% set name = "madagascar" %}
{% set version = "2.1b.20190131" %}
{% set git_rev = "5c501dcc92cef0acb3f94e957dccfff000018221" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  git_url: https://github.com/ahay/src
  git_rev: {{ git_rev }}
  patches:
    - SConstruct.patch

build:
  number: 1
  skip: True  # [win]

requirements:
  build:
    - {{ compiler('c') }}
    - scons
    - swig
    - {{ cdt('xorg-x11-proto-devel') }}  # [linux]
    - {{ cdt('mesa-libgl-devel') }}      # [linux]
    - {{ cdt('libXaw-devel') }}      # [linux]
  host:
    - python 2.7
    - numpy
    - openblas
    - libpng
    - cairo
  run:
    - python 2.7
    - scons
    - numpy
    - openblas

test:
  imports:
    - rsf.api
    - c_m8r
  commands:
    - test -f $PREFIX/bin/sfwiggle                 # [unix]
    - if not exist %PREFIX%\\bin\\sfwiggle exit 1  # [win]

about:
  home: http://www.ahay.org/wiki/Main_Page
  license: GPL
  license_file: COPYING.txt
  summary: "A package for reproducible geophysical data processing"

extra:
  recipe-maintainers:
    - dmitry-kabanov (kabanov.dmitry@gmail.com)
