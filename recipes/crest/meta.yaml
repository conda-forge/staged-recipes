{% set name = "crest" %}
{% set version = "2.11.1" %}

# Upstream issue: https://github.com/grimme-lab/crest/issues/4#issuecomment-772759578
{% set blas_impl = blas_impl or "mkl" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/grimme-lab/{{ name }}/archive/v{{ version }}.tar.gz
  sha256: 11ae0ef5b21fb08fe41c5d536329bccefb1292d76379317e97978012dde88106

build:
  number: 0
  skip: True  # [win or blas_impl != "mkl"]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('fortran') }}
    - meson >=0.55
    - ninja
    - asciidoctor
  host:
    - {{ blas_impl }}
    - llvm-openmp  # [osx]
    - libgomp  # [linux]
  run:
    - libblas * *{{ blas_impl }}
    - liblapack * *{{ blas_impl }}
    - {{ blas_impl }}
    - xtb


test:
  commands:
    - crest --version

about:
  home: https://github.com/grimme-lab/crest
  doc_url: https://xtb-docs.readthedocs.io/en/latest/crest.html
  license: LGPL-3.0-or-later
  license_family: LGPL
  license_file:
    - COPYING
    - COPYING.LESSER
  summary: Conformer-rotamer ensemble search tool
  description: |
    IO based OMP scheduler (i.e., calculations are performed by the xtb program)
    and tool for the creation and analysis of structure ensembles.

extra:
  recipe-maintainers:
    - awvwgk
