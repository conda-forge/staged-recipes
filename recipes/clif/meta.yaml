{% set version = "0.4.1" %}

package:
  name: clif-split
  version: {{ version }}

source:
  url: https://github.com/google/clif/archive/refs/tags/v0.4.1.tar.gz
  sha256: df12167d9d13a077b54e62b0b605a8ab9d4b68fcf51fb34328a91169c502fd18
  patches:
    - patches/0001-unpin-LLVM-adapt-sources-where-necessary.patch

build:
  number: 0

requirements:
  build:
    - {{ compiler('cxx') }}

outputs:
  - name: clif
    script: build-clif.sh   # [not win]
    script: build-clif.bat  # [win]
    version: {{ version }}
    build:
      run_exports:
        - {{ pin_subpackage("clif", max_pin="x.x.x") }}
    requirements:
      build:
        - {{ compiler('cxx') }}
        - cmake
        - ninja
        - pkg-config
      host:
        - python
        - clangdev
        - glog
        - gmock
        - gtest
        - libabseil
        - libprotobuf
        - llvmdev
        # to make $PREFIX/lib/cmake/llvm/Findzstd.cmake happy
        - zlib
        - zstd         # [win]
    test:
      commands:
        # TODO
        - exit 0

about:
  home: https://github.com/google/clif
  license: Apache-2.0
  license_file: LICENSE
  summary: C++ Language Interface Foundation (CLIF)
  dev_url: https://github.com/google/clif

extra:
  recipe-maintainers:
    - h-vetinari
  feedstock-name: clif
