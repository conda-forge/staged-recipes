# To generate the version number
{%- if false %}
git clone git@github.com:google/libnop.git
cd libnop
git pull
echo 0.0.0.$(date  +%Y%m%d -d "$(git show -s --format=%ci HEAD)").$(git rev-list HEAD --count).$(git rev-parse --short HEAD)
# Get the git sha
git rev-parse HEAD
wget --quiet https://github.com/google/libnop/archive/$(git rev-parse HEAD).tar.gz
openssl sha256 $(git rev-parse HEAD).tar.gz
{%- endif %}

{% set gitrev = "35e800d81f28c632956c5a592e3cbe8085ecd430" %}
{% set version = "0.0.0.20211102.189.35e800d" %}


package:
  name: libnop
  version: {{ version }}

source:
  url: https://github.com/google/libnop/archive/{{ gitrev }}.tar.gz
  sha256: c377bfc07e0029bcd2da23597b9dc668c2450508f57b612fdae0542e097a4f63

build:
  # You can probably build this for windows
  skip: true  # [win]
  skip: true
  number: 0
  # Header only library, no run-exports

requirements:
  build:
    # Need some kind of dependency otherwise the prefix doesn't get created
    - make  # [unix]

test:
  commands:
    - test -d ${PREFIX}/include/nop
    - test -f ${PREFIX}/include/nop/value.h
    - test -f ${PREFIX}/include/nop/protocol.h
    - test -f ${PREFIX}/include/nop/status.h
    - test -f ${PREFIX}/include/nop/structure.h
    - test -f ${PREFIX}/include/nop/table.h
    - test -d ${PREFIX}/include/nop/base
    - test -d ${PREFIX}/include/nop/rpc
    - test -d ${PREFIX}/include/nop/traits
    - test -d ${PREFIX}/include/nop/types
    - test -d ${PREFIX}/include/nop/utility

about:
  home: https://github.com/google/libnop
  summary: libnop is a header-only library for serializing and deserializing C++ data types without external code generators or runtime support libraries.
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE

extra:
  recipe-maintainers:
    - hmaarrfk
