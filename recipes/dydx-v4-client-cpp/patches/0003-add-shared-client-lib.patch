--- v4-client-cpp/lib/CMakeLists.txt.orig	2021-10-14 15:00:00.000000000 +0000
+++ v4-client-cpp/lib/CMakeLists.txt	2021-10-14 15:00:00.000000000 +0000
@@ -3,3 +3,3 @@
 # Proto files
-add_subdirectory(proto)
+find_package(dydx_v4_proto)

@@ -12,5 +13,9 @@
 file(GLOB_RECURSE SOURCES ${SOURCE_DIR}/*.cpp)
-add_library(dydx_v4_client_lib ${SOURCES})
-target_include_directories(dydx_v4_client_lib PUBLIC ${INCLUDE_DIR})
-target_link_libraries(dydx_v4_client_lib PUBLIC dydx_v4_proto Boost::beast OpenSSL::SSL bip3x fmt nlohmann_json::nlohmann_json)
+
+include(GNUInstallDirs)
+include($ENV{RECIPE_DIR}/cmake/BuildClientLib.txt)
+include($ENV{RECIPE_DIR}/cmake/InstallHeaders.txt)
+include($ENV{RECIPE_DIR}/cmake/InstallLibrary.txt)
+include($ENV{RECIPE_DIR}/cmake/InstallCmakeConfigFiles.txt)
+include($ENV{RECIPE_DIR}/cmake/InstallPkgConfigFiles.txt)

@@ -20,3 +24,7 @@
 add_executable(dydx_v4_client_lib_tests ${TEST_SOURCES})
-target_link_libraries(dydx_v4_client_lib_tests PRIVATE Catch2::Catch2WithMain dydx_v4_client_lib)
+target_link_libraries(dydx_v4_client_lib_tests PRIVATE Catch2::Catch2WithMain dydx_v4_client_lib Boost::boost OpenSSL::SSL bip3x fmt nlohmann_json::nlohmann_json)
+if (APPLE)
+  target_link_libraries(dydx_v4_client_lib_tests PRIVATE Catch2::Catch2WithMain dydx_v4_client_lib crypto)
+endif()
+target_include_directories(dydx_v4_client_lib_tests PUBLIC ${INCLUDE_DIR} ${CMAKE_CURRENT_BINARY_DIR})
 catch_discover_tests(dydx_v4_client_lib_tests)
