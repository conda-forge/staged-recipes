{% set version = "1.0.0" %}

package:
  name: cyanure_gpu
  version: {{ version }}

source:
  url: https://github.com/inria-thoth/cyanure_gpu/releases/download/{{ version }}/cyanure_gpu-{{ version }}.tar.gz
  sha256: d0cf27bfd5b3fe61568d4b615b7af19ee027b95ab3815a46bb6bc4c6c478791f
    
build:
  number: 0
  script:
    - "{{ PYTHON }} -m pip install . -vv"

requirements:
  build:
    - python                                 # [build_platform != target_platform]
    - numpy <=1.23.5  # [py < 3.11]
    - numpy >=1.23.5  # [py > 3.10]
    - setuptools
    - cross-python_{{ target_platform }}     # [build_platform != target_platform]
  host:
    - python
    - setuptools
    - numpy <=1.23.5  # [py < 3.11]
    - numpy >=1.23.5  # [py > 3.10]
    - scikit-learn
    - pip
    - pytorch<2.3.0
  run:
    - python
    - scipy
    - numpy
    - scikit-learn
    - pytorch<2.3.0
    

test:
  imports:
    - cyanure_gpu
  source_files:
    - test/test_logistic_regression.py
  requires:
    - pip
    - pytest
    - pandas
    - libsvmdata
  commands:
  # VM is too small for tests on Windows
    - pip check
    - pytest  # [osx]
    - pytest  # [linux]

about:
  home: https://inria-thoth.github.io/cyanure_gpu/welcome.html
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: 'A Toolbox for Empirical Risk Minimization'
  description: | 
    This project is a partial reimplementation of the Cyanure package. 
    The available solvers are ista and fista which can be used with catalyst or qning acceleration.
    The regularizations available are l1 and l2. The losses are square and logistic for binary and multiclass problem.
    This implementation is able to use the GPU through pytorch if available otherwise it will run on CPU.
  dev_url: https://github.com/inria-thoth/cyanure_gpu
  doc_url: https://inria-thoth.github.io/cyanure_gpu/welcome.html

extra:
  recipe-maintainers:
    - thomasryck
