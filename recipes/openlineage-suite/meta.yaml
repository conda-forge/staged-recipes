{% set name = "openlineage-suite" %}
{% set version = "0.26.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://pypi.io/packages/source/{{ name[0] }}/openlineage_python/openlineage_python-{{ version }}.tar.gz
    sha256: 361a33b35b41f718b11c659a5fdffe64c07abec9f91c56aeec06cefbe538a116
  - url: https://pypi.io/packages/source/{{ name[0] }}/openlineage-integration-common/openlineage-integration-common-{{ version }}.tar.gz
    sha256: ff1dbe75a413979d4c2bdc2f0834ba30783ed0f437a7a19da7289f45eb65a0e1
  - url: https://pypi.io/packages/source/{{ name[0] }}/openlineage_sql/openlineage_sql-{{ version }}.tar.gz
    sha256: 8e78db662edf1efe94da182ecfc98dbdc6ccf93a0489703c5d8a49d551760e67

build:
  number: 0
  noarch: python

outputs:
  - name: openlineage-python
    build:
      noarch: python
      script: python -m pip install . -vv

    requirements:
      host:
        - python >=3.7
        - hatchling >=1.15
        - pip
      run:
        - python >=3.7
        - attrs >=23.1
        - python-dateutil >=2.8.2
        - pyyaml >=6
        - requests >=2.30

    test:
      imports:
        - openlineage.client
      commands:
        - pip check
      requires:
        - pip

  - name: openlineage-integration-common
    build:
      noarch: python
      script: python -m pip install . -vv

    requirements:
      host:
        - python >=3.7
        - pip
      run:
        - python >=3.7
        - attrs >=19.3.0
        - {{ pin_subpackage("openlineage-python", exact=True) }}
        - {{ pin_subpackage("openlineage-sql", exact=True) }}

    test:
      imports:
        - openlineage.common
        - openlineage.common.provider
      commands:
        - pip check
      requires:
        - pip

  - name: openlineage-sql
    build:
      noarch: python
      script: python -m pip install . -vv

    requirements:
      build:
        - {{ compiler('rust') }}
      host:
        - python >=3.7
        - maturin >=0.12,<0.13
        - pip
      run:
        - python >=3.7

    test:
      imports:
        - openlineage_sql
      commands:
        - pip check
      requires:
        - pip

about:
  home: https://github.com/OpenLineage/OpenLineage
  summary: OpenLineage is an Open standard for metadata and lineage collection.
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE

extra:
  recipe-maintainers:
    - rxm7706
