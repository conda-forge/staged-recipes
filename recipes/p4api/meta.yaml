{% set name = "p4api" %}
{% set long_version = "2019.1.1796703" %}
{% set version = "19.1" %}

package:
  name: "{{ name|lower }}"
  version: "{{ long_version }}"

source:
  url: http://ftp.perforce.com/perforce/r{{ version }}/bin.linux26x86_64/p4api.tgz   # [linux]
  sha256: 83a365fe190ddbdb41d40ba230e765bcdd9fb7bf57934812d74a4b4cfbf72349           # [linux]
  url: http://ftp.perforce.com/perforce/r{{ version }}/bin.darwin90x86_64/p4api.tgz  # [osx]
  sha256: 68fb0b57bc7db95ca0c08a5b84e57dc1d82b6dec0b2723fc48a181887f280485           # [osx]
  url: http://ftp.perforce.com/perforce/r{{ version }}/bin.mingw64x86/p4api.zip      # [win]
  sha256: 342bfc820a988db11002ff1804f404796f06b214ba7630d6d8a3593aa564b7bf           # [win]

build:
  number: 0
  script:
    - cp -r include ${PREFIX}    # [unix]
    - cp -r lib ${PREFIX}        # [unix]
    - xcopy /E include %PREFIX%  # [win]
    - xcopy /E lib %PREFIX%      # [win]
  skip: True  # [win]

requirements:
  run:
    - openssl

test:
  commands:
    - test -f ${PREFIX}/lib/libclient.a            # [unix]
    - test -f ${PREFIX}/lib/libp4script.a          # [unix]
    - test -f ${PREFIX}/lib/libp4script_c.a        # [unix]
    - test -f ${PREFIX}/lib/librpc.a               # [unix]
    - if not exist %LIBRARY_LIB%\libclient.a       # [win]
    - if not exist %LIBRARY_LIB%\libp4script.a     # [win]
    - if not exist %LIBRARY_LIB%\libp4script_c.a   # [win]
    - if not exist %LIBRARY_LIB%\librpc.a          # [win]

about:
  home: http://www.perforce.com
  license: Freely Distributable 
  license_family: OTHER
  license_file: LICENSE.txt
  summary: Perforce API
  doc_url: https://www.perforce.com/manuals/p4api/Content/P4API/Home-p4api.html

extra:
  recipe-maintainers:
    - marcelotrevisani
