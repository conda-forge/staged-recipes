schema_version: 1

context:
  version: "0.12.2"

package:
  name: tracy-profiler
  version: ${{ version }}

source:
  url: https://github.com/wolfpld/tracy/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 09617765ba5ff1aa6da128d9ba3c608166c5ef05ac28e2bb77f791269d444952

build:
  number: 0
  script: build.nu

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - cmake >=3.15
    - ninja >=1.10
    - if: unix
      then: pkg-config >=0.29
    - nushell >=0.80
  host:
    - cmake >=3.15
  run:
    - if: osx
      then: ${{ pin_compatible('libcxx', max_pin='x.x') }}

tests:
  - script:
      - if: unix
        then:
          - test -f $PREFIX/include/tracy/tracy/Tracy.hpp
          - test -f $PREFIX/lib/cmake/Tracy/TracyConfig.cmake
      - if: win
        then:
          - if not exist %LIBRARY_INC%\\tracy\\tracy\\Tracy.hpp exit 1
          - if not exist %LIBRARY_LIB%\\cmake\\Tracy\\TracyConfig.cmake exit 1

about:
  homepage: https://github.com/wolfpld/tracy
  summary: A real time, nanosecond resolution, remote telemetry, hybrid frame and sampling profiler
  description: |
    Tracy is a real time, nanosecond resolution, remote telemetry, hybrid frame and sampling
    profiler for games and other applications. It can profile CPU (C, C++, Lua), GPU (OpenGL,
    Vulkan, Direct3D 11/12, OpenCL) and memory. It also can monitor locks held by threads
    and show where contention does happen.

    This package provides the Tracy client library for instrumenting C++ applications.
    The profiler GUI application is available separately.
  license: BSD-3-Clause
  license_file: LICENSE
  documentation: https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf
  repository: https://github.com/wolfpld/tracy

extra:
  recipe-maintainers:
    - phreed
