{% set name = "dgl" %}
{% set version = "0.6.1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/dmlc/{{ name }}/archive/refs/tags/{{ version }}.tar.gz
    sha256: b791bbc7405bcf1787d3586ab0aa7625e36a0f50dfd4cb639877f818e4ef5419
  - url: https://github.com/KarypisLab/METIS/archive/refs/tags/v5.1.1-DistDGL-v0.5.tar.gz
    sha256: cedf0b32d32a8496bac7eb078b2b8260fb00ddb8d50c27e4082968a01bc33331
  - url: https://github.com/KarypisLab/GKlib/archive/refs/tags/METIS-v5.1.1-DistDGL-0.5.tar.gz
    sha256: 52aa0d383d42360f4faa0ae9537ba2ca348eeab4db5f2dfd6343192d0ff4b833
  # - url: https://github.com/NVlabs/cub/archive/refs/tags/1.13.0.tar.gz
  #   sha256: 8c8851bf1a7390cfb07183c3d4b3e55cebe818943b2daed8b338bd65ce70ce01
  # - url: https://github.com/dmlc/dlpack/archive/refs/tags/v0.5.tar.gz
  #   sha256: 9209ac194a175aaab4381313891fba047cb173b2bdd15ac934f83f567f9cd514
  # - url: https://github.com/dmlc/dmlc-core/archive/refs/tags/v0.3.tar.gz
  #   sha256: 29a6bac5b1639d079cb7336b15d0ea99dbd72dda9cac62057b652d871d06753b
  - url: https://github.com/google/googletest/archive/refs/tags/release-1.11.0.tar.gz
    sha256: b4870bf121ff7795ba20d20bcdd8627b8e088f2d1dab299a031c1034eddc93d5
  # - url: https://github.com/jlblancoc/nanoflann/archive/refs/tags/v1.3.2.tar.gz
  #   sha256: e100b5fc8d72e9426a80312d852a62c05ddefd23f17cbb22ccd8b458b11d0bea
  # - url: https://github.com/NVIDIA/nccl/archive/refs/tags/v1.3.4-1.tar.gz
  #   sha256: 11e4eb44555bb28b9cbad973dacb4640b82710c9769e719afc2013b63ffaf884
  # - url: https://github.com/greg7mdp/parallel-hashmap/archive/refs/tags/1.33.tar.gz
  #   sha256: f6e4d0508c4d935fa25dcbaec63fbe0d7503435797e275ec109e8a3f1462a4cd
  - url: https://github.com/NVIDIA/thrust/archive/refs/tags/1.13.0.tar.gz
    sha256: f43306ae4230efdd78a8ce82fb10685676b27ce692777ee5c5a3361ced305d63
  - url: https://github.com/agauniyal/rang/archive/refs/tags/v3.1.0.tar.gz
    sha256: 0eaf6ac687eb359d795bc9fdf0f79887778b7e933a8a3b317db4ba76be0a39d1
  - url: https://dist.apache.org/repos/dist/release/tvm/tvm-v0.7.0/apache-tvm-src-v0.7.0-incubating.tar.gz
    sha256: 3a9906ac76adc9923b02832c53eea62ebafdaed0564ff80febff21c71da5a118
  - url: https://github.com/apache/tvm/archive/refs/tags/v0.7.0.tar.gz
    sha256: 0fba3822a1fef3c1ad9656527ff5bea58c1eed23e1cd262d399d777357a52b7e
  - url: https://github.com/herumi/xbyak/archive/refs/tags/v5.993.tar.gz
    sha256: 97d596e7ca05208a0f64b225bff482ee5bcd44ebae07f1e3a50009d5e54b940b

build:
  noarch: python
  number: 0
  script:
    - mkdir build
    - cd build
    - cmake ..
    - make -j4
    - "{{ PYTHON }} -m pip install ../python/ -vv"

requirements:
  build:
    - {{ compiler('cxx') }}
    - cmake
  host:
    - python >=3.6
    - pip
  run:
    - numpy >=1.14.0
    - scipy >=1.1.0
    - networkx >=2.1
    - python >=3.6
    - requests >=2.19.0

test:
  imports:
    - dgl
  commands:
    - pip check
  requires:
    - pip

about:
  home: https://github.com/dmlc/dgl
  license: Apache-2.0
  license_file: LICENSE
  summary: A deep graph library
  description: |
    DGL is an easy-to-use, high performance and scalable Python package for deep
     learning on graphs. DGL is framework agnostic, meaning if a deep graph
     model is a component of an end-to-end application, the rest of the logics
     can be implemented in any major frameworks, such as PyTorch, Apache MXNet
     or TensorFlow.
  doc_url: https://docs.dgl.ai/en/latest/

extra:
  recipe-maintainers:
    - thewchan
