context:
  name: witr
  version: "0.1.0"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/pranshuparmar/${{ name }}/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 0cc73823129af9b4b183deeec31948df0fc27f231e2f697b678c5f44b575e43c
  target_directory: src

build:
  number: 0
  # https://github.com/pranshuparmar/witr/tree/v0.1.0?tab=readme-ov-file#9-platform-support
  # https://github.com/pranshuparmar/witr/issues/13
  skip: not linux
  script:
    - cd src
    - go-licenses save ./cmd/witr --save_path ../library_licenses
    - go build -v -o $PREFIX/bin/witr -ldflags="-s -w -X main.version=${{ version }}" ./cmd/witr

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script:
      - witr --help
      - witr --version
  - package_contents:
      bin:
        - witr
      strict: true

about:
  homepage: https://github.com/pranshuparmar/witr
  summary: Why is this running?
  license: Apache-2.0
  license_file:
    - src/LICENSE
    - library_licenses/
  documentation: https://pkg.go.dev/github.com/pranshuparmar/witr
  repository: https://github.com/pranshuparmar/witr

extra:
  recipe-maintainers:
    - pavelzw
