From: conda-forge
Subject: [PATCH] linux-user: Define missing RESOLVE_* flags for older kernels

The RESOLVE_* flags for openat2() were added progressively across kernel
versions. Define them if missing to support building with older sysroots.

- RESOLVE_NO_XDEV, RESOLVE_NO_MAGICLINKS, RESOLVE_NO_SYMLINKS,
  RESOLVE_BENEATH, RESOLVE_IN_ROOT: Linux 5.6
- RESOLVE_CACHED: Linux 5.12

diff --git a/linux-user/strace.c b/linux-user/strace.c
index 1234567..abcdefg 100644
--- a/linux-user/strace.c
+++ b/linux-user/strace.c
@@ -1116,2 +1116,23 @@
 #ifdef HAVE_OPENAT2_H
+/* RESOLVE_* flags for openat2(), added in various kernel versions */
+#ifndef RESOLVE_NO_XDEV
+#define RESOLVE_NO_XDEV         0x01
+#endif
+#ifndef RESOLVE_NO_MAGICLINKS
+#define RESOLVE_NO_MAGICLINKS   0x02
+#endif
+#ifndef RESOLVE_NO_SYMLINKS
+#define RESOLVE_NO_SYMLINKS     0x04
+#endif
+#ifndef RESOLVE_BENEATH
+#define RESOLVE_BENEATH         0x08
+#endif
+#ifndef RESOLVE_IN_ROOT
+#define RESOLVE_IN_ROOT         0x10
+#endif
+/* RESOLVE_CACHED added in Linux 5.12 */
+#ifndef RESOLVE_CACHED
+#define RESOLVE_CACHED          0x20
+#endif
+
     FLAG_GENERIC(RESOLVE_NO_XDEV),
