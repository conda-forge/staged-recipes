{% set name = "gfortran_build" %}
{% set version = "8.2.0" %}

package:
  name: {{ name|lower }}_{{ target_platform }}
  version: {{ version }}

source:
  url: https://ftp.gnu.org/gnu/gcc/gcc-{{ version }}/gcc-{{ version }}.tar.gz
  sha256: 1b0f36be1045ff58cbb9c83743835367b860810f17f0195a4e093458b372020f
  patches:
    - 00000-configure.patch
    - 00001-configure.ac.patch
    - 00002-gcc.c.patch
    - 00003-darwin.h.patch
    - 00004-darwin9.h.patch
    - 00005-graphite.h.patch

build:
  number: 0
  skip: true  # [not osx]
  binary_has_prefix_files:
    - lib/libgcc_ext.10.*.dylib  

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - make
  host:
    - gmp =6
    - mpfr =4
    - mpc =1.1
    # isl >=0.19 breaks the build since lib name changes from libisl.15.dylib
    - isl =0.18
    - cloog =0.18
    - libiconv =1.15
  run:
    - isl =0.18  # seems to not get added by default w/ a run export

test:
  files:
    - hello.f90
    - maths.f90
  commands:
    - gfortran --help

about:
  home:
  license: GPL
  summary: fortran
  description: fortran
  doc_url:
  dev_url:

extra:
  recipe-maintainers:
    - beckermr
