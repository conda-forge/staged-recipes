{% set name = "pose2sim" %}
{% set version = "0.10.39" %}
{% set python_min = "3.10" %}


package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/perfanalytics/pose2sim/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 081d8ea353d74cf64a801ce9401cbf6abf022b05f3d9e69740f1f3566badf30f

build:
  skip: true  # [py<310]
  entry_points:
    - AlphaPose_to_OpenPose = Pose2Sim.Utilities.AlphaPose_to_OpenPose:main
    - Blazepose_runsave = Pose2Sim.Utilities.Blazepose_runsave:main
    - bodykin_from_mot_osim = Pose2Sim.Utilities.bodykin_from_mot_osim:main
    - c3d_to_trc = Pose2Sim.Utilities.c3d_to_trc:main
    - calib_easymocap_to_toml = Pose2Sim.Utilities.calib_easymocap_to_toml:main
    - calib_from_checkerboard = Pose2Sim.Utilities.calib_from_checkerboard:main
    - calib_qca_to_toml = Pose2Sim.Utilities.calib_qca_to_toml:main
    - calib_toml_to_easymocap = Pose2Sim.Utilities.calib_toml_to_easymocap:main
    - calib_toml_to_opencap = Pose2Sim.Utilities.calib_toml_to_opencap:main
    - calib_toml_to_qca = Pose2Sim.Utilities.calib_toml_to_qca:main
    - DLC_to_OpenPose = Pose2Sim.Utilities.DLC_to_OpenPose:main
    - face_blurring = Pose2Sim.Utilities.face_blurring:main
    - json_display_with_img = Pose2Sim.Utilities.json_display_with_img:main
    - json_display_without_img = Pose2Sim.Utilities.json_display_without_img:main
    - MMPose_to_OpenPose = Pose2Sim.Utilities.MMPose_to_OpenPose:main
    - reproj_from_trc_calib = Pose2Sim.Utilities.reproj_from_trc_calib:main
    - trc_combine = Pose2Sim.Utilities.trc_combine:main
    - trc_desample = Pose2Sim.Utilities.trc_desample:main
    - trc_filter = Pose2Sim.Utilities.trc_filter:main
    - trc_from_easymocap = Pose2Sim.Utilities.trc_from_easymocap:main
    - trc_from_mot_osim = Pose2Sim.Utilities.trc_from_mot_osim:main
    - trc_gaitevents = Pose2Sim.Utilities.trc_gaitevents:main
    - trc_plot = Pose2Sim.Utilities.trc_plot:main
    - trc_to_c3d = Pose2Sim.Utilities.trc_to_c3d:main
    - trc_Zup_to_Yup = Pose2Sim.Utilities.trc_Zup_to_Yup:main
  script: |
    SETUPTOOLS_SCM_PRETEND_VERSION={{ version }} \
    {{ PYTHON }} -m pip install . --no-deps -vv
  number: 0

requirements:
  host:
    - python {{ python_min }}
    - setuptools >=42
    - wheel
    - pip
    - numpy
  run:
    - python
    # - opensim-org::opensim    # WILL ADD IT ONCE ON CONDA-FORGE
    - numpy <2.0        # [py<312]
    - numpy >=2.0,<2.3  # [py>=312]
    - toml
    - lxml
    - matplotlib-base        # instead of matplotlib
    - mpl-interactions
    - pyqt                   # instead of PyQt5
    - tqdm
    - anytree
    - pandas >=1.5
    - scipy
    - statsmodels
    - filterpy
    - ipython
    - c3d
    - rtmlib
    - openvino
    - onnxruntime
    # - deep-sort-realtime   # likely not needed, and not on conda-forge

test:
  imports:
    - Pose2Sim
  commands:
    - pip check
    - AlphaPose_to_OpenPose --help
    # - Blazepose_runsave --help        # do not test as it requires mediapipe, not installed by default
    # - bodykin_from_mot_osim --help    # REQUIRES OPENSIM
    - c3d_to_trc --help
    - calib_easymocap_to_toml --help
    - calib_from_checkerboard --help
    - calib_qca_to_toml --help
    - calib_toml_to_easymocap --help
    - calib_toml_to_opencap --help
    - calib_toml_to_qca --help
    - DLC_to_OpenPose --help
    - face_blurring --help
    # - json_display_with_img --help # requires cmapy
    - json_display_without_img --help
    - MMPose_to_OpenPose --help
    - reproj_from_trc_calib --help
    - trc_combine --help
    - trc_desample --help
    - trc_filter --help
    - trc_from_easymocap --help
    # - trc_from_mot_osim --help          # REQUIRES OPENSIM
    - trc_gaitevents --help
    - trc_plot --help
    - trc_to_c3d --help
    - trc_Zup_to_Yup --help
  requires:
    - python
    - pip

about:
  home: https://github.com/perfanalytics/pose2sim
  summary: Markerless kinematics with any cameras â€” From 2D Pose estimation to 3D OpenSim motion
  license: BSD-3-Clause
  license_file: LICENSE

extra:
  recipe-maintainers:
    - davidpagnon
