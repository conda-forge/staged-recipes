{% set version = "1.3.0" %}
{% set sha256 = "1942afa04f004bec01e51a5177443888c6fdfb54b46589b26e82f1f60e4c5060" %}

package:
  name: csv-validator
  version: {{ version }}

source:
  url: https://github.com/digital-preservation/csv-validator/releases/download/{{ version }}/csv-validator-distribution-{{ version }}-bin.zip
  sha256: {{ sha256 }}

build:
  number: 0

requirements:
  run:
    - openjdk >=11

# TODO: Test for Windows compatibility (requires a separate bld.bat script for Windows)
test:
  requires:
    - openjdk >=11
  commands:
    # Testing if directory exists for package and ensuring version matches what's defined in recipe
    - test -f $PREFIX/bin/csv-validator-cmd # [linux]
    - csv-validator-cmd --help | grep {{ version }} # [linux]
    - IF EXIST "%PREFIX%/bin/csv-validator-cmd (EXIT /B 0) ELSE (EXIT /B 1)" # [win]
    - csv-validator-cmd --help | FINDSTR "{{ version }}" # [win]
    - csv-validator-cmd --help

about:
  home: https://github.com/digital-preservation/csv-validator
  summary: 'A Validation Tool and APIs for validating CSV (Comma Separated Value) files by using CSV Schema <https://github.com/digital-preservation/csv-schema>.'
  description: |
    The CSV Validator will take a CSV Schema file and a CSV file, 
    verify that the CSV Schema itself is syntactically correct 
    and then assert that each rule in the CSV Schema holds true for the CSV file. 
    The Validator is predominantly written in Scala 2.13 
    and runs on any platform with a Java Virtual Machine (JVM).
  license: MPL-2.0
  license_family: MOZILLA
  license_file: LICENSE
  doc_url: http://digital-preservation.github.io/csv-validator

extra:
  recipe-maintainers:
    - thomasphung
