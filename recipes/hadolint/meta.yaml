{% set name = "hadolint" %}
{% set version = "2.1.0" %}
{% set native = 'm2w64-' if win else '' %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/hadolint/hadolint/archive/refs/tags/v{{ version }}.tar.gz  # [not linux]
    sha256: e631a86392bdf6ebfed737f99f05558b7f06b063215180b41d6e9d7fb8fe6ce4  # [not linux]
  - url: https://github.com/hadolint/hadolint/releases/download/v{{ version }}/hadolint-Linux-x86_64  # [linux]
    sha256: ecaf24a8d9dec2f5e16a8f951a6de51bfa9e43f285f4c751b208a9d90c66a0ce  # [linux]

build:
  number: 0

  missing_dso_whitelist:
    - /usr/lib/libiconv.2.dylib  # [osx]

requirements:
  build:
    - stack                     # [not linux]
    - {{native}}binutils

  host:
    - gmp  # [osx]

  run:
    - gmp  # [osx]

test:
  commands:
   - hadolint --version | grep "Haskell Dockerfile Linter {{ version }}-no-git"

about:
  home: https://github.com/hadolint/hadolint
  license: GPL-3.0-only
  license_family: GPL
  license_file: LICENSE.txt
  summary: Dockerfile linter, validate inline bash, written in Haskell

extra:
  recipe-maintainers:
    - janjagusch
