context:
  osm2pgsql_version: "2.2.0"
  libosmium_version: "2.22.0"
  protozero_version: "1.8.1"

package:
  name: osm2pgsql
  version: ${{ osm2pgsql_version }}

source:
  - url: https://github.com/osm2pgsql-dev/osm2pgsql/archive/refs/tags/${{ osm2pgsql_version }}.tar.gz
    sha256: 567dad078f8a66d6d706ac1876b5251b688109d16974909d89ce2056d6e9f258
    target_directory: osm2pgsql

  - url: https://github.com/osmcode/libosmium/archive/refs/tags/v${{ libosmium_version }}.tar.gz
    sha256: 8f74e3f6ba295baa7325ae5606e8f74ad9056f1d6ab4555c50bff6aa8246f366
    target_directory: libosmium

  - url: https://github.com/mapbox/protozero/archive/refs/tags/v${{ protozero_version }}.tar.gz
    sha256: 6c7a896f1dc08435e8cd4f3780ff688cd0bfce6890599b755f6f3cb36398dc25
    target_directory: protozero

build:
  number: 0

requirements:
  build:
    - ${{ compiler('cxx') }}
    - cmake
    - ninja
    - pkg-config
    - catch2
    - cli11
    - fmt <12
    - nlohmann_json
    - libboost-devel

  host:
    - expat
    - proj
    - bzip2
    - zlib
    - postgresql
    - lua

  run:
    - expat
    - proj
    - bzip2
    - zlib
    - postgresql
    - lua

tests:
  - script:
    - osm2pgsql --version
    - osm2pgsql --help

about:
  homepage: https://osm2pgsql.org
  license: GPL-2.0-only
  license_file:
    - osm2pgsql/COPYING
    - libosmium/LICENSE
    - protozero/LICENSE.md
  summary:  Import OpenStreetMap data into a PostgreSQL/PostGIS database
  description: osm2pgsql is a tool for loading OpenStreetMap data into a PostgreSQL / PostGIS database suitable for applications like rendering into a map, geocoding with Nominatim, or general analysis.
  documentation: https://osm2pgsql.org
  repository: https://github.com/osm2pgsql-dev/osm2pgsql

extra:
  recipe-maintainers:
    - travishathaway
