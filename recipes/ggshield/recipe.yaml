schema_version: 1

context:
  name: ggshield
  version: 1.38.1

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/${{ name[0] }}/${{ name }}/ggshield-${{ version }}.tar.gz
  sha256: 7cc1b268555005f487156f4cd6b3f68e6ca54a86061aedf59d8952a00021830e

build:
  number: 0
  skip: match(python, "<3.9")
  script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  python:
    entry_points:
      - ggshield = ggshield.__main__:main

requirements:
  host:
    - python ${{ python_min }}.*
    - pdm-backend
    - pip
  run:
    - python >=${{ python_min }}
    - platformdirs >=3.0.0,<3.1.dev0
    - charset-normalizer >=3.1.0,<3.2.dev0
    - click >=8.1.0,<8.2.dev0
    - cryptography >=43.0.1,<43.1.dev0
    - marshmallow >=3.18.0,<3.19.dev0
    - marshmallow-dataclass >=8.5.8,<8.6.dev0
    - oauthlib >=3.2.1,<3.3.dev0
    - pygitguardian >=1.20.0,<1.21.dev0
    - pyjwt >=2.6.0,<2.7.dev0
    - python-dotenv >=0.21.0,<0.22.dev0
    - pyyaml >=6.0.1,<6.1.dev0
    - requests >=2.32.0,<2.33.dev0
    - rich >=12.5.1,<12.6.dev0
    - typing_extensions >=4.12.2,<4.13.dev0
    - urllib3 >=2.2.2,<2.3.dev0
    - if: match(python, ">=3.10")
      then: truststore >=0.10.1

tests:
  - python:
      imports:
        - ggshield
      pip_check: true
  - requirements:
      run:
        - pip
    script:
      - ggshield --help

about:
  summary: "Detect secrets from all sources using GitGuardian's brains"
  license: MIT
  license_file: LICENSE
  homepage: https://www.gitguardian.com

extra:
  recipe-maintainers:
    - janjagusch
