From f3fe57eea6672133156d228bf30e4cd1933f9a5e Mon Sep 17 00:00:00 2001
From: rd235 <rd235@users.noreply.github.com>
Date: Sun, 26 May 2013 19:12:24 +0000
Subject: [PATCH 15/62] Bugfix: sigsegv when a new client got plugged in on a
 preset port on VLAN 4095 (no VLAN) FIXED

---
 src/vde_switch/port.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/vde_switch/port.c b/src/vde_switch/port.c
index f86897c3e..b976ca3b3 100644
--- a/src/vde_switch/port.c
+++ b/src/vde_switch/port.c
@@ -283,8 +283,8 @@ struct endpoint *setup_ep(int portno, int fd_ctl, int fd_data, uid_t user,
 				if (port->vlanuntag != NOVLAN) {
 					ba_set(vlant[port->vlanuntag].bcuntag,portno);
 					ba_clr(vlant[port->vlanuntag].bctag,portno);
+					ba_clr(vlant[port->vlanuntag].notlearning,portno);
 				}
-				ba_clr(vlant[port->vlanuntag].notlearning,portno);
 			} else {
 				ep->next=port->ep;
 				port->ep=ep;
-- 
2.35.0

