From ba453253efb6035a294414fa88f522a4c1b6b25d Mon Sep 17 00:00:00 2001
From: Daniele Lacamera <dan@danielinux.net>
Date: Sun, 6 Oct 2019 12:02:27 +0200
Subject: [PATCH 42/62] Fixed memcpy destination pointer overflow in vde_router
 (partially solves github issue #13

---
 src/vde_router/vder_packet.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/vde_router/vder_packet.c b/src/vde_router/vder_packet.c
index e654fdcbd..b2f42336e 100644
--- a/src/vde_router/vder_packet.c
+++ b/src/vde_router/vder_packet.c
@@ -202,7 +202,7 @@ void vder_packet_recv(struct vder_iface *vif, int timeout)
 			} else {
 				struct iphdr *hdr = iphead(packet);
 				uint32_t sender = hdr->saddr;
-				uint8_t foot[sizeof(hdr) + 8];
+				uint8_t foot[sizeof(struct iphdr) + 8];
 
 				memcpy(foot, footprint(packet), sizeof(struct iphdr) + 8);
 				if (vder_ip_decrease_ttl(packet)) {
-- 
2.35.0

