From ae22e0e5e5f655cd3c5bb1c103b670a5be474297 Mon Sep 17 00:00:00 2001
From: Daniele Lacamera <danielinux@users.noreply.github.com>
Date: Thu, 15 Dec 2011 17:48:17 +0000
Subject: [PATCH 04/62] Reverted makefile changes due to wrong path commit

---
 configure.ac    | 27 +--------------------------
 src/Makefile.am |  4 ----
 2 files changed, 1 insertion(+), 30 deletions(-)

diff --git a/configure.ac b/configure.ac
index 56f3dd16d..ced1fc3eb 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1,4 +1,4 @@
-#                                               -*- Autoconf -*-/
+#                                               -*- Autoconf -*-
 # Process this file with autoconf to produce a configure script.
 
 AC_PREREQ(2.59)
@@ -25,9 +25,6 @@ AC_CHECK_LIB([dl], [dlopen])
 AC_CHECK_LIB([crypto], [EVP_EncryptInit],
   [add_cryptcab_support=yes],
   [add_cryptcab_support=no ; warn_cryptcab=yes])
-AC_CHECK_LIB([pthread], [pthread_create],
-  [enable_router=yes],
-  [enable_router=no ; warn_router=yes])
 AC_CHECK_LIB([pcap], [pcap_open_dead],
   [add_pcap=yes],
   [add_pcap=no ; warn_pcap=yes])
@@ -127,12 +124,6 @@ AC_ARG_ENABLE([cryptcab],
     [Disable libcrypto-dependend vde_cryptcab compilation]),
   [if test $enableval = "no" ; then add_cryptcab_support=no ; warn_cryptcab=no ; fi])
 
-# Disable vde_router? (depends on lpthread, maybe unwanted)
-AC_ARG_ENABLE([router],
-  AS_HELP_STRING([--disable-router],
-    [Disable libpthread-dependent vde_router compilation]),
-  [if test $enableval = "no" ; then enable_router=no ; warn_router=no ; fi])
-
 # Check of tuntap device
 AC_ARG_ENABLE([tuntap],
   AS_HELP_STRING([--disable-tuntap], [Disable tuntap compilation]), [:],
@@ -221,7 +212,6 @@ fi
 
 
 AM_CONDITIONAL(ENABLE_CRYPTCAB, test "$add_cryptcab_support" = yes)
-AM_CONDITIONAL(ENABLE_ROUTER, test "$enable_router" = yes)
 AM_CONDITIONAL(ENABLE_PYTHON, test "$enable_python" = yes)
 AM_CONDITIONAL(ENABLE_PCAP, test "$add_pcap" = yes)
 AM_CONDITIONAL(CAN_MAKE_LIBVDETAP, test "$can_make_libvdetap" = yes)
@@ -254,7 +244,6 @@ AC_CONFIG_FILES(
   [src/vdetaplib/Makefile]
   [src/vde_l3/Makefile]
   [src/vde_cryptcab/Makefile]
-  [src/vde_router/Makefile]
   [src/slirpvde/Makefile]
   [src/vde_switch/plugins/Makefile]
 )
@@ -271,12 +260,6 @@ else
   AS_ECHO " - VDE CryptCab............ disabled"
 fi
 
-if test x$enable_router = "xyes" ; then
-  AS_ECHO " + VDE Router.............. enabled"
-else
-  AS_ECHO " - VDE Router.............. disabled"
-fi
-
 if test x$enable_python = "xyes" ; then
   AS_ECHO " + Python Libraries........ enabled"
 else
@@ -324,14 +307,6 @@ Please install them if you want CryptCab to be compiled and installed.])
   fi
 fi
 
-if ! test x$enable_router = "xyes" ; then
-  if test x$warn_router = "xyes" ; then
-    AC_MSG_WARN([VDE Router support has been disabled because libpthread is
-not installed on your system.])
-    AS_ECHO
-  fi
-fi
-
 if ! test x$enable_python = "xyes" ; then
     AC_MSG_WARN([Python libraries support has been disabled because python is
 not installed on your system, or because it could not be found. Please install
diff --git a/src/Makefile.am b/src/Makefile.am
index 49f8b7879..0c02021aa 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -31,10 +31,6 @@ if ENABLE_CRYPTCAB
   SUBDIRS += vde_cryptcab
 endif
 
-if ENABLE_ROUTER
-  SUBDIRS += vde_router
-endif
-
 if ENABLE_KERNEL_SWITCH
   SUBDIRS += kvde_switch
 endif
-- 
2.35.0

