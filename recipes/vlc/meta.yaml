# Their website is wrong and points to 3.0.20 which is too old
{% set version = "3.0.21" %}

package:
  name: vlc
  version: {{ version }}

source:
  # For version 3.0.21, there seems to be a fixup release
  # -1 is for a fixing build issues on windows
  # see release notes
  url: https://download.videolan.org/pub/videolan/vlc/{{ version }}/vlc-{{ version }}.tar.xz
  sha256: 24dbbe1d7dfaeea0994d5def0bbde200177347136dbfe573f5b6a4cee25afbb0
  patches:
  {% if version.startswith("4") %}
    - 7114-fix_undefined_variable.patch
  {% endif %}

build:
  number: 0
  skip: true  # [not linux]

requirements:
  build:
    - {{ compiler('cxx') }}
    - {{ compiler('c') }}
    - {{ stdlib('c') }}
    - pkg-config
    - automake
    - make
    - lua
    - libtool
    - gnuconfig
    - autoconf
    - scdoc
    - bison
    - flex
  host:
    - lua
    - xorg-xorgproto
    - libgl-devel
    - ffmpeg
    # Specify LGPL so as not get the whole thing to be GPL'ed
    - ffmpeg  *=lgpl*
{% if version.startswith("3") %}
    - qt-main
{% else %}
    - qt6-main
{% endif %}

test:
  commands:
    - cvlc --version

about:
  home: https://videolan.org/
  summary: VLC is a free and open source cross-platform multimedia player and framework that plays most multimedia files as well as DVDs, Audio CDs, VCDs, and various streaming protocols.
  description: |
    VLC is a libre and open source media player and multimedia engine,
    focused on playing everything, and running everywhere.

    VLC can play most multimedia files, discs, streams, devices and is also able to
    convert, encode, stream and manipulate streams into numerous formats.

    VLC is used by many over the world, on numerous platforms, for very different use cases.
    The engine of VLC can be embedded into 3rd party applications, and is called libVLC.

    VLC is part of the VideoLAN project and
    is developed and supported by a community of volunteers.

    The VideoLAN project was started at the university Ã‰cole Centrale Paris who
    relicensed VLC under the GPLv2 license in February 2001. Since then, VLC has
    been downloaded billions of times.

  license: GPL-2.0-or-later AND LGPL-2.1-only
  license_file:
    - COPYING
    - COPYING.lib
  dev_url: https://code.videolan.org/videolan/vlc

extra:
  recipe-maintainers:
    - hmaarrfk
