# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
schema_version: 1

context:
  name: itstool
  version: "2.0.7"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: http://files.itstool.org/${{ name }}/${{ name }}-${{ version }}.tar.bz2
  sha256: 6b9a7cd29a12bb95598f5750e8763cee78836a1a207f85b74d8b3275b27e87ca
  patches:
    - 0001-Fix-the-crash-from-912099.patch
    - 0002-Fix-insufficiently-quoted-regular-expressions.patch
    - 0003-Fix-handling-of-untranslated-nodes.patch
    - 0004-Replace-python-libxml2-with-lxml.patch

build:
  number: 0
  skip:
    - win
  script: |
    autoreconf --force --install
    ./configure --prefix=$PREFIX
    make -j${CPU_COUNT}
    make install

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ stdlib('c') }}
    - autoconf
    - automake
    - make
  host:
    - python
    - gettext
    - lxml
  run:
    - python
    - lxml

tests:
  - script: |
      itstool --version
      test -f $PREFIX/bin/itstool

about:
  homepage: https://itstool.org
  summary: 'Translate XML with PO files using W3C Internationalization Tag Set rules'
  description: |
    ITS Tool allows you to translate your XML documents with PO files,
    using rules from the W3C Internationalization Tag Set (ITS) to
    determine what to translate and how to separate it into PO file
    messages.
  license: GPL-3.0-or-later
  license_file:
    - COPYING
    - COPYING.GPL3
  documentation: https://itstool.org/documentation/
  repository: https://github.com/itstool/itstool

extra:
  recipe-maintainers:
    - danyeaw
