From ab639d908d345dae164227d9aa82f47de8bae179 Mon Sep 17 00:00:00 2001
From: BastianZim <10774221+BastianZim@users.noreply.github.com>
Date: Mon, 8 Nov 2021 20:16:19 +0100
Subject: [PATCH] Use custom build path

---
 setup.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/setup.py b/setup.py
index b7350705f..326176fec 100755
--- a/setup.py
+++ b/setup.py
@@ -83,8 +83,8 @@ class CMakeBuildExt(build_ext):
 
     def build_cmake(self, extension):
         self.announce('Configuring extensions', level=3)
-        src_dir = os.path.abspath(os.path.join(__file__, '..', 'pyscf', 'lib'))
-        cmd = ['cmake', f'-S{src_dir}', f'-B{self.build_temp}']
+        src_dir = os.path.join('pyscf', 'lib')
+        cmd = ['cmake', f'-S{src_dir}', '-Bbuild']
         configure_args = os.getenv('CMAKE_CONFIGURE_ARGS')
         if configure_args:
             cmd.extend(configure_args.split(' '))
@@ -93,7 +93,7 @@ class CMakeBuildExt(build_ext):
         self.announce('Building binaries', level=3)
         # Do not use high level parallel compilation. OOM may be triggered
         # when compiling certain functionals in libxc.
-        cmd = ['cmake', '--build', self.build_temp, '-j2']
+        cmd = ['cmake', '--build', 'build']
         build_args = os.getenv('CMAKE_BUILD_ARGS')
         if build_args:
             cmd.extend(build_args.split(' '))
-- 
2.33.1

