context:
  name: shs-libfabric
  version: 2.4.0

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  url: https://github.com/HewlettPackard/shs-libfabric/archive/refs/tags/v${{ version }}.tar.gz
# sha256: 734aa46fc1a5c69c59514aade3e8f17037506fbb08013f4be63d669e546570b0  # 2.2.0
  sha256: fd052fc7ab87a07f29696071c01243a04b66a7469ace3ff127bd2edabeb257f3  # 2.4.0

build:
  number: 0
  script: build.sh
  skip:
    - win
    - osx

requirements:
  build:
    - ${{ compiler('c') }}
#   - ${{ stdlib('c') }}
    - autoconf
    - automake
    - libtool
    - make
    - pkg-config
  host:
    - json-c
    - libnl
    - libcurl
    - shs-libcxi
    - shs-cassini-headers
    - shs-cxi-drivers
  run:
    - json-c
    - libcurl
    - shs-libcxi

tests:
  - script:
     - test -f $PREFIX/lib/libfabric.so 
     - fi_info -p cxi || echo "CXI provider not available (expected on unsupported platforms)"

about:
  homepage: https://github.com/HewlettPackard/shs-libfabric
  license: BSD-2-Clause OR GPL-2.0-only OR Linux-OpenIB OR MIT
  license_file: COPYING
  summary: 'CXI-enabled libfabric library'
  description: |
    Provides a CXI-enabled version of the libfabric library for high-performance networking.

    Dual-licensed under BSD-2-Clause or GPL-2.0-only (see COPYING file).
    Individual source files contain SPDX license identifiers.

extra:
  recipe-maintainers:
    - j34ni
