{% set name = "solweig-gpu" %}
{% set version = "1.2.15" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://files.pythonhosted.org/packages/source/{{ name[0] }}/{{ name }}/{{ name.replace('-', '_') }}-{{ version }}.tar.gz
  sha256: 8b1b2efb14ebad7700136b69ae13356b082f1b69a9153e03f1aae6f78ca7b15d

build:
  script: {{ PYTHON }} -m pip install . --no-deps -vv
  number: 0
  skip: true 
  entry_points:
    - thermal_comfort = solweig_gpu:thermal_comfort
  ignore_run_exports:
    - _openmp_mutex

requirements:
  host:
    - python
    - pip
    - setuptools
    - gdal

  run:
    - python
    - pip
    - numpy
    - numba
    - pytorch
    - scipy
    - pandas
    - netcdf4
    - pytz
    - shapely
    - timezonefinder
    - gdal
    - xarray
    - tqdm
    - pyqt
    - matplotlib-base

test:
  imports:
    - solweig_gpu
  commands:
    - pip check
    - python -m solweig_gpu.cli --help
  requires:
    - python
    - pip

about:
  home: https://github.com/nvnsudharsan/SOLWEIG-GPU
  license: GPL-2.0-or-later
  license_file: LICENSE
  summary: GPU-accelerated SOLWEIG model for urban microclimate simulation
  description: |
    SOLWEIG-GPU is a Python package and command-line interface for running the standalone SOLWEIG (Solar and LongWave Environmental Irradiance Geometry) model on CPU or GPU (if available). It enables high-resolution urban microclimate modeling by computing key variables such as Sky View Factor (SVF), Mean Radiant Temperature (Tmrt), and the Universal Thermal Climate Index (UTCI). SOLWEIG was originally developed by Dr. Fredrik Lindberg's group. Journal reference: Lindberg, F., Holmer, B. & Thorsson, S. SOLWEIG 1.0 – Modelling spatial variations of 3D radiant fluxes and mean radiant temperature in complex urban settings. Int J Biometeorol 52, 697–713 (2008). https://doi.org/10.1007/s00484-008-0162-7. SOLWEIG GPU code is an extension of the original SOLWEIG Python model that is part of the Urban Multi-scale Environmental Predictor (UMEP) (GitHub code reference: https://github.com/UMEP-dev/UMEP). UMEP journal reference: Lindberg, F., Grimmond, C.S.B., Gabey, A., Huang, B., Kent, C.W., Sun, T., Theeuwes, N.E., Järvi, L., Ward, H.C., Capel-Timms, I. and Chang, Y., 2018. Urban Multi-scale Environmental Predictor (UMEP): An integrated tool for city-based climate services. Environmental modelling & software, 99, pp.70-87. https://doi.org/10.1016/j.envsoft.2017.09.020. SOLWEIG-GPU is a Python package that provides fast, GPU-enabled simulation of urban microclimate conditions using the SOLWEIG model framework. The model is built on PyTorch tensors, leveraging GPU acceleration for efficient large-scale urban heat and thermal comfort simulations. This package is tested with Python 3.10 and PyTorch. It is recommended to install GDAL from conda-forge before installing the package due to binary compatibility issues.

extra:
  recipe-maintainers:
    - nvnsudharsan
