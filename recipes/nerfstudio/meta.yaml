{% set name = "nerfstudio" %}
{% set version = "1.1.5" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/{{ name[0] }}/{{ name }}/nerfstudio-{{ version }}.tar.gz
  sha256: c3d8fd27208565e2031e4b0c89f82eb78199207d5194755f5b6c8f41e02f4cf9
  patches:
    - patches/0001-Adjust-dependencies.patch

build:
  entry_points:
    - ns-install-cli = nerfstudio.scripts.completions.install:entrypoint
    - ns-process-data = nerfstudio.scripts.process_data:entrypoint
    - ns-download-data = nerfstudio.scripts.downloads.download_data:entrypoint
    - ns-train = nerfstudio.scripts.train:entrypoint
    - ns-viewer = nerfstudio.scripts.viewer.run_viewer:entrypoint
    - ns-eval = nerfstudio.scripts.eval:entrypoint
    - ns-render = nerfstudio.scripts.render:entrypoint
    - ns-export = nerfstudio.scripts.exporter:entrypoint
    - ns-dev-test = nerfstudio.scripts.github.run_actions:entrypoint
    - ns-dev-sync-viser-message-defs = nerfstudio.scripts.viewer.sync_viser_message_defs:entrypoint
  noarch: python
  number: 0
  script: {{ PYTHON }} -m pip install . -vv

requirements:
  host:
    - pip
    - python {{ python_min }}
    - setuptools
  run:
    - python >={{ python_min }}
    - appdirs >=1.4
    - av >=9.2.0
    - comet-ml >=3.33.8
    - configargparse
    - cryptography >=38
    - fpsample
    - gdown >=4.6.0
    - gsplat 1.4.0
    - ninja >=1.10
    - h5py >=2.9.0
    - imageio >=2.21.1
    - importlib-metadata >=6.0.0
    - ipywidgets >=7.6
    - jaxtyping >=0.2.15
    - jupyterlab >=3.3.4
    - matplotlib >=3.6.0
    - mediapy >=1.1.0
    - msgpack-python >=1.0.4
    - msgpack-numpy >=0.4.8
    - nerfacc 0.5.2
    # - newrawpy >=1.0.0b0  # Not available
    - nuscenes-devkit >=1.1.1
    - open3d >=0.16.0
    - packaging
    - pathos
    - py-opencv 4.10 headless*
    - Pillow >=10.3.0
    - plotly >=5.7.0
    - protobuf <=5,!=3.20.0
    # - pymeshlab >=2022.2.post2,<2023.12.post2  # Pending https://github.com/conda-forge/staged-recipes/pull/28509
    - pyngrok >=5.1.0
    - python-socketio >=5.7.1
    - pytorch >=1.13.1
    - pytorch-msssim
    - pyquaternion >=0.9.9
    - rawpy >=0.18.1
    - requests
    - rich >=12.5.1
    - scikit-image >=0.19.3
    - splines 0.3.0
    - tensorboard >=2.13.0
    - tensorly
    - timm 0.6.7
    - torchvision >=0.14.1
    - torchmetrics >=1.0.1
    - trimesh >=3.20.2
    - typing_extensions >=4.4.0
    - tyro >=0.9.8
    - viser 0.2.7
    - wandb >=0.13.3
    - xatlas-python

test:
  imports:
    - nerfstudio
  commands:
    - pip check
  requires:
    - pip
    - python {{ python_min }}

about:
  home: https://github.com/nerfstudio-project/nerfstudio
  summary: A collaboration friendly studio for NeRFs
  license: Apache-2.0
  license_file: LICENSE

extra:
  recipe-maintainers:
    - jeongseok-meta
