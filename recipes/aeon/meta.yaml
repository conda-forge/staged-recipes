{% set name = "aeon" %}
{% set version = "0.4.0" %}

package:
  name: {{ name|lower }}-suite
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 1cb174cf09b802ad9a1db91129b3337136e3da0b3e7a71160c3ba0a58119cb5c

build:
  number: 0
  skip: true  # [py<38 or py>311]

# This section is required to correctly rerender skip statement
requirements:
  build:
    - python                                 # [build_platform != target_platform]
    - cross-python_{{ target_platform }}     # [build_platform != target_platform]
  host:
    - python
  run:
    - python

outputs:
  - name: {{ name|lower }}
    script: build_script.sh  # [unix]
    script: build_script.bat  # [win]
    requirements:
      build:
        - python                                 # [build_platform != target_platform]
        - cross-python_{{ target_platform }}     # [build_platform != target_platform]
      host:
        - python
        - setuptools
        - wheel
        - toml
        - python-build
        - numpy
        - pip
      run:
        - python >=3.8,<3.12
        - attrs >=19.2.0
        - deprecated >=1.2.13
        - numba >=0.55
        - numpy >=1.21.0,<1.25.0
        - packaging >=20.0
        - pandas >=1.5.3,<2.1.0
        - scikit-learn >=1.0.0,<1.3.0
        - scipy >=1.2.0,<2.0.0
      run_constrained:
        - esig >=0.9.7,<0.9.8.3
        - filterpy >=1.4.5
        - hmmlearn >=0.2.7
        - gluonts >=0.12.4
        - kotsu >=0.3.1
        - matplotlib >=3.3.2
        - pmdarima >=1.8.0,<3.0.0
        - prophet >=1.1.0
        - pyod >=0.8.0
        - scikit_posthocs >=0.6.5
        - seaborn >=0.11.0
        - statsforecast>=0.5.2
        - statsmodels >=0.12.1
        - stumpy >=1.5.1
        - tbats >=1.1.0
        - tensorflow <2.13.0
        - tensorflow-probability <0.21.0
        - tsfresh >=0.20.0
        - tslearn >=0.5.2
        - mlflow <2.4.0
    test:
      requires:
        - pip
      commands:
        - pip check
      imports:
        - aeon
        - aeon.annotation
        - aeon.benchmarking
        - aeon.classification
        - aeon.clustering
        - aeon.datasets
        - aeon.distances
        - aeon.forecasting
        - aeon.performance_metrics
        - aeon.regression
        - aeon.transformations
        - aeon.utils

  - name: {{ name|lower }}-all-extras
    build:
      # FIXME: Extras environment not resolvable on aarch. Needs someone with an
      # arm machine to tests.
      skip: true  # [aarch64]
      noarch: python
    requirements:
      run:
        - python
        - {{ pin_subpackage("aeon", max_pin='x.x.x') }}
        - cloudpickle
        - dask
        # - esig  # not on CF
        - filterpy
        - h5py
        # - hmmlearn  # not on CF
        # - gluonts  # not on CF
        # - keras-self-attention
        - kotsu
        - matplotlib-base
        - mne
        - pmdarima
        - prophet
        - pyod
        - scikit-posthocs
        - seaborn
        - stumpy
        - tbats
        # - tensorflow-probability
        # - tensorflow
        - tsfresh
        - tslearn
        - xarray
        - mlflow
    test:
      imports:
        - aeon
        - aeon.annotation
        - aeon.benchmarking
        - aeon.classification
        - aeon.clustering
        - aeon.datasets
        - aeon.distances
        - aeon.forecasting
        - aeon.performance_metrics
        - aeon.regression
        - aeon.transformations
        - aeon.utils

about:
  home: https://github.com/aeon-toolkit/aeon
  summary: A unified framework for machine learning with time series
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  doc_url: https://aeon-toolkit.org/
  dev_url: https://github.com/aeon-toolkit/aeon

extra:
  recipe-maintainers:
    - MatthewMiddlehurst
