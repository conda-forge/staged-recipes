{% set name = "kedro-viz" %}
{% set version = "6.3.4" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/kedro-viz-{{ version }}.tar.gz
  sha256: ca55bbf49dda317f0e71a914a7dc09125667468d10c1480b40bbcbc9dbf9c7a8

build:
  noarch: python
  script: 
    #- rm -rf build package/build package/dist package/kedro_viz/html pip-wheel-metadata package/kedro_viz.egg-info
    - npm run build
    - cp -R build kedro_viz/html
    - {{ PYTHON }} -m pip install . -vv
  number: 0

requirements:
  host:
    - python >=3.7,<3.11
    - pip
    - nodejs >18.0,<19.0
  run:
    - python >=3.7,<3.11
    - semver >=2.10.0,<4.0.0
    - kedro >=0.18.10
    - ipython >=7.0.0,<9.0
    - fastapi >=0.73.0,<0.96.0
    - fsspec >=2021.4,<2024.1
    - aiofiles >=22.1.0 # pinned
    - uvicorn >=0.17.0,<0.23.0
    - watchgod >=0.8.2,<0.9.0
    - plotly >=4.0
    - pandas >=1.3
    - sqlalchemy >=1.4,<3.0
    - strawberry-graphql >=0.192.0,<1.0
    - networkx >=2.5
    - orjson >=3.9,<4
    - secure >=0.3.0

test:
  imports:
    - kedro_viz

about:
  home: https://github.com/kedro-org/kedro-viz
  summary: Kedro-Viz helps visualise Kedro data and analytics pipelines
  license: Apache-2.0
  license_file:
    - COPYING.txt
    - LICENSE.md

extra:
  recipe-maintainers:
    - rxm7706

