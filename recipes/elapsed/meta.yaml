{% set name = "elapsed" %}
{% set version = "3.0.1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/horta/elapsed/archive/{{ version }}.tar.gz
  sha256: addccd5588d4a90cb23e866dbff8288bbbc9baa21fc85ea04346546bd0f58af4

build:
  number: 0
  script: "{{ PYTHON }} -m pip install . -vv"

requirements:
  build:
    - {{ compiler('c') }}
    - cmake
    - ninja  # [win]
  host:
    - conda-build
    - ncurses  # [not win]
    - hope
  run:
    - ncurses  # [not win]

test:
  commands:
    - test -e $PREFIX/lib/libelapsed.so                     # [linux]
    - test -e $PREFIX/lib/libelapsed.dylib                  # [osx]
    - test -e $PREFIX/include/elapsed/elapsed.h                # [linux]
    - if NOT exist %LIBRARY_PREFIX%/lib/elapsed.lib exit 1  # [win]
    - if NOT exist %LIBRARY_PREFIX%/bin/elapsed.dll exit 1  # [win]

about:
  home: https://github.com/horta/elapsed
  license: MIT
  license_family: MIT
  license_file: LICENSE.md
  summary: 'Elapsed time C library.'
  description: |
    Calcute the elapsed time between two points in your code in a
    cross-platform way.
  doc_url: https://github.com/horta/elapsed
  dev_url: https://github.com/horta/elapsed

extra:
  recipe-maintainers:
    - horta
