{% set name = "conmon" %}
{% set version = "2.0.21" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/containers/{{ name }}/archive/v{{ version }}.tar.gz
  sha256: 03c357c2ee35317e781111d59c4f3fb34033e77a17a8f4221f2ed6d3bcc10c25

build:
  number: 0
  skip: True  # [not linux]
  script:
    - make install
    - mkdir -p $PREFIX/bin
    - cp -a bin/* $PREFIX/bin/
    
requirements:
  build:
    - make
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ compiler('cgo') }} 1.13
    - sysroot_linux-64 2.17  # [linux64]
  host:
    - gpgme
    - libseccomp
    - glib

test:
  commands:
    - conmon -v

about:
  home: https://github.com/containers/conmon
  license: Apache-2.0
  license_file: LICENSE
  summary: An OCI container runtime monitor.
  description: |
    Conmon is a monitoring program and communication tool between a container manager
    (like Podman or CRI-O) and an OCI runtime (like runc or crun) for a single container.
  dev_url: https://github.com/containers/conmon

extra:
  recipe-maintainers:
    - sodre
    - mariusvniekerk
    - scopatz
