context:
  name: opencode
  version: "1.0.146"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  - url: https://registry.npmjs.org/${{ name }}-ai/-/${{ name }}-ai-${{ version }}.tgz
    sha256: f46c4575c21c0ef9dc25064b1fdf1cdfb4ea8d4c98c03bddcfdff283aea22f0a
    file_name: ${{ name }}-ai-${{ version }}.tgz
  - url: https://raw.githubusercontent.com/sst/opencode/refs/tags/v${{ version }}/LICENSE
    sha256: 625f0f619133f89bbbb2abe37369613dfa1885eba1e50d02170deb62bb42cb6b

build:
  script:
    - npm install --global --build-from-source ./opencode-ai-${{ version }}.tgz
    - tar -xzf ${{ name }}-ai-${{ version }}.tgz
    - cd package
    - pnpm install
    - pnpm-licenses generate-disclaimer --prod --output-file=third-party-licenses.txt
  number: 0

requirements:
  build:
    - nodejs
    - pnpm-licenses
    - pnpm
  run:
    - nodejs

tests:
  - script:
      - opencode --help
      - opencode --version

about:
  homepage: https://opencode.ai
  summary: The open source coding agent.
  license: MIT
  license_file:
    - LICENSE
    - package/third-party-licenses.txt
  documentation: https://opencode.ai/docs
  repository: https://github.com/sst/opencode

extra:
  recipe-maintainers:
    - pavelzw
    - moritzwilksch
