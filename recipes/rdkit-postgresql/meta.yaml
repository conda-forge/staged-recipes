{% set name = "rdkit-postgresql" %}
{% set version = "2022.09.5" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/rdkit/rdkit/archive/refs/tags/Release_{{ version|replace(".", "_") }}.tar.gz
  # 2022.09.5
  sha256: 2efe7ce3b527df529ed3e355e2aaaf14623e51876be460fa4ad2b7f7ad54c9b1
  # 2022.03.2
  # sha256: e06ac1ea39a3200d27aef4d77745bba27fadfcac22bb115ffa204707487e9ae1

build:
  skip: true  # [win]
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - cmake
    - make  # [unix]
    - python
    - libcxx <16 # [osx]
  host:
    - boost
    - postgresql
    - eigen
    - freetype
  run:
    - boost
    - postgresql

test:
  commands:
    - mkdir test_db
    - cd test_db
    - initdb .
    - pg_ctl -D . -l logfile start
    - createdb emolecules
    - psql -c 'create extension rdkit' emolecules

about:
  home: http://rdkit.org
  summary: 'The RDKit PostgreSQL cartridge'
  license: BSD-3-Clause
  license_family: BSD
  license_file: license.txt
  doc_url: https://www.rdkit.org/docs/Cartridge.html

extra:
  recipe-maintainers:
    - peterbygrave
