
context:
  name: s3fs-fuse-awscred-lib
  version: "1.0.0"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/ggtakec/${{ name }}/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 1153f1c3f9e693da27d92ca38df7dd0e794c7a841fa81a47c6252e5008c8c585

build:
  number: 0
  skip:
    - win
  script: |
    cmake -GNinja -S . -B build -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=$PREFIX/lib
    cmake --build build

requirements:
  build:

    - ${{ compiler('c') }}
    - ${{ stdlib('c') }}
    - ninja
    - ${{ compiler('cxx') }}
    - cmake
  host:
    - aws-sdk-cpp

tests:
  - package_contents:
      files:
        - if: osx
          then: lib/libs3fsawscred.dylib
        - if: linux
          then: lib/libs3fsawscred.so
about:
  homepage: https://github.com/ggtakec/s3fs-fuse-awscred-lib
  summary: 'Credential library for s3fs-fuse'
  description: |
    s3fs-fuse-awscred-lib is a shared library that performs credential processing of s3fs-fuse.
    This shared library can be specified with the option(credlib and credlib_opts) of s3fs-fuse 
    and works by replacing the built-in credential processing of s3fs-fuse.
    This shared library makes use of aws-sdk-cpp internally and leaves all S3 credential processing to it.
  license: Apache-2.0
  license_file: LICENSE.txt
  repository: https://github.com/ggtakec/s3fs-fuse-awscred-lib

extra:
  recipe-maintainers:
    - fhoehle
