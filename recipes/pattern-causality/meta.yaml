{% set name = "pattern-causality" %}
{% set version = "1.0.3" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/skstavroglou/pattern_causality_py/releases/download/v{{ version }}/pattern_causality-{{ version }}.tar.gz
  sha256: 99d42253d559992eb0137356ad52036789f00dd87ee7f5b1e4e6ebbad5e55141

build:
  number: 0
  skip: true  # [win32]
  script_env:
    - MACOSX_DEPLOYMENT_TARGET=10.14  # [osx]
  script:
    # 使用 CONDA_BUILD_SYSROOT（若不存在则使用 xcrun）来设置 SDKROOT
    - export SDKROOT=${CONDA_BUILD_SYSROOT:-$(xcrun --sdk macosx --show-sdk-path)}
    - export CFLAGS="${CFLAGS} -isysroot ${SDKROOT} -Wno-deprecated-declarations -Wno-nullability-completeness -Wno-nullability-extension"  # [osx]
    - export CXXFLAGS="${CXXFLAGS} -std=c++17 -isysroot ${SDKROOT} -Wno-deprecated-declarations -Wno-nullability-completeness -Wno-nullability-extension"  # [osx]
    - export LDFLAGS="${LDFLAGS} -isysroot ${SDKROOT} -Wl,-rpath,${PREFIX}/lib -L${PREFIX}/lib"  # [osx]
    - {{ PYTHON }} -m pip install . -vv

requirements:
  build:
    - {{ compiler('cxx') }}  # [not win]
    - vs2019_win-64  # [win]
    - {{ stdlib('c') }}
    - python
    - pip
    - numpy >=1.19.0
    - setuptools >=45
    - wheel
    - cmake  # [win]
    - ninja  # [win]
    - make  # [unix]
    - llvm-openmp >=11.0.0  # [osx]
    - libcxx >=11.0.0  # [osx]
    - clang_osx-64  # [osx]
    - clangxx_osx-64  # [osx]
  host:
    - python
    - pip
    - numpy >=1.19.0
    - pandas >=1.0.0
    - setuptools >=45
    - wheel
    - llvm-openmp >=11.0.0  # [osx]
    - libcxx >=11.0.0  # [osx]
  run:
    - python
    - {{ pin_compatible('numpy', min_pin='x.x', max_pin='x.x') }}
    - pandas >=1.0.0
    - llvm-openmp >=11.0.0  # [osx]
    - libcxx >=11.0.0  # [osx]

test:
  requires:
    - pip
    - pytest >=6.0
    - pytest-cov >=2.0
  source_files:
    - tests
    - setup.py
    - pyproject.toml
  imports:
    - pattern_causality
  commands:
    - python -m pip check
    - python -m pytest tests -v --import-mode=append

about:
  home: https://github.com/skstavroglou/pattern_causality_py
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: Pattern Causality Algorithm in Python
  description: |
    A comprehensive Python library that implements the Pattern Causality algorithm 
    for analyzing causal relationships in time series data. This package provides 
    efficient tools for detecting and quantifying causality patterns between 
    multiple time series, with a particular focus on nonlinear complex systems.
  doc_url: https://github.com/skstavroglou/pattern_causality_py#readme
  dev_url: https://github.com/skstavroglou/pattern_causality_py

extra:
  recipe-maintainers:
    - wanghui5801
