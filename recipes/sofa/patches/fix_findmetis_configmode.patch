From f053d5b184e705b29ee1ad23ae6a46e73a01e789 Mon Sep 17 00:00:00 2001
From: Olivier Roussel <olivier.roussel@inria.fr>
Date: Thu, 7 Mar 2024 15:20:12 +0100
Subject: [PATCH 1/3] handle cmake config files starting with uppercase for
 case sensitive OS

---
 Sofa/framework/Config/cmake/Modules/Findmetis.cmake | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
index 6a29daaa69..5ab19c3ee5 100644
--- a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
+++ b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
@@ -14,7 +14,7 @@
 # was used to provide the library, as some package managers (such vcpkg) defines only short name
 # for the target, whereas others (such as conan) defines a fully qualified name.
 
-find_package(metis NO_MODULE QUIET HINTS ${metis_DIR})
+find_package(metis NO_MODULE QUIET HINTS ${metis_DIR} NAMES metis Metis)
 
 
 if(NOT metis_FIND_VERSION)
-- 
2.34.1


From 1c8f26870321a2f8683cea9c5134bfa1f872ea63 Mon Sep 17 00:00:00 2001
From: Olivier Roussel <olivier.roussel@inria.fr>
Date: Thu, 7 Mar 2024 15:21:15 +0100
Subject: [PATCH 2/3] fix case where config cmake file is used and version
 defined by config files

---
 Sofa/framework/Config/cmake/Modules/Findmetis.cmake | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
index 5ab19c3ee5..70f05db99a 100644
--- a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
+++ b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
@@ -60,8 +60,8 @@ if(TARGET metis)
   set(metis_FOUND TRUE) # only metis_FOUND has been set
   if(metis_INCLUDE_DIR AND NOT DEFINED metis_VERSION)
     _metis_check_version()
+    set(metis_FOUND ${metis_VERSION_OK})
   endif()
-  set(metis_FOUND ${metis_VERSION_OK})
   add_library(metis::metis ALIAS metis)
 else()
 
-- 
2.34.1


From 382e75fdb6e785a2b959c1e6c823a35671f59fd6 Mon Sep 17 00:00:00 2001
From: Olivier Roussel <olivier.roussel@inria.fr>
Date: Thu, 7 Mar 2024 15:22:47 +0100
Subject: [PATCH 3/3] do not fail on error if wrong version is installed and
 allow fetching

---
 Sofa/framework/Config/cmake/Modules/Findmetis.cmake | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
index 70f05db99a..6bc48aead4 100644
--- a/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
+++ b/Sofa/framework/Config/cmake/Modules/Findmetis.cmake
@@ -46,12 +46,12 @@ macro(_metis_check_version)
   set(metis_VERSION_OK TRUE)
   if(${metis_VERSION} VERSION_LESS ${metis_FIND_VERSION})
     set(metis_VERSION_OK FALSE)
-    message(SEND_ERROR "metis version ${metis_VERSION} found in ${metis_INCLUDE_DIR}, "
+    message(WARNING "metis version ${metis_VERSION} found in ${metis_INCLUDE_DIR}, "
                        "but at least version ${metis_FIND_VERSION} is required")
   endif()
   if(${metis_FIND_VERSION_EXACT} AND NOT ${metis_VERSION} VERSION_EQUAL ${metis_FIND_VERSION})
     set(metis_VERSION_OK FALSE)
-    message(SEND_ERROR "metis version ${metis_VERSION} found in ${metis_INCLUDE_DIR}, "
+    message(WARNING "metis version ${metis_VERSION} found in ${metis_INCLUDE_DIR}, "
                        "but exact version ${metis_FIND_VERSION} is required")
   endif()
 endmacro()
-- 
2.34.1

