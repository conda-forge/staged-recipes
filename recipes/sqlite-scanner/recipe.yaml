context:
  version: "0.2.0"

package:
  name: sqlite-scanner
  version: ${{ version }}

source:
  url: https://github.com/simonw/sqlite-scanner/archive/refs/tags/v${{ version }}.tar.gz
  sha256: d8587457ea35db9cf16fa286a14e59bd9e9f7da7effde45fdb39a4a991b42814
  target_directory: src

build:
  number: 0
  script:
    - cd src
    - go-licenses save . --save_path ../library_licenses
    - if: unix
      then: go build -v -o $PREFIX/bin/sqlite-scanner -ldflags="-s -w"
      else: go build -v -o %LIBRARY_BIN%\sqlite-scanner.exe -ldflags="-s"

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script: sqlite-scanner -help
  - package_contents:
      bin:
        - sqlite-scanner
      strict: true

about:
  homepage: https://github.com/simonw/sqlite-scanner
  summary: Scan folders for SQLite database files
  description: |
    sqlite-scanner is a tiny Go CLI that recurses through one or more directories, checks each regular fileâ€™s header bytes, and reports the ones whose first 16 bytes match SQLite format 3\x00. It never trusts file extensions, and it can run multiple workers in parallel for speed.
  license: MIT
  license_file:
    - src/LICENSE
    - library_licenses/
  documentation: https://pkg.go.dev/github.com/simonw/sqlite-scanner
  repository: https://github.com/simonw/sqlite-scanner

extra:
  recipe-maintainers:
    - pavelzw
