context:
  version: "0.15.2"

package:
  name: wishlist
  version: ${{ version }}

source:
  - url: https://github.com/charmbracelet/wishlist/archive/refs/tags/v${{ version }}.tar.gz
    sha256: ba1a9bbd1925e2793d5eb97e38351faf5f9efdc89921af1f1322d9b88b94bdba
    target_directory: src
  - if: win
    then:
      - url: https://raw.githubusercontent.com/mattn/go-localereader/refs/heads/master/LICENSE
        sha256: dceede03550621e65ec7b79fcba87cf6dbb9d31132a8ae71a8fe8ceec0af7da3
        file_name: LICENSE-go-localereader

build:
  number: 0
  script:
    - cd src
    - if: unix
      then: go-licenses save ./cmd/wishlist --save_path ../library_licenses
      else: go-licenses save ./cmd/wishlist --save_path ../library_licenses --ignore github.com/mattn/go-localereader
    - if: unix
      then: go build -v -o $PREFIX/bin/wishlist -ldflags="-s -w" ./cmd/wishlist
      else: go build -v -o %LIBRARY_BIN%\wishlist.exe -ldflags="-s" ./cmd/wishlist

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script: wishlist --help
  - package_contents:
      bin:
        - wishlist
      strict: true

about:
  homepage: https://github.com/charmbracelet/wishlist
  summary: The SSH directory
  description: |
    Wishlist is an SSH directory that allows you to list and connect to
    various SSH servers through a single interface. It supports local mode
    using your ~/.ssh/config as well as server mode for aggregating multiple
    SSH applications.
  license: MIT
  license_file:
    - src/LICENSE
    - library_licenses/
    - if: win
      then:
        - LICENSE-go-localereader
  documentation: https://github.com/charmbracelet/wishlist
  repository: https://github.com/charmbracelet/wishlist

extra:
  recipe-maintainers:
    - pavelzw
