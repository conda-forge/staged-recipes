context:
  version: "4.22.0"

package:
  name: gh-dash
  version: ${{ version }}

source:
  - url: https://github.com/dlvhdr/gh-dash/archive/refs/tags/v${{ version }}.tar.gz
    sha256: ec77ea57795c0b49725fb346a44a4ac7e40ff169af9504c12f8f74270cf76677
    target_directory: src
  - if: win
    then:
      - url: https://raw.githubusercontent.com/mattn/go-localereader/refs/heads/master/LICENSE
        sha256: dceede03550621e65ec7b79fcba87cf6dbb9d31132a8ae71a8fe8ceec0af7da3
        file_name: go-localereader-LICENSE

build:
  number: 0
  script:
    - cd src
    - go-licenses save . --save_path ../library_licenses${{ ' --ignore github.com/mattn/go-localereader' if win else '' }}
    - if: unix
      then: go build -v -o $PREFIX/bin/gh-dash -ldflags="-s -w"
      else: go build -v -o %LIBRARY_BIN%\gh-dash.exe -ldflags="-s"

requirements:
  build:
    - ${{ compiler("go-nocgo") }}
    - go-licenses

tests:
  - script:
      - gh-dash --help
      - gh-dash --version
  - package_contents:
      bin:
        - gh-dash
      strict: true

about:
  homepage: https://github.com/dlvhdr/gh-dash
  summary: Summary of the package.
  description: |
    Description of the package
  license: MIT
  license_file:
    - src/LICENSE.txt
    - library_licenses/
    - if: win
      then: go-localereader-LICENSE
  documentation: https://pkg.go.dev/github.com/dlvhdr/gh-dash
  repository: https://github.com/dlvhdr/gh-dash

extra:
  recipe-maintainers:
    - pavelzw
