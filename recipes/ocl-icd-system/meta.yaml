{% set name = "ocl-icd-system" %}
{% set version = "1.0.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

build:
  number: 0
  skip: True  # [not linux]

requirements:
  run:
    - ocl-icd

test:
  commands:
    # Testing OS should have a system-wide OpenCL installation
    - test ! -z "$(ls /etc/OpenCL/vendors/*.icd)"
    # If that's the case, then the activate script should have created these
    - test -d ${CONDA_PREFIX}/etc/OpenCL/vendors/system
    - test -f ${CONDA_PREFIX}/etc/OpenCL/vendors/.ocl_icd_system_cf

about:
  home: https://github.com/conda-forge/{{ name }}-feedstock
  license: MIT
  license_family: MIT
  summary: 'Symlink an system-wide OpenCL ICD to current environment'

  description: |
    Conda-forge's ocl-icd will warn users about existing OpenCL installations
    system-wide, suggesting to symlink it to CONDA_PREFIX if no other OpenCL
    ICDs have been installed yet. This metapackage will symlink the system
    OpenCL installation to CONDA_PREFIX by default.

extra:
  recipe-maintainers:
    - jaimergp
