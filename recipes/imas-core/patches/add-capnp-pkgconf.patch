--- /dev/null
+++ b/capnp_pc_gen.cmake
@@ -0,0 +1,29 @@
+# Read version from CapnProtoConfig.cmake if available
+if(EXISTS "${CAPNP_PREFIX}/lib/cmake/CapnProto/CapnProtoConfigVersion.cmake")
+  file(READ "${CAPNP_PREFIX}/lib/cmake/CapnProto/CapnProtoConfigVersion.cmake" _version_file)
+  if(_version_file MATCHES "set\\(PACKAGE_VERSION \"([0-9.]+)\"\\)")
+    set(CAPNP_VERSION "${CMAKE_MATCH_1}")
+  else()
+    set(CAPNP_VERSION "1.0.0")
+  endif()
+else()
+  set(CAPNP_VERSION "1.0.0")
+endif()
+
+# Create pkgconfig directory if it doesn't exist
+file(MAKE_DIRECTORY "${CAPNP_PREFIX}/lib/pkgconfig")
+
+# Write capnp.pc
+file(WRITE "${CAPNP_PREFIX}/lib/pkgconfig/capnp.pc" "
+prefix=${CAPNP_PREFIX}
+includedir=\${prefix}/include
+libdir=\${prefix}/lib
+
+Name: capnp
+Description: Cap'n Proto serialization library
+Version: ${CAPNP_VERSION}
+Libs: -L\${libdir} -lcapnp -lkj
+Cflags: -I\${includedir}
+")
+
+message(STATUS "Generated capnp.pc version ${CAPNP_VERSION}")
