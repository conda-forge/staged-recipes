{% set version = '0.4.0' %}
{% set posix = 'm2-' if win else '' %}

package:
  name: r-pgenlibr
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/pgenlibr_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/pgenlibr/pgenlibr_{{ version }}.tar.gz
  sha256: b6278ab14c4126cfca038c1429c5c922cf321cc2186533f3457fd3a2aba981d0

build:
  number: 0
  rpaths:
    - lib/R/lib/
    - lib/
  missing_dso_whitelist:
    - '*/R.dll'        # [win]
    - '*/Rblas.dll'    # [win]
    - '*/Rlapack.dll'  # [win]

requirements:
  build:
    - {{ compiler('c') }}              # [not win]
    - {{ compiler('m2w64_c') }}        # [win]
    - {{ compiler('cxx') }}            # [not win]
    - {{ compiler('m2w64_cxx') }}      # [win]
    - {{ stdlib('c') }}                # [not win]
    - {{ stdlib('m2w64_c') }}          # [win]
    - {{ posix }}filesystem        # [win]
    - {{ posix }}sed               # [win]
    - {{ posix }}grep              # [win]
    - {{ posix }}autoconf
    - {{ posix }}automake          # [not win]
    - {{ posix }}automake-wrapper  # [win]
    - pkg-config
    - {{ posix }}make
    - {{ posix }}coreutils         # [win]
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
    - r-rcpp >=1.0.1               # [build_platform != target_platform]
  host:
    - libdeflate
    - r-base
    - r-rcpp >=1.0.1
    - zlib
    - zstd
  run:
    - r-base
    - r-rcpp >=1.0.1

test:
  commands:
    - $R -e "library('pgenlibr')"           # [not win]
    - "\"%R%\" -e \"library('pgenlibr')\""  # [win]

about:
  home: https://CRAN.R-project.org/package=pgenlibr
  license: LGPL-3.0-or-later
  summary: A thin wrapper over PLINK 2's core libraries which provides an R interface for reading
    .pgen files.  A minimal .pvar loader is also included.  Chang et al. (2015) \doi{10.1186/s13742-015-0047-8}.
  license_file:
    - '{{ environ["PREFIX"] }}/lib/R/share/licenses/LGPL-3'

extra:
  recipe-maintainers:
    - conda-forge/r

# Package: pgenlibr
# Type: Package
# Title: PLINK 2 Binary (.pgen) Reader
# Version: 0.4.0
# Date: 2025-01-15
# Authors@R: c(person(given = "Christopher", family = "Chang", role = c("aut", "cre"), email = "chrchang@alumni.caltech.edu"), person(given = "Eric", family = "Biggers", role = c("ctb", "cph"), comment = "Author of included libdeflate library"), person(given = "Yann", family = "Collet", role = c("ctb"), comment = "Author of included Zstd library"), person(given = "Meta Platforms, Inc.", role = c("cph"), comment = "Zstd library"), person(given = "Evan", family = "Nemerson", role = c("ctb", "cph"), comment = "Author of included SIMDe library"), person(given = "Przemyslaw", family = "Skibinski", role = c("ctb"), comment = "Author of included Zstd library"), person(given = "Nick", family = "Terrell", role = c("ctb"), comment = "Author of included Zstd library"))
# Description: A thin wrapper over PLINK 2's core libraries which provides an R interface for reading .pgen files.  A minimal .pvar loader is also included.  Chang et al. (2015) \doi{10.1186/s13742-015-0047-8}.
# Encoding: UTF-8
# License: LGPL (>= 3)
# Copyright: This package includes sources of the libdeflate library owned by Eric Biggers, sources of the SIMDe library owned by Evan Nemerson, sources of the Zstd library owned by Meta Platforms, Inc., and sources of the pgenlib library owned by Christopher Chang.
# BugReports: https://github.com/chrchang/plink-ng/issues
# Imports: Rcpp (>= 1.0.1)
# LinkingTo: Rcpp
# RoxygenNote: 7.3.1
# NeedsCompilation: yes
# Packaged: 2025-01-15 23:09:34 UTC; chrchang
# Author: Christopher Chang [aut, cre], Eric Biggers [ctb, cph] (Author of included libdeflate library), Yann Collet [ctb] (Author of included Zstd library), Meta Platforms, Inc. [cph] (Zstd library), Evan Nemerson [ctb, cph] (Author of included SIMDe library), Przemyslaw Skibinski [ctb] (Author of included Zstd library), Nick Terrell [ctb] (Author of included Zstd library)
# Maintainer: Christopher Chang <chrchang@alumni.caltech.edu>
# Repository: CRAN
# Date/Publication: 2025-01-15 23:30:03 UTC
