From 4de138b3ce7bd6f024a696bde345e83c34139608 Mon Sep 17 00:00:00 2001
From: Julien Jerphanion <git@jjerphan.xyz>
Date: Mon, 21 Jul 2025 13:18:30 +0200
Subject: [PATCH] Use ldd instead of gold

Signed-off-by: Julien Jerphanion <git@jjerphan.xyz>
---
 utils/build-presets.ini | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

diff --git a/utils/build-presets.ini b/utils/build-presets.ini
index 81fa54a65e6..5bc9d5cccf1 100644
--- a/utils/build-presets.ini
+++ b/utils/build-presets.ini
@@ -915,8 +915,8 @@ reconfigure
 # gcc version on amazon linux 2 is too old to configure and build tablegen.
 # Use the clang that we install in the path for macros
 llvm-cmake-options=
-  -DCROSS_TOOLCHAIN_FLAGS_LLVM_NATIVE='-DCMAKE_C_COMPILER=clang;-DCMAKE_CXX_COMPILER=clang++;-DCLANG_DEFAULT_LINKER=gold'
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCROSS_TOOLCHAIN_FLAGS_LLVM_NATIVE='-DCMAKE_C_COMPILER=clang;-DCMAKE_CXX_COMPILER=clang++;-DCLANG_DEFAULT_LINKER=ldd'
+  -DCLANG_DEFAULT_LINKER=ldd
 
 [preset: buildbot_linux]
 mixin-preset=
@@ -1089,7 +1089,7 @@ skip-test-swiftdocc
 # Use the clang that we install in the path for macros
 llvm-cmake-options=
   -DCROSS_TOOLCHAIN_FLAGS_LLVM_NATIVE='-DCMAKE_C_COMPILER=clang;-DCMAKE_CXX_COMPILER=clang++'
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 [preset: buildbot_linux_1404_no_lldb]
 mixin-preset=buildbot_incremental_linux
@@ -1170,7 +1170,7 @@ reconfigure
 relocate-xdg-cache-home-under-build-subdir
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 [preset: buildbot_incremental_linux]
 mixin-preset=
@@ -1771,7 +1771,7 @@ skip-test-osx
 
 [preset: pr_apple_llvm_project_linux]
 
-llvm-cmake-options=-DCLANG_DEFAULT_LINKER=gold
+llvm-cmake-options=-DCLANG_DEFAULT_LINKER=ldd
 
 foundation
 libdispatch
@@ -1830,7 +1830,7 @@ skip-test-libdispatch
 skip-test-xctest
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 # Builds enough of the toolchain to build a swift package on macOS.
 [preset: mixin_swiftpm_package_macos_platform]
@@ -1855,7 +1855,7 @@ skip-test-llbuild
 skip-test-swiftpm
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 #===------------------------------------------------------------------------===#
 # Test swiftPM on macOS builder
@@ -2127,7 +2127,7 @@ skip-test-libdispatch
 skip-test-foundation
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 #===------------------------------------------------------------------------===#
 # Remote Mirror Library
@@ -2958,7 +2958,7 @@ install-xctest
 swift-install-components=autolink-driver;compiler;clang-builtin-headers;stdlib;libexec;swift-remote-mirror;sdk-overlay;license
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
 
 [preset: source_compat_suite_macos_DA]
 mixin-preset=source_compat_suite_macos_base
@@ -3050,4 +3050,4 @@ skip-build-benchmarks
 skip-test-foundation
 
 llvm-cmake-options=
-  -DCLANG_DEFAULT_LINKER=gold
+  -DCLANG_DEFAULT_LINKER=ldd
-- 
2.49.0

