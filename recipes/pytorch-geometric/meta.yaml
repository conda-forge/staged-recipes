{% set version = "2.6.1" %}

package:
  name: pytorch-geometric
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/t/torch_geometric/torch_geometric-{{ version }}.tar.gz
  sha256: 1f18f9d0fc4d2239d526221e4f22606a4a3895b5d965a9856d27610a3df662c6

build:
  noarch: python
  number: 0

outputs:
  - name: pytorch-geometric
    build:
      script: {{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation

    requirements:
      host:
        - python 3.8
        - flit-core >=3.2,<4
        - pip
      run:
        - python >=3.8
        - aiohttp
        - fsspec
        - jinja2
        - numpy
        - psutil >=5.8.0
        - pyparsing
        - requests
        - tqdm

    test:
      imports:
        - torch_geometric
        - torch_geometric.nn
        - torch_geometric.data
        - torch_geometric.utils
        - torch_geometric.datasets
        - torch_geometric.transforms
      commands:
        - pip check
      requires:
        - pip

  - name: pyg
    requirements:
      host:
        - python
      run:
        - python
        - {{ pin_subpackage('pytorch-geometric', max_pin="x.x.x") }}

  - name: pyg-graphgym
    requirements:
      host:
        - python
      run:
        - python
        - {{ pin_subpackage('pytorch-geometric', max_pin="x.x.x") }}
        - protobuf <4.21
        - pytorch-lightning <2.3.0
        - yacs

  - name: pyg-graphgym-modelhub
    requirements:
      host:
        - python
      run:
        - python
        - {{ pin_subpackage('pytorch-geometric', max_pin="x.x.x") }}
        - huggingface_hub

about:
  home: https://github.com/pyg-team/pytorch_geometric
  summary: Graph Neural Network Library for PyTorch
  license: MIT
  license_file: LICENSE

extra:
  recipe-maintainers:
    - jamesmyatt
