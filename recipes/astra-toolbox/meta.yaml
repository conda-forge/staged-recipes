{% set name = "astra-toolbox" %}
{% set version = "1.9.9.dev5" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://anaconda.org/{{ name }}/{{ name }}/{{ version }}/download/osx-64/astra-toolbox-1.9.9.dev5-py38h39e3cac_0.tar.bz2
  sha256: fc09e9418c6518bb204fe2395b3145e0a18e06ca804da2e0cbdf16f69aba2d0b

build:
  number: 0

requirements:
  build:
    - {{ compiler('c') }}  # [win or linux]
    - {{ compiler('cxx') }}  # [linux]
  host:
    - python
    - cython >=0.13
    - boost  # [osx or linux]
    - nomkl  # [not win]
    - numpy {{ numpy }}
    - scipy
    - six
    - libastra =={{ version }}
  run:
    - python
    - {{ pin_compatible('numpy', min_pin='x.x', max_pin='x') }}
    - scipy
    - six
    - libastra ==1.9.9.dev0

test:
  imports:
    - astra
  requires:
    # To avoid large downloads just for testing after build phase
    - nomkl  # [not win]
    # import scipy.sparse.linalg fails with mkl-2017.0.4 on Windows
    - mkl !=2017.0.4  # [win]
    # scipy 1.1.0 packages are broken with python 2.7 and some numpy versions
    - scipy !=1.1.0  # [py27]

about:
  home: http://www.astra-toolbox.com
  license: GPL-3.0
  license_family: GPL
  license_file: LICENCE
  summary: The ASTRA Toolbox is a Python toolbox of high-performance GPU primitives for 2D and 3D tomography.
  doc_url: http://www.astra-toolbox.com
  dev_url: https://github.com/astra-toolbox/astra-toolbox

extra:
  recipe-maintainers:
    - wohe157
