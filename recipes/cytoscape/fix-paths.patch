From 4f88725b1edbadccc62340a9e358f6a64f1f1bdb Mon Sep 17 00:00:00 2001
From: Ista Zahn <istazahn@gmail.com>
Date: Fri, 10 Sep 2021 05:05:28 -0400
Subject: [PATCH] fix paths

---
 cytoscape.sh        |  2 +-
 framework/bin/karaf | 11 ++++++-----
 gen_vmoptions.sh    |  2 +-
 3 files changed, 8 insertions(+), 7 deletions(-)

diff --git a/cytoscape.sh b/cytoscape.sh
index 3128089..c13179c 100755
--- a/cytoscape.sh
+++ b/cytoscape.sh
@@ -54,7 +54,7 @@ else
 fi
 
 #vm_options_path=$HOME/.cytoscape
-vm_options_path=$script_path
+vm_options_path="${HOME}/CytoscapeConfiguration"
 
 # Attempt to generate Cytoscape.vmoptions if it doesn't exist!
 if [ ! -e "$vm_options_path/Cytoscape.vmoptions"  -a  -x "$script_path/gen_vmoptions.sh" ]; then
diff --git a/framework/bin/karaf b/framework/bin/karaf
index 0dc9c91..f4e543d 100755
--- a/framework/bin/karaf
+++ b/framework/bin/karaf
@@ -69,6 +69,7 @@ LOCAL_CLASSPATH=$CLASSPATH
 # Sourcing environment settings for karaf similar to tomcats setenv
 #
 KARAF_SCRIPT="${PROGNAME}"
+KARAF_INSTANCES="${HOME}/CytoscapeConfiguration/instances"
 export KARAF_SCRIPT
 if [ -f "${DIRNAME}/setenv" ]; then
   . "${DIRNAME}/setenv"
@@ -105,10 +106,10 @@ setupClassPath() {
 
 checkRootInstance() {
    ROOT_INSTANCE_RUNNING=false
-   if [ -f "${KARAF_HOME}/instances/instance.properties" ];
+   if [ -f "${KARAF_INSTANCES}/instance.properties" ];
    then
-      ROOT_INSTANCE_PID=$(sed -n -e '/item.0.pid/ s/.*\= *//p' "${KARAF_HOME}/instances/instance.properties")
-      ROOT_INSTANCE_NAME=$(sed -n -e '/item.0.name/ s/.*\= *//p' "${KARAF_HOME}/instances/instance.properties")
+      ROOT_INSTANCE_PID=$(sed -n -e '/item.0.pid/ s/.*\= *//p' "${KARAF_INSTANCES}/instance.properties")
+      ROOT_INSTANCE_NAME=$(sed -n -e '/item.0.name/ s/.*\= *//p' "${KARAF_INSTANCES}/instance.properties")
       if [ "${ROOT_INSTANCE_PID}" -ne "0" ]; then
           if ps -p "${ROOT_INSTANCE_PID}" > /dev/null
           then
@@ -314,7 +315,7 @@ run() {
                     --add-exports=java.base/sun.net.www.protocol.jar=ALL-UNNAMED \
                     --add-exports=jdk.xml.dom/org.w3c.dom.html=ALL-UNNAMED \
                     --add-exports=jdk.naming.rmi/com.sun.jndi.url.rmi=ALL-UNNAMED \
-                    -Dkaraf.instances="${KARAF_HOME}/instances" \
+                    -Dkaraf.instances="${KARAF_INSTANCES}" \
                     -Dkaraf.home="${KARAF_HOME}" \
                     -Dkaraf.base="${KARAF_BASE}" \
                     -Dkaraf.data="${KARAF_DATA}" \
@@ -332,7 +333,7 @@ run() {
                 ${KARAF_EXEC} "${JAVA}" ${JAVA_OPTS} \
                     -Djava.endorsed.dirs="${JAVA_ENDORSED_DIRS}" \
                     -Djava.ext.dirs="${JAVA_EXT_DIRS}" \
-                    -Dkaraf.instances="${KARAF_HOME}/instances" \
+                    -Dkaraf.instances="${KARAF_INSTANCES}" \
                     -Dkaraf.home="${KARAF_HOME}" \
                     -Dkaraf.base="${KARAF_BASE}" \
                     -Dkaraf.data="${KARAF_DATA}" \
diff --git a/gen_vmoptions.sh b/gen_vmoptions.sh
index 1917ec9..9883b6d 100755
--- a/gen_vmoptions.sh
+++ b/gen_vmoptions.sh
@@ -4,7 +4,7 @@
 script_path="$(dirname -- $0)"
 
 #vm_options_path="$HOME/.cytoscape"
-vm_options_path=$script_path
+vm_options_path="${HOME}/CytoscapeConfiguration"
 
 if [ ! -e $vm_options_path ]; then
     /bin/mkdir $vm_options_path
-- 
2.33.0

