{% set cpp_version = "3.8.18.1" %}
{% set cpp_filename = "blpapi_cpp_%s-linux.tar.gz" % cpp_version %} # [linux]
{% set cpp_filename = "blpapi_cpp_%s-windows.zip" % cpp_version %} # [win]

{% set py_version = "3.9.2" %}
{% set py_filename = "blpapi-%s.tar.gz" % py_version %}


package:
  name: blpapi
  version: {{ py_version }}
  
source:
  - url: https://software.tech.bloomberg/BLPAPI-Stable-Generic/{{ cpp_filename }}
    folder: blpapi-cpp
    sha256: c6c425f714b461ec618e6900bda8d9b4fc919892538ccfbf8c9a774e9e234fee      # [linux]
    sha256: d62e3f109665f027e2ba3117d015c06a20d5e79e273777ef87915c82311d3fec      # [win]
  - url: https://bloomberg.bintray.com/pip/simple/blpapi/{{ py_filename }}
    folder: blpapi-py
    sha256: 4c3cbf3fb63fd338360d55188f6a59568023be6e16531d4bd307ac59a297fd96

    
outputs:
  - name: blpapi-cpp
    version: {{ cpp_version }}
    requirements: 
      build:
        - {{ compiler('cxx') }}  
      host: []
      run: []
    script: install-cpp.sh                               # [linux]
    script: install-cpp.bat                              # [win]
    test:
      commands:
        - test -f $PREFIX/lib/libblpapi3_64.so           # [linux]
        - test -f $PREFIX/lib/libblpapi3_32.so           # [linux]
     
  - name: blpapi
    version: {{ py_version }}
    script: install-py.sh                                # [linux]
    script: install-py.bat                               # [win]
    requirements:
      build:
        - {{ compiler('cxx') }}
      host:
        - python {{ python }}
      run:
        - python {{ python }}  
        - blpapi-cpp
    test:
     imports:
       - blpapi
      