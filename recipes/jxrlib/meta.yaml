{% set name = "jxrlib" %}
{% set version = "1.1" %}
{% set commit = "98e615dc5b08d684a270800aa631e3511b8c3efa" %}
{% set sha256 = "d10532947f9f4beb0b67fa2ad064c6ec5edf05281f4a0be0904d9527e37acd4a" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  fn: {{ commit }}.zip
  url: https://github.com/glencoesoftware/{{ name }}/archive/{{ commit }}.zip
  sha256: {{ sha256 }}
  patches:
    - jxrlib_CreateDecoderFromBytes.diff

build:
  number: 0

requirements:
  build:
    - m2-patch  # [win]
    - {{ compiler('c') }}  # [win]
    - {{ compiler('cxx') }}  # [unix]
    - swig
    - openjdk
    - openssl
  run:
    - openssl

test:
  commands:
    - test -f ${PREFIX}/lib/libjxrglue.a  # [unix]
    - test -f ${PREFIX}/lib/libjpegxr.a  # [unix]
    - if not exist %LIBRARY_LIB%\\JXRGlueLib.lib exit 1  # [win]
    - if not exist %LIBRARY_LIB%\\JXRLib.lib exit 1  # [win]

about:
  home: https://github.com/glencoesoftware/jxrlib
  license: BSD-2-Clause
  summary: jxrlib
  license_family: BSD
  license_file: LICENSE

  description: |
    jxrlib - JPEG XR Library by Microsoft, with changes by Glencoe Software and a patch by C. Gohlke.
    
    This package currently serves as a dependency to another package, if you want to use it directly and miss any file which should be included, please open a ticket in its feedstock repository.
  doc_url: https://github.com/glencoesoftware/jxrlib
  dev_url: https://github.com/glencoesoftware/jxrlib

extra:
  recipe-maintainers:
    - csachs
