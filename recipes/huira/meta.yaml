{% set version = "0.8.0" %}

package:
  name: huira
  version: {{ version }}

source:
  url: https://github.com/huira-render/huira/archive/v{{ version }}.tar.gz
  sha256: e4a056f352da4856e8b71917d73858108e50e5827ddbe8530f281777e5990971

build:
  number: 0

requirements:
  build:
    - {{ compiler('cxx') }}
    - {{ stdlib('c') }}
    - cmake
    - ninja
    - pkg-config
  host:
    - python
    - assimp
    - cfitsio
    - cspice
    - embree3
    - fftw
    - gdal
    - glm
    - indicators
    - libcurl
    - libtiff
    - libpng
    - libjpeg-turbo
    - tbb-devel
  run:
    - python {{ pin_compatible('python', max_pin='x.x') }}
    - cspice
    - glm
    - assimp
    - cfitsio
    - embree3
    - fftw
    - gdal
    - libtiff
    - libpng
    - libjpeg-turbo
    - tbb-devel

test:
  imports:
    - huira
  commands:
    - python -c "from huira.rgb import Scene; print('Python bindings OK')"
    - huira --help
    - huira fetch-tycho2 --help
    - huira process-tycho2 --help
    - test -f $PREFIX/include/huira/huira.hpp                                    # [unix]
    - if not exist %LIBRARY_INC%\\huira\\huira.hpp exit 1                        # [win]
    - test -f $PREFIX/lib/cmake/huira/huiraConfig.cmake                          # [unix]
    - test -f $PREFIX/lib/cmake/huira/huiraTargets.cmake                         # [unix]
    - if not exist %LIBRARY_LIB%\\cmake\\huira\\huiraConfig.cmake exit 1         # [win]
    - if not exist %LIBRARY_LIB%\\cmake\\huira\\huiraTargets.cmake exit 1        # [win]
    - test -f $PREFIX/share/huira/data/kernels/lsk/naif0012.tls                  # [unix]
    - if not exist %LIBRARY_PREFIX%\\share\\huira\\data\\kernels\\lsk\\naif0012.tls exit 1  # [win]

about:
  home: https://www.huira.space
  license: MIT
  license_file: LICENSE
  summary: Spectral renderer for space applications
  description: |
    Huira is a C++ library for ray tracing in space applications.

extra:
  recipe-maintainers:
    - crgnam
