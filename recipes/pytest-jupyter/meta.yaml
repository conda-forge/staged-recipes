{% set name = "pytest-jupyter" %}
{% set version = "0.0.3" %}
{% set build_number = 0 %}

{% set py_spec = ">=3.6" %}

package:
  name: {{ name|lower }}-meta
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 9877ee44d877805b8775e4e347fca593a2c4e287ae7353d650c115084f059288

build:
  noarch: python
  number: {{ build_number }}  
outputs:
  - name: {{ name }}
    build:
      number: {{ build_number }}
      noarch: python
    script: build_base.bat  # [win]
    script: build_base.sh  # [not win]
    requirements:

      host:
        - python {{ py_spec }}
        - pip
      run:
        - python {{ py_spec }}
        - pytest
    test:
      requires:
        - pip
      imports:
        - pytest_jupyter
      commands:
        - python -m pip check

  - name: {{ name }}-core
    build:
      number: {{ build_number }}
      noarch: generic
    requirements:
      run:
        - {{ pin_subpackage(name, exact=True) }}
        - jupyter_core
    test:
      requires:
        - pip
      commands:
        - python -m pip check

  - name: {{ name }}-server
    build:
      number: {{ build_number }}
      noarch: generic
    requirements:
      run:
        - {{ pin_subpackage(name, exact=True) }}
        - jupyter_core
        - nbformat
        - jupyter_server
        - pytest-tornasync
    test:
      requires:
        - pip
      commands:
        - python -m pip check

about:
  home: https://github.com/jupyter-server/pytest-jupyter
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: 'A pytest plugin for testing Jupyter core libraries and extensions.'
  doc_url: https://pytest-jupyter.readthedocs.io/
  dev_url: https://github.com/jupyter-server/pytest-jupyter

extra:
  recipe-maintainers:
    - fcollonval
