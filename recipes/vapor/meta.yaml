{% set name = "VAPOR" %}
{% set version = "3.7.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/NCAR/{{ name }}/archive/refs/tags/{{ version }}.tar.gz
    sha256: 704a296b68d542419b158fe22f3ee7f56912acd48cad295bc11076a862e28816
  - url: https://github.com/NCAR/VAPOR-Data/archive/refs/tags/1.0.tar.gz
    sha256: 03ce8f52104ba63049646db224b9221a2802f68544e77aa3642115194e5bfec8
    folder: vapor-data

build:
  number: 0
  skip: True  # [win]
  skip: True  # [py<39]
  skip_compile_pyc:
    - "*.py"
  script_env:
  - DEBUG_BUILD=false
  - MAP_IMAGES_PATH="$SRC_DIR/vapor-data/images"

requirements:
  build:
    - {{ compiler('cxx') }}
    - make =4.3
    - cmake =3.21.3
    - unzip =6.0
    - jupytext =1.13.8
    - doxygen =1.9.1
    - python =3.9.5
    - numpy =1.21.4
    - assimp =5.0.1
    - freetype =2.10.4
    - hdf5 =1.12.1
    - jpeg =9e
    - geotiff =1.6.0
    - udunits2 =2.2.26
    - netcdf4 =1.5.8
    - libtiff =4.3.0
    - proj =7.2.0
    - glm =0.9.9.4
    - mesalib =21.2.5
  run:
    - xarray =2022
    - matplotlib =3
    - ipython =8
    - jupyter =1
    - py-opencv =4
    - cppyy =2.2
    - python =3.9
    - {{ pin_compatible('numpy') }}
    - {{ pin_compatible('assimp') }}
    - {{ pin_compatible('freetype') }}
    - {{ pin_compatible('hdf5') }}
    - {{ pin_compatible('jpeg') }}
    - {{ pin_compatible('geotiff') }}
    - {{ pin_compatible('udunits2') }}
    - {{ pin_compatible('netcdf4') }}
    - {{ pin_compatible('libtiff') }}
    - {{ pin_compatible('proj') }}
    - {{ pin_compatible('glm') }}
    - {{ pin_compatible('mesalib') }}

test:
  imports:
    - vapor
    - vapor.session
    - vapor.renderer
  commands:
    - python -c "from vapor.renderer import VolumeRenderer"

about:
  home: http://www.vapor.ucar.edu
  summary: VAPOR is the Visualization and Analysis Platform for Ocean, Atmosphere, and Solar Researchers
  license: Apache-2.0
  license_file: LICENSE.txt
  doc_url: https://vapor.readthedocs.io
  dev_url: https://github.com/NCAR/{{ name }}


extra:
  recipe-maintainers:
    - stasj
    - sgpearse
    - shaomeng
    - NihanthCW
