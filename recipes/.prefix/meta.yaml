{% set name = ".prefix" %}
{% set version = "1.0.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

build:
  noarch: generic
  script: echo /opt/anaconda1anaconda2anaconda3 > "$PREFIX/.prefix" || echo /opt/anaconda1anaconda2anaconda3 > "%PREFIX%\.prefix"
  number: 0
  has_prefix_files:
    - .prefix

test:
  commands:
    - test -f "${PREFIX}/.prefix"  # [unix]
    - c=$(cat -- "${PREFIX}/.prefix")  # [unix]
    - test "X${c-}" = "X${PREFIX}"  # [unix]
    - echo:%PREFIX:\=/% > test-prefix  # [win]
    - fc /a test-prefix "%PREFIX%\.prefix"  # [win]

about:
  home: https://github.com/gzm55/staged-recipes/tree/dot-prefix
  summary: 'Store prefix of a conda env.'
  description: Store the full replaced prefix path of the current conda env.
  license: MIT
  license_family: MIT
  license_file: LICENSE.txt

extra:
  recipe-maintainers:
    - gzm55
