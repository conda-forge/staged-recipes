context:
  name: RustSASA
  version: "0.9.0"

package:
  name: rust-sasa
  version: ${{ version }}

source:
  - url: https://github.com/maxall41/${{ name }}/archive/refs/tags/v${{ version }}.tar.gz
    sha256: c92e285565d88603531de2859b7b4a4893fc2a036bf742dcc9adb437dd2159cf
  - url: https://github.com/maxall41/pdbtbx/archive/332d29a232755e28c20d12929f9fea72be958e4c.tar.gz
    sha256: 1b4af990e399d265582c23af5f4fea757f89842de8be92c92beb6af676484455
    target_directory: pdbtbx

build:
  number: 0
  script:
    - cargo-bundle-licenses --format yaml --output THIRDPARTY.yml
    - cargo install --no-track --locked --features cli --root ${{ PREFIX }} --path .
    - if: unix
      then:
        - mkdir -p ${PREFIX}/share/
        - cp -rp radii/ ${PREFIX}/share/
    - if: win
      then:
        - if not exist "%PREFIX%\share" mkdir "%PREFIX%\share"
        - xcopy /E /I /Y "radii" "%PREFIX%\share"

requirements:
  build:
    - ${{ compiler("c") }}
    - ${{ compiler("rust") }}
    - ${{ stdlib("c") }}
    - cargo-bundle-licenses

tests:
  - script:
      - rust-sasa --help
      - rust-sasa --version

  - script:
      run_test.sh
    files:
      source:
        - tests/data/pdbs/example.cif

about:
  homepage: "https://crates.io/crates/rust-sasa"
  summary: "CLI tool for calculating the SASA for a protein. 5x faster than FreeSASA. Based on the Shrake & Rupley algorithm."
  description: |
    âš¡ Ludicrously fast CLI written in Rust for protein solvent accessible surface area (SASA) calculations - 63x faster than Biopython, 5x faster than FreeSASA.
    Implements Shrake-Rupley algorithm [[1]](https://doi.org/10.1016/0022-2836(73)90011-9).
  license: MIT
  license_file:
    - LICENSE
    - THIRDPARTY.yml
  repository: https://github.com/maxall41/rustsasa
  documentation: https://github.com/maxall41/RustSASA/blob/main/README.md

extra:
  recipe-maintainers:
    - eunos-1128
    - maxall41
